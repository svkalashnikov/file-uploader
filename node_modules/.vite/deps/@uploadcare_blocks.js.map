{
  "version": 3,
  "sources": ["../../@symbiotejs/symbiote/build/symbiote.js", "../../@uploadcare/blocks/utils/template-utils.js", "../../@uploadcare/blocks/abstract/l10nProcessor.js", "../../@uploadcare/blocks/abstract/CTX.js", "../../@uploadcare/blocks/blocks/utils/debounce.js", "../../@uploadcare/blocks/utils/createWindowHeightTracker.js", "../../@uploadcare/blocks/abstract/Block.js", "../../@uploadcare/blocks/blocks/Modal/Modal.js", "../../@uploadcare/blocks/abstract/ActivityBlock.js", "../../@uploadcare/blocks/utils/stringToArray.js", "../../@uploadcare/blocks/utils/fileTypes.js", "../../@uploadcare/upload-client/dist/esm/index.browser.mjs", "../../@uploadcare/blocks/abstract/uploadEntrySchema.js", "../../@uploadcare/blocks/blocks/utils/userAgent.js", "../../@uploadcare/blocks/abstract/TypedData.js", "../../@uploadcare/blocks/abstract/TypedCollection.js", "../../@uploadcare/blocks/abstract/EventManager.js", "../../@uploadcare/blocks/abstract/UploaderBlock.js", "../../@uploadcare/blocks/blocks/Icon/Icon.js", "../../@uploadcare/blocks/utils/cdn-utils.js", "../../@uploadcare/blocks/blocks/Img/props-map.js", "../../@uploadcare/blocks/utils/uniqueArray.js", "../../@uploadcare/blocks/blocks/Img/ImgBase.js", "../../@uploadcare/blocks/blocks/Img/Img.js", "../../@uploadcare/blocks/blocks/SimpleBtn/SimpleBtn.js", "../../@uploadcare/blocks/blocks/StartFrom/StartFrom.js", "../../@uploadcare/blocks/blocks/DropArea/getDropItems.js", "../../@uploadcare/blocks/blocks/DropArea/addDropzone.js", "../../@uploadcare/blocks/blocks/DropArea/DropArea.js", "../../@uploadcare/blocks/blocks/SourceBtn/SourceBtn.js", "../../@uploadcare/blocks/blocks/SourceList/SourceList.js", "../../@uploadcare/blocks/blocks/utils/resizeImage.js", "../../@uploadcare/blocks/blocks/MessageBox/MessageBox.js", "../../@uploadcare/blocks/blocks/svg-backgrounds/svg-backgrounds.js", "../../@uploadcare/blocks/blocks/FileItem/FileItem.js", "../../@uploadcare/blocks/blocks/UploadList/UploadList.js", "../../@uploadcare/blocks/blocks/UrlSource/UrlSource.js", "../../@uploadcare/blocks/blocks/utils/abilities.js", "../../@uploadcare/blocks/blocks/CameraSource/CameraSource.js", "../../@uploadcare/blocks/blocks/UploadCtxProvider/UploadCtxProvider.js", "../../@uploadcare/blocks/blocks/UploadDetails/UploadDetails.js", "../../@uploadcare/blocks/blocks/ConfirmationDialog/ConfirmationDialog.js", "../../@uploadcare/blocks/blocks/ProgressBarCommon/ProgressBarCommon.js", "../../@uploadcare/blocks/blocks/ProgressBar/ProgressBar.js", "../../@uploadcare/blocks/utils/transparentPixelSrc.js", "../../@uploadcare/blocks/blocks/FilePreview/FilePreview.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/lib/classNames.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/lib/debounce.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/lib/transformationUtils.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/state.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/template.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/toolbar-constants.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/CloudEditor.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/cropper-constants.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/crop-utils.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/CropFrame.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/EditorButtonControl.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/EditorCropButtonControl.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/EditorSlider.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/lib/preloadImage.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/EditorFilterControl.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/EditorOperationControl.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/lib/pick.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/util.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/EditorImageCropper.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/lib/linspace.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/EditorImageFader.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/EditorScroller.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/EditorToolbar.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/elements/button/LrBtnUi.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/elements/line-loader/LineLoaderUi.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/elements/presence-toggle/PresenceToggle.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/src/elements/slider/SliderUi.js", "../../@uploadcare/blocks/blocks/CloudImageEditor/CloudImageEditor.js", "../../@uploadcare/blocks/blocks/ExternalSource/messages.js", "../../@uploadcare/blocks/blocks/ExternalSource/buildStyles.js", "../../@uploadcare/blocks/blocks/ExternalSource/query-string.js", "../../@uploadcare/blocks/utils/wildcardRegexp.js", "../../@uploadcare/blocks/blocks/ExternalSource/ExternalSource.js", "../../@uploadcare/blocks/blocks/Tabs/Tabs.js", "../../@uploadcare/blocks/blocks/DataOutput/DataOutput.js", "../../@uploadcare/blocks/blocks/ActivityHeader/ActivityHeader.js", "../../@uploadcare/blocks/blocks/Select/Select.js", "../../@uploadcare/blocks/blocks/Video/Video.js", "../../@uploadcare/blocks/blocks/ShadowWrapper/ShadowWrapper.js", "../../@uploadcare/blocks/blocks/Copyright/Copyright.js", "../../@uploadcare/blocks/abstract/SolutionBlock.js", "../../@uploadcare/blocks/solutions/file-uploader/regular/FileUploaderRegular.js", "../../@uploadcare/blocks/solutions/file-uploader/minimal/FileUploaderMinimal.js", "../../@uploadcare/blocks/solutions/file-uploader/inline/FileUploaderInline.js", "../../@uploadcare/blocks/abstract/registerBlocks.js", "../../@uploadcare/blocks/abstract/connectBlocksFrom.js"],
  "sourcesContent": ["var __defProp = Object.defineProperty;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __publicField = (obj, key, value) => {\n  __defNormalProp(obj, typeof key !== \"symbol\" ? key + \"\" : key, value);\n  return value;\n};\n\n// core/Data.js\nfunction cloneObj(obj) {\n  let clone = (o) => {\n    var _a;\n    for (let prop in o) {\n      if (((_a = o[prop]) == null ? void 0 : _a.constructor) === Object) {\n        o[prop] = clone(o[prop]);\n      }\n    }\n    return { ...o };\n  };\n  return clone(obj);\n}\nvar Data = class {\n  constructor(schema) {\n    if (schema.constructor === Object) {\n      this.store = cloneObj(schema);\n    } else {\n      this._storeIsProxy = true;\n      this.store = schema;\n    }\n    this.callbackMap = Object.create(null);\n  }\n  static warn(actionName, prop) {\n    console.warn(`Symbiote Data: cannot ${actionName}. Prop name: ` + prop);\n  }\n  read(prop) {\n    if (!this._storeIsProxy && !this.store.hasOwnProperty(prop)) {\n      Data.warn(\"read\", prop);\n      return null;\n    }\n    return this.store[prop];\n  }\n  has(prop) {\n    return this._storeIsProxy ? this.store[prop] !== void 0 : this.store.hasOwnProperty(prop);\n  }\n  add(prop, val, rewrite = false) {\n    if (!rewrite && Object.keys(this.store).includes(prop)) {\n      return;\n    }\n    this.store[prop] = val;\n    this.notify(prop);\n  }\n  pub(prop, val) {\n    if (!this._storeIsProxy && !this.store.hasOwnProperty(prop)) {\n      Data.warn(\"publish\", prop);\n      return;\n    }\n    this.store[prop] = val;\n    this.notify(prop);\n  }\n  multiPub(updObj) {\n    for (let prop in updObj) {\n      this.pub(prop, updObj[prop]);\n    }\n  }\n  notify(prop) {\n    if (this.callbackMap[prop]) {\n      this.callbackMap[prop].forEach((callback) => {\n        callback(this.store[prop]);\n      });\n    }\n  }\n  sub(prop, callback, init = true) {\n    if (!this._storeIsProxy && !this.store.hasOwnProperty(prop)) {\n      Data.warn(\"subscribe\", prop);\n      return null;\n    }\n    if (!this.callbackMap[prop]) {\n      this.callbackMap[prop] = /* @__PURE__ */ new Set();\n    }\n    this.callbackMap[prop].add(callback);\n    if (init) {\n      callback(this.store[prop]);\n    }\n    return {\n      remove: () => {\n        this.callbackMap[prop].delete(callback);\n        if (!this.callbackMap[prop].size) {\n          delete this.callbackMap[prop];\n        }\n      },\n      callback\n    };\n  }\n  static registerCtx(schema, uid = Symbol()) {\n    let data = Data.globalStore.get(uid);\n    if (data) {\n      console.warn('State: context UID \"' + uid + '\" already in use');\n    } else {\n      data = new Data(schema);\n      Data.globalStore.set(uid, data);\n    }\n    return data;\n  }\n  static deleteCtx(uid) {\n    Data.globalStore.delete(uid);\n  }\n  static getCtx(uid, notify = true) {\n    return Data.globalStore.get(uid) || (notify && console.warn('State: wrong context UID - \"' + uid + '\"'), null);\n  }\n};\nData.globalStore = /* @__PURE__ */ new Map();\n\n// core/dictionary.js\nvar DICT = Object.freeze({\n  BIND_ATTR: \"set\",\n  ATTR_BIND_PRFX: \"@\",\n  EXT_DATA_CTX_PRFX: \"*\",\n  NAMED_DATA_CTX_SPLTR: \"/\",\n  CTX_NAME_ATTR: \"ctx-name\",\n  CTX_OWNER_ATTR: \"ctx-owner\",\n  CSS_CTX_PROP: \"--ctx-name\",\n  EL_REF_ATTR: \"ref\",\n  AUTO_TAG_PRFX: \"sym\",\n  REPEAT_ATTR: \"repeat\",\n  REPEAT_ITEM_TAG_ATTR: \"repeat-item-tag\",\n  SET_LATER_KEY: \"__toSetLater__\",\n  USE_TPL: \"use-template\",\n  ROOT_STYLE_ATTR_NAME: \"sym-component\"\n});\n\n// utils/UID.js\nvar CHARS = \"1234567890QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm\";\nvar CHLENGTH = CHARS.length - 1;\nvar UID = class {\n  static generate(pattern = \"XXXXXXXXX-XXX\") {\n    let uid = \"\";\n    for (let i = 0; i < pattern.length; i++) {\n      uid += pattern[i] === \"-\" ? pattern[i] : CHARS.charAt(Math.random() * CHLENGTH);\n    }\n    return uid;\n  }\n};\n\n// utils/setNestedProp.js\nfunction setNestedProp(parent, path, value) {\n  let success = true;\n  let lastStep;\n  let propPath = path.split(\".\");\n  propPath.forEach((step, idx) => {\n    if (idx < propPath.length - 1) {\n      parent = parent[step];\n    } else {\n      lastStep = step;\n    }\n  });\n  if (parent) {\n    parent[lastStep] = value;\n  } else {\n    success = false;\n  }\n  return success;\n}\n\n// utils/kebabToCamel.js\nfunction kebabToCamel(string) {\n  return string.split(\"-\").map((p, i) => {\n    return p && i ? p[0].toUpperCase() + p.slice(1) : p;\n  }).join(\"\").split(\"_\").map((p, i) => {\n    return p && i ? p.toUpperCase() : p;\n  }).join(\"\");\n}\n\n// core/repeatProcessor.js\nfunction repeatProcessor(fr, fnCtx) {\n  [...fr.querySelectorAll(`[${DICT.REPEAT_ATTR}]`)].forEach((el) => {\n    let itemTag = el.getAttribute(DICT.REPEAT_ITEM_TAG_ATTR);\n    let itemClass;\n    if (itemTag) {\n      itemClass = window.customElements.get(itemTag);\n    }\n    if (!itemClass) {\n      itemClass = class extends fnCtx.BaseComponent {\n        constructor() {\n          super();\n          if (!itemTag) {\n            this.style.display = \"contents\";\n          }\n        }\n      };\n      let itemTpl = el.innerHTML;\n      itemClass.template = itemTpl;\n      itemClass.reg(itemTag);\n    }\n    while (el.firstChild) {\n      el.firstChild.remove();\n    }\n    let repeatDataKey = el.getAttribute(DICT.REPEAT_ATTR);\n    fnCtx.sub(repeatDataKey, (data) => {\n      if (!data) {\n        while (el.firstChild) {\n          el.firstChild.remove();\n        }\n        return;\n      }\n      let currentList = [...el.children];\n      let fragment;\n      let fillItems = (items) => {\n        items.forEach((item, idx) => {\n          if (currentList[idx]) {\n            if (currentList[idx].set$) {\n              setTimeout(() => {\n                currentList[idx].set$(item);\n              });\n            } else {\n              for (let k in item) {\n                currentList[idx][k] = item[k];\n              }\n            }\n          } else {\n            if (!fragment) {\n              fragment = new DocumentFragment();\n            }\n            let repeatItem = new itemClass();\n            Object.assign(repeatItem.init$, item);\n            fragment.appendChild(repeatItem);\n          }\n        });\n        fragment && el.appendChild(fragment);\n        let oversize = currentList.slice(items.length, currentList.length);\n        for (let exItm of oversize) {\n          exItm.remove();\n        }\n      };\n      if (data.constructor === Array) {\n        fillItems(data);\n      } else if (data.constructor === Object) {\n        let items = [];\n        for (let itemKey in data) {\n          let init = data[itemKey];\n          Object.defineProperty(init, \"_KEY_\", {\n            value: itemKey,\n            enumerable: true\n          });\n          items.push(init);\n        }\n        fillItems(items);\n      } else {\n        console.warn(\"Symbiote repeat data type error:\");\n        console.log(data);\n      }\n    });\n    el.removeAttribute(DICT.REPEAT_ATTR);\n    el.removeAttribute(DICT.REPEAT_ITEM_TAG_ATTR);\n  });\n}\n\n// core/tpl-processors.js\nvar DEFAULT_SLOT_KEY = \"__default__\";\nfunction slotProcessor(fr, fnCtx) {\n  if (fnCtx.shadowRoot) {\n    return;\n  }\n  let slots = [...fr.querySelectorAll(\"slot\")];\n  if (!slots.length) {\n    return;\n  }\n  let slotMap = {};\n  slots.forEach((slot) => {\n    let slotName = slot.getAttribute(\"name\") || DEFAULT_SLOT_KEY;\n    slotMap[slotName] = {\n      slot,\n      fr: document.createDocumentFragment()\n    };\n  });\n  fnCtx.initChildren.forEach((child) => {\n    var _a;\n    let slotName = DEFAULT_SLOT_KEY;\n    if (child instanceof Element && child.hasAttribute(\"slot\")) {\n      slotName = child.getAttribute(\"slot\");\n      child.removeAttribute(\"slot\");\n    }\n    (_a = slotMap[slotName]) == null ? void 0 : _a.fr.appendChild(child);\n  });\n  Object.values(slotMap).forEach((mapObj) => {\n    if (mapObj.fr.childNodes.length) {\n      mapObj.slot.parentNode.replaceChild(mapObj.fr, mapObj.slot);\n    } else if (mapObj.slot.childNodes.length) {\n      let slotFr = document.createDocumentFragment();\n      slotFr.append(...mapObj.slot.childNodes);\n      mapObj.slot.parentNode.replaceChild(slotFr, mapObj.slot);\n    } else {\n      mapObj.slot.remove();\n    }\n  });\n}\nfunction refProcessor(fr, fnCtx) {\n  [...fr.querySelectorAll(`[${DICT.EL_REF_ATTR}]`)].forEach((el) => {\n    let refName = el.getAttribute(DICT.EL_REF_ATTR);\n    fnCtx.ref[refName] = el;\n    el.removeAttribute(DICT.EL_REF_ATTR);\n  });\n}\nfunction domSetProcessor(fr, fnCtx) {\n  [...fr.querySelectorAll(`[${DICT.BIND_ATTR}]`)].forEach((el) => {\n    let subStr = el.getAttribute(DICT.BIND_ATTR);\n    let keyValArr = subStr.split(\";\");\n    [...el.attributes].forEach((attr) => {\n      if (attr.name.startsWith(\"-\") && attr.value) {\n        let key = kebabToCamel(attr.name.replace(\"-\", \"\"));\n        keyValArr.push(key + \":\" + attr.value);\n        el.removeAttribute(attr.name);\n      }\n    });\n    keyValArr.forEach((keyValStr) => {\n      if (!keyValStr) {\n        return;\n      }\n      let kv = keyValStr.split(\":\").map((str) => str.trim());\n      let prop = kv[0];\n      let isAttr;\n      if (prop.indexOf(DICT.ATTR_BIND_PRFX) === 0) {\n        isAttr = true;\n        prop = prop.replace(DICT.ATTR_BIND_PRFX, \"\");\n      }\n      let valKeysArr = kv[1].split(\",\").map((valKey) => {\n        return valKey.trim();\n      });\n      for (let valKey of valKeysArr) {\n        let castType;\n        if (valKey.startsWith(\"!!\")) {\n          castType = \"double\";\n          valKey = valKey.replace(\"!!\", \"\");\n        } else if (valKey.startsWith(\"!\")) {\n          castType = \"single\";\n          valKey = valKey.replace(\"!\", \"\");\n        }\n        fnCtx.sub(valKey, (val) => {\n          if (castType === \"double\") {\n            val = !!val;\n          } else if (castType === \"single\") {\n            val = !val;\n          }\n          if (isAttr) {\n            if ((val == null ? void 0 : val.constructor) === Boolean) {\n              val ? el.setAttribute(prop, \"\") : el.removeAttribute(prop);\n            } else {\n              el.setAttribute(prop, val);\n            }\n          } else {\n            if (!setNestedProp(el, prop, val)) {\n              if (!el[DICT.SET_LATER_KEY]) {\n                el[DICT.SET_LATER_KEY] = Object.create(null);\n              }\n              el[DICT.SET_LATER_KEY][prop] = val;\n            }\n          }\n        });\n      }\n    });\n    el.removeAttribute(DICT.BIND_ATTR);\n  });\n}\nvar OPEN_TOKEN = \"{{\";\nvar CLOSE_TOKEN = \"}}\";\nvar SKIP_ATTR = \"skip-text\";\nfunction getTextNodesWithTokens(el) {\n  let node;\n  let result = [];\n  let walk = document.createTreeWalker(el, NodeFilter.SHOW_TEXT, {\n    acceptNode: (txt) => {\n      var _a;\n      return !((_a = txt.parentElement) == null ? void 0 : _a.hasAttribute(SKIP_ATTR)) && txt.textContent.includes(OPEN_TOKEN) && txt.textContent.includes(CLOSE_TOKEN) && 1;\n    }\n  });\n  while (node = walk.nextNode()) {\n    result.push(node);\n  }\n  return result;\n}\nvar txtNodesProcessor = function(fr, fnCtx) {\n  let txtNodes = getTextNodesWithTokens(fr);\n  txtNodes.forEach((txtNode) => {\n    let tokenNodes = [];\n    let offset;\n    while (txtNode.textContent.includes(CLOSE_TOKEN)) {\n      if (txtNode.textContent.startsWith(OPEN_TOKEN)) {\n        offset = txtNode.textContent.indexOf(CLOSE_TOKEN) + CLOSE_TOKEN.length;\n        txtNode.splitText(offset);\n        tokenNodes.push(txtNode);\n      } else {\n        offset = txtNode.textContent.indexOf(OPEN_TOKEN);\n        txtNode.splitText(offset);\n      }\n      txtNode = txtNode.nextSibling;\n    }\n    tokenNodes.forEach((tNode) => {\n      let prop = tNode.textContent.replace(OPEN_TOKEN, \"\").replace(CLOSE_TOKEN, \"\");\n      tNode.textContent = \"\";\n      fnCtx.sub(prop, (val) => {\n        tNode.textContent = val;\n      });\n    });\n  });\n};\nvar tpl_processors_default = [repeatProcessor, slotProcessor, refProcessor, domSetProcessor, txtNodesProcessor];\n\n// utils/parseCssPropertyValue.js\nvar SINGLE_QUOTE = \"'\";\nvar DOUBLE_QUOTE = '\"';\nvar ESCAPED_PATTERN = /\\\\([0-9a-fA-F]{1,6} ?)/g;\nfunction hasLeadingTrailingQuotes(str) {\n  return (str[0] === DOUBLE_QUOTE || str[0] === SINGLE_QUOTE) && (str[str.length - 1] === DOUBLE_QUOTE || str[str.length - 1] === SINGLE_QUOTE);\n}\nfunction trimQuotes(str) {\n  if (str[0] === DOUBLE_QUOTE || str[0] === SINGLE_QUOTE) {\n    str = str.slice(1);\n  }\n  if (str[str.length - 1] === DOUBLE_QUOTE || str[str.length - 1] === SINGLE_QUOTE) {\n    str = str.slice(0, -1);\n  }\n  return str;\n}\nfunction escapeQuotes(str) {\n  let result = \"\";\n  let prev = \"\";\n  for (var i = 0; i < str.length; i++) {\n    const next = str[i + 1];\n    if (str[i] === \"\\\\\" && next === '\"') {\n      result += '\\\\\"';\n      i++;\n    } else if (str[i] === '\"' && prev !== \"\\\\\") {\n      result += '\\\\\"';\n    } else {\n      result += str[i];\n    }\n    prev = str[i];\n  }\n  return result;\n}\nfunction parseCssPropertyValue(input) {\n  let output = input;\n  if (hasLeadingTrailingQuotes(input)) {\n    output = trimQuotes(output);\n    output = output.replace(ESCAPED_PATTERN, (match, p1) => {\n      return String.fromCodePoint(parseInt(p1.trim(), 16));\n    });\n    output = output.replaceAll(\"\\\\\\n\", \"\\\\n\");\n    output = escapeQuotes(output);\n    output = DOUBLE_QUOTE + output + DOUBLE_QUOTE;\n  }\n  try {\n    return JSON.parse(output);\n  } catch (err) {\n    throw new Error(`Failed to parse CSS property value: ${output}. Original input: ${input}`);\n  }\n}\n\n// core/BaseComponent.js\nvar autoTagsCount = 0;\nvar styleMutationObserver = null;\nvar styleMutationObserverCbList = null;\nvar _BaseComponent = class extends HTMLElement {\n  constructor() {\n    super();\n    __publicField(this, \"updateCssData\", () => {\n      var _a;\n      this.dropCssDataCache();\n      (_a = this.__boundCssProps) == null ? void 0 : _a.forEach((ctxProp) => {\n        let val = this.getCssData(this.__extractCssName(ctxProp), true);\n        val !== null && this.$[ctxProp] !== val && (this.$[ctxProp] = val);\n      });\n    });\n    this.init$ = Object.create(null);\n    this.cssInit$ = Object.create(null);\n    this.tplProcessors = /* @__PURE__ */ new Set();\n    this.ref = Object.create(null);\n    this.allSubs = /* @__PURE__ */ new Set();\n    this.pauseRender = false;\n    this.renderShadow = false;\n    this.readyToDestroy = true;\n    this.processInnerHtml = false;\n    this.allowCustomTemplate = false;\n    this.ctxOwner = false;\n  }\n  get BaseComponent() {\n    return _BaseComponent;\n  }\n  initCallback() {\n  }\n  __initCallback() {\n    var _a;\n    if (this.__initialized) {\n      return;\n    }\n    this.__initialized = true;\n    (_a = this.initCallback) == null ? void 0 : _a.call(this);\n  }\n  render(template, shadow = this.renderShadow) {\n    let fr;\n    if ((shadow || this.constructor[\"__shadowStylesUrl\"]) && !this.shadowRoot) {\n      this.attachShadow({\n        mode: \"open\"\n      });\n    }\n    if (this.allowCustomTemplate) {\n      let customTplSelector = this.getAttribute(DICT.USE_TPL);\n      if (customTplSelector) {\n        let root = this.getRootNode();\n        let customTpl = (root == null ? void 0 : root.querySelector(customTplSelector)) || document.querySelector(customTplSelector);\n        if (customTpl) {\n          template = customTpl.content.cloneNode(true);\n        } else {\n          console.warn(`Symbiote template \"${customTplSelector}\" is not found...`);\n        }\n      }\n    }\n    if (this.processInnerHtml) {\n      for (let fn of this.tplProcessors) {\n        fn(this, this);\n      }\n    }\n    if (template || this.constructor[\"template\"]) {\n      if (this.constructor[\"template\"] && !this.constructor[\"__tpl\"]) {\n        this.constructor[\"__tpl\"] = document.createElement(\"template\");\n        this.constructor[\"__tpl\"].innerHTML = this.constructor[\"template\"];\n      }\n      if ((template == null ? void 0 : template.constructor) === DocumentFragment) {\n        fr = template;\n      } else if ((template == null ? void 0 : template.constructor) === String) {\n        let tpl = document.createElement(\"template\");\n        tpl.innerHTML = template;\n        fr = tpl.content.cloneNode(true);\n      } else if (this.constructor[\"__tpl\"]) {\n        fr = this.constructor[\"__tpl\"].content.cloneNode(true);\n      }\n      for (let fn of this.tplProcessors) {\n        fn(fr, this);\n      }\n    }\n    let addFr = () => {\n      fr && (shadow && this.shadowRoot.appendChild(fr) || this.appendChild(fr));\n      this.__initCallback();\n    };\n    if (this.constructor[\"__shadowStylesUrl\"]) {\n      shadow = true;\n      let styleLink = document.createElement(\"link\");\n      styleLink.rel = \"stylesheet\";\n      styleLink.href = this.constructor[\"__shadowStylesUrl\"];\n      styleLink.onload = addFr;\n      this.shadowRoot.prepend(styleLink);\n    } else {\n      addFr();\n    }\n  }\n  addTemplateProcessor(processorFn) {\n    this.tplProcessors.add(processorFn);\n  }\n  get autoCtxName() {\n    if (!this.__autoCtxName) {\n      this.__autoCtxName = UID.generate();\n      this.style.setProperty(DICT.CSS_CTX_PROP, `'${this.__autoCtxName}'`);\n    }\n    return this.__autoCtxName;\n  }\n  get cssCtxName() {\n    return this.getCssData(DICT.CSS_CTX_PROP, true);\n  }\n  get ctxName() {\n    var _a;\n    let ctxName = ((_a = this.getAttribute(DICT.CTX_NAME_ATTR)) == null ? void 0 : _a.trim()) || this.cssCtxName || this.__cachedCtxName || this.autoCtxName;\n    this.__cachedCtxName = ctxName;\n    return ctxName;\n  }\n  get localCtx() {\n    if (!this.__localCtx) {\n      this.__localCtx = Data.registerCtx({}, this);\n    }\n    return this.__localCtx;\n  }\n  get nodeCtx() {\n    return Data.getCtx(this.ctxName, false) || Data.registerCtx({}, this.ctxName);\n  }\n  static __parseProp(prop, fnCtx) {\n    let ctx;\n    let name;\n    if (prop.startsWith(DICT.EXT_DATA_CTX_PRFX)) {\n      ctx = fnCtx.nodeCtx;\n      name = prop.replace(DICT.EXT_DATA_CTX_PRFX, \"\");\n    } else if (prop.includes(DICT.NAMED_DATA_CTX_SPLTR)) {\n      let pArr = prop.split(DICT.NAMED_DATA_CTX_SPLTR);\n      ctx = Data.getCtx(pArr[0]);\n      name = pArr[1];\n    } else {\n      ctx = fnCtx.localCtx;\n      name = prop;\n    }\n    return {\n      ctx,\n      name\n    };\n  }\n  sub(prop, handler, init = true) {\n    let subCb = (val) => {\n      if (!this.isConnected) {\n        return;\n      }\n      handler(val);\n    };\n    let parsed = _BaseComponent.__parseProp(prop, this);\n    if (!parsed.ctx.has(parsed.name)) {\n      window.setTimeout(() => {\n        this.allSubs.add(parsed.ctx.sub(parsed.name, subCb, init));\n      });\n    } else {\n      this.allSubs.add(parsed.ctx.sub(parsed.name, subCb, init));\n    }\n  }\n  notify(prop) {\n    let parsed = _BaseComponent.__parseProp(prop, this);\n    parsed.ctx.notify(parsed.name);\n  }\n  has(prop) {\n    let parsed = _BaseComponent.__parseProp(prop, this);\n    return parsed.ctx.has(parsed.name);\n  }\n  add(prop, val, rewrite = false) {\n    let parsed = _BaseComponent.__parseProp(prop, this);\n    parsed.ctx.add(parsed.name, val, rewrite);\n  }\n  add$(obj, rewrite = false) {\n    for (let prop in obj) {\n      this.add(prop, obj[prop], rewrite);\n    }\n  }\n  get $() {\n    if (!this.__stateProxy) {\n      let o = Object.create(null);\n      this.__stateProxy = new Proxy(o, {\n        set: (obj, prop, val) => {\n          let parsed = _BaseComponent.__parseProp(prop, this);\n          parsed.ctx.pub(parsed.name, val);\n          return true;\n        },\n        get: (obj, prop) => {\n          let parsed = _BaseComponent.__parseProp(prop, this);\n          return parsed.ctx.read(parsed.name);\n        }\n      });\n    }\n    return this.__stateProxy;\n  }\n  set$(kvObj, forcePrimitives = false) {\n    for (let key in kvObj) {\n      let val = kvObj[key];\n      let primArr = [String, Number, Boolean];\n      if (forcePrimitives || !primArr.includes(val == null ? void 0 : val.constructor)) {\n        this.$[key] = val;\n      } else {\n        this.$[key] !== val && (this.$[key] = val);\n      }\n    }\n  }\n  get __ctxOwner() {\n    return this.ctxOwner || this.hasAttribute(DICT.CTX_OWNER_ATTR) && this.getAttribute(DICT.CTX_OWNER_ATTR) !== \"false\";\n  }\n  __initDataCtx() {\n    let attrDesc = this.constructor[\"__attrDesc\"];\n    if (attrDesc) {\n      for (let prop of Object.values(attrDesc)) {\n        if (!Object.keys(this.init$).includes(prop)) {\n          this.init$[prop] = \"\";\n        }\n      }\n    }\n    for (let prop in this.init$) {\n      if (prop.startsWith(DICT.EXT_DATA_CTX_PRFX)) {\n        this.nodeCtx.add(prop.replace(DICT.EXT_DATA_CTX_PRFX, \"\"), this.init$[prop], this.__ctxOwner);\n      } else if (prop.includes(DICT.NAMED_DATA_CTX_SPLTR)) {\n        let propArr = prop.split(DICT.NAMED_DATA_CTX_SPLTR);\n        let ctxName = propArr[0].trim();\n        let propName = propArr[1].trim();\n        if (ctxName && propName) {\n          let namedCtx = Data.getCtx(ctxName, false);\n          if (!namedCtx) {\n            namedCtx = Data.registerCtx({}, ctxName);\n          }\n          namedCtx.add(propName, this.init$[prop]);\n        }\n      } else {\n        this.localCtx.add(prop, this.init$[prop]);\n      }\n    }\n    for (let cssProp in this.cssInit$) {\n      this.bindCssData(cssProp, this.cssInit$[cssProp]);\n    }\n    this.__dataCtxInitialized = true;\n  }\n  connectedCallback() {\n    var _a;\n    if (!this.isConnected) {\n      return;\n    }\n    if (this.__disconnectTimeout) {\n      window.clearTimeout(this.__disconnectTimeout);\n    }\n    if (!this.connectedOnce) {\n      let ctxNameAttrVal = (_a = this.getAttribute(DICT.CTX_NAME_ATTR)) == null ? void 0 : _a.trim();\n      if (ctxNameAttrVal) {\n        this.style.setProperty(DICT.CSS_CTX_PROP, `'${ctxNameAttrVal}'`);\n      }\n      this.__initDataCtx();\n      if (this[DICT.SET_LATER_KEY]) {\n        for (let prop in this[DICT.SET_LATER_KEY]) {\n          setNestedProp(this, prop, this[DICT.SET_LATER_KEY][prop]);\n        }\n        delete this[DICT.SET_LATER_KEY];\n      }\n      this.initChildren = [...this.childNodes];\n      for (let proc of tpl_processors_default) {\n        this.addTemplateProcessor(proc);\n      }\n      if (this.pauseRender) {\n        this.__initCallback();\n      } else {\n        if (this.constructor[\"__rootStylesLink\"]) {\n          let root = this.getRootNode();\n          if (!root) {\n            return;\n          }\n          let hasLink = root == null ? void 0 : root.querySelector(`link[${DICT.ROOT_STYLE_ATTR_NAME}=\"${this.constructor.is}\"]`);\n          if (hasLink) {\n            this.render();\n            return;\n          }\n          let rootLink = this.constructor[\"__rootStylesLink\"].cloneNode(true);\n          rootLink.setAttribute(DICT.ROOT_STYLE_ATTR_NAME, this.constructor[\"is\"]);\n          rootLink.onload = () => {\n            this.render();\n          };\n          root.nodeType === Node.DOCUMENT_NODE ? root.head.appendChild(rootLink) : root.prepend(rootLink);\n        } else {\n          this.render();\n        }\n      }\n    }\n    this.connectedOnce = true;\n  }\n  destroyCallback() {\n  }\n  disconnectedCallback() {\n    if (!this.connectedOnce) {\n      return;\n    }\n    this.dropCssDataCache();\n    if (!this.readyToDestroy) {\n      return;\n    }\n    if (this.__disconnectTimeout) {\n      window.clearTimeout(this.__disconnectTimeout);\n    }\n    this.__disconnectTimeout = window.setTimeout(() => {\n      this.destroyCallback();\n      for (let sub of this.allSubs) {\n        sub.remove();\n        this.allSubs.delete(sub);\n      }\n      for (let proc of this.tplProcessors) {\n        this.tplProcessors.delete(proc);\n      }\n      styleMutationObserverCbList == null ? void 0 : styleMutationObserverCbList.delete(this.updateCssData);\n      if (!(styleMutationObserverCbList == null ? void 0 : styleMutationObserverCbList.size)) {\n        styleMutationObserver == null ? void 0 : styleMutationObserver.disconnect();\n        styleMutationObserver = null;\n        styleMutationObserverCbList = null;\n      }\n    }, 100);\n  }\n  static reg(tagName, isAlias = false) {\n    if (!tagName) {\n      autoTagsCount++;\n      tagName = `${DICT.AUTO_TAG_PRFX}-${autoTagsCount}`;\n    }\n    this.__tag = tagName;\n    let registeredClass = window.customElements.get(tagName);\n    if (registeredClass) {\n      if (!isAlias && registeredClass !== this) {\n        console.warn([\n          `Element with tag name \"${tagName}\" already registered.`,\n          `You're trying to override it with another class \"${this.name}\".`,\n          `This is most likely a mistake.`,\n          `New element will not be registered.`\n        ].join(\"\\n\"));\n      }\n      return;\n    }\n    window.customElements.define(tagName, isAlias ? class extends this {\n    } : this);\n  }\n  static get is() {\n    if (!this.__tag) {\n      this.reg();\n    }\n    return this.__tag;\n  }\n  static bindAttributes(desc) {\n    this.observedAttributes = Object.keys(desc);\n    this.__attrDesc = desc;\n  }\n  attributeChangedCallback(name, oldVal, newVal) {\n    var _a;\n    if (oldVal === newVal) {\n      return;\n    }\n    let $prop = (_a = this.constructor[\"__attrDesc\"]) == null ? void 0 : _a[name];\n    if ($prop) {\n      if (this.__dataCtxInitialized) {\n        this.$[$prop] = newVal;\n      } else {\n        this.init$[$prop] = newVal;\n      }\n    } else {\n      this[name] = newVal;\n    }\n  }\n  getCssData(propName, silentCheck = false) {\n    if (!this.__cssDataCache) {\n      this.__cssDataCache = Object.create(null);\n    }\n    if (!Object.keys(this.__cssDataCache).includes(propName)) {\n      if (!this.__computedStyle) {\n        this.__computedStyle = window.getComputedStyle(this);\n      }\n      let val = this.__computedStyle.getPropertyValue(propName).trim();\n      try {\n        this.__cssDataCache[propName] = parseCssPropertyValue(val);\n      } catch (e) {\n        !silentCheck && console.warn(`CSS Data error: ${propName}`);\n        this.__cssDataCache[propName] = null;\n      }\n    }\n    return this.__cssDataCache[propName];\n  }\n  __extractCssName(ctxPropName) {\n    return ctxPropName.split(\"--\").map((part, idx) => {\n      return idx === 0 ? \"\" : part;\n    }).join(\"--\");\n  }\n  __initStyleAttrObserver() {\n    if (!styleMutationObserverCbList) {\n      styleMutationObserverCbList = /* @__PURE__ */ new Set();\n    }\n    styleMutationObserverCbList.add(this.updateCssData);\n    if (!styleMutationObserver) {\n      styleMutationObserver = new MutationObserver((records) => {\n        records[0].type === \"attributes\" && styleMutationObserverCbList.forEach((cb) => {\n          cb();\n        });\n      });\n      styleMutationObserver.observe(document, {\n        childList: true,\n        subtree: true,\n        attributes: true,\n        attributeFilter: [\"style\"]\n      });\n    }\n  }\n  bindCssData(propName, initValue = \"\") {\n    if (!this.__boundCssProps) {\n      this.__boundCssProps = /* @__PURE__ */ new Set();\n    }\n    this.__boundCssProps.add(propName);\n    let val = this.getCssData(this.__extractCssName(propName), true);\n    val === null && (val = initValue);\n    this.add(propName, val);\n    this.__initStyleAttrObserver();\n  }\n  dropCssDataCache() {\n    this.__cssDataCache = null;\n    this.__computedStyle = null;\n  }\n  defineAccessor(propName, handler, isAsync) {\n    let localPropName = \"__\" + propName;\n    this[localPropName] = this[propName];\n    Object.defineProperty(this, propName, {\n      set: (val) => {\n        this[localPropName] = val;\n        if (isAsync) {\n          window.setTimeout(() => {\n            handler == null ? void 0 : handler(val);\n          });\n        } else {\n          handler == null ? void 0 : handler(val);\n        }\n      },\n      get: () => {\n        return this[localPropName];\n      }\n    });\n    this[propName] = this[localPropName];\n  }\n  static set shadowStyles(cssTxt) {\n    let styleBlob = new Blob([cssTxt], {\n      type: \"text/css\"\n    });\n    this.__shadowStylesUrl = URL.createObjectURL(styleBlob);\n  }\n  static set rootStyles(cssTxt) {\n    if (!this.__rootStylesLink) {\n      let styleBlob = new Blob([cssTxt], {\n        type: \"text/css\"\n      });\n      let url = URL.createObjectURL(styleBlob);\n      let link = document.createElement(\"link\");\n      link.href = url;\n      link.rel = \"stylesheet\";\n      this.__rootStylesLink = link;\n    }\n  }\n};\nvar BaseComponent = _BaseComponent;\n__publicField(BaseComponent, \"template\");\n\n// core/AppRouter.js\nvar AppRouter = class {\n  static _print(msg) {\n    console.warn(msg);\n  }\n  static setDefaultTitle(title) {\n    this.defaultTitle = title;\n  }\n  static setRoutingMap(map) {\n    Object.assign(this.appMap, map);\n    for (let route in this.appMap) {\n      if (!this.defaultRoute && this.appMap[route].default === true) {\n        this.defaultRoute = route;\n      } else if (!this.errorRoute && this.appMap[route].error === true) {\n        this.errorRoute = route;\n      }\n    }\n  }\n  static set routingEventName(name) {\n    this.__routingEventName = name;\n  }\n  static get routingEventName() {\n    return this.__routingEventName || \"sym-on-route\";\n  }\n  static readAddressBar() {\n    let result = {\n      route: null,\n      options: {}\n    };\n    let paramsArr = window.location.search.split(this.separator);\n    paramsArr.forEach((part) => {\n      if (part.includes(\"?\")) {\n        result.route = part.replace(\"?\", \"\");\n      } else if (part.includes(\"=\")) {\n        let pair = part.split(\"=\");\n        result.options[pair[0]] = decodeURI(pair[1]);\n      } else {\n        result.options[part] = true;\n      }\n    });\n    return result;\n  }\n  static notify() {\n    let routeBase = this.readAddressBar();\n    let routeScheme = this.appMap[routeBase.route];\n    if (routeScheme && routeScheme.title) {\n      document.title = routeScheme.title;\n    }\n    if (routeBase.route === null && this.defaultRoute) {\n      this.applyRoute(this.defaultRoute);\n      return;\n    } else if (!routeScheme && this.errorRoute) {\n      this.applyRoute(this.errorRoute);\n      return;\n    } else if (!routeScheme && this.defaultRoute) {\n      this.applyRoute(this.defaultRoute);\n      return;\n    } else if (!routeScheme) {\n      this._print(`Route \"${routeBase.route}\" not found...`);\n      return;\n    }\n    let event = new CustomEvent(AppRouter.routingEventName, {\n      detail: {\n        route: routeBase.route,\n        options: Object.assign(routeScheme || {}, routeBase.options)\n      }\n    });\n    window.dispatchEvent(event);\n  }\n  static reflect(route, options = {}) {\n    let routeScheme = this.appMap[route];\n    if (!routeScheme) {\n      this._print(\"Wrong route: \" + route);\n      return;\n    }\n    let routeStr = \"?\" + route;\n    for (let prop in options) {\n      if (options[prop] === true) {\n        routeStr += this.separator + prop;\n      } else {\n        routeStr += this.separator + prop + `=${options[prop]}`;\n      }\n    }\n    let title = routeScheme.title || this.defaultTitle || \"\";\n    window.history.pushState(null, title, routeStr);\n    document.title = title;\n  }\n  static applyRoute(route, options = {}) {\n    this.reflect(route, options);\n    this.notify();\n  }\n  static setSeparator(char) {\n    this._separator = char;\n  }\n  static get separator() {\n    return this._separator || \"&\";\n  }\n  static createRouterData(ctxName, routingMap) {\n    this.setRoutingMap(routingMap);\n    let routeData = Data.registerCtx({\n      route: null,\n      options: null,\n      title: null\n    }, ctxName);\n    window.addEventListener(this.routingEventName, (e) => {\n      var _a;\n      routeData.multiPub({\n        route: e.detail.route,\n        options: e.detail.options,\n        title: ((_a = e.detail.options) == null ? void 0 : _a.title) || this.defaultTitle || \"\"\n      });\n    });\n    AppRouter.notify();\n    this.initPopstateListener();\n    return routeData;\n  }\n  static initPopstateListener() {\n    if (this.__onPopstate) {\n      return;\n    }\n    this.__onPopstate = () => {\n      this.notify();\n    };\n    window.addEventListener(\"popstate\", this.__onPopstate);\n  }\n  static removePopstateListener() {\n    window.removeEventListener(\"popstate\", this.__onPopstate);\n    this.__onPopstate = null;\n  }\n};\nAppRouter.appMap = Object.create(null);\n\n// utils/dom-helpers.js\nfunction applyStyles(el, styleMap) {\n  for (let prop in styleMap) {\n    if (prop.includes(\"-\")) {\n      el.style.setProperty(prop, styleMap[prop]);\n    } else {\n      el.style[prop] = styleMap[prop];\n    }\n  }\n}\nfunction applyAttributes(el, attrMap) {\n  for (let attrName in attrMap) {\n    if (attrMap[attrName].constructor === Boolean) {\n      if (attrMap[attrName]) {\n        el.setAttribute(attrName, \"\");\n      } else {\n        el.removeAttribute(attrName);\n      }\n    } else {\n      el.setAttribute(attrName, attrMap[attrName]);\n    }\n  }\n}\nfunction create(desc = { tag: \"div\" }) {\n  let el = document.createElement(desc.tag);\n  if (desc.attributes) {\n    applyAttributes(el, desc.attributes);\n  }\n  if (desc.styles) {\n    applyStyles(el, desc.styles);\n  }\n  if (desc.properties) {\n    for (let prop in desc.properties) {\n      el[prop] = desc.properties[prop];\n    }\n  }\n  if (desc.processors) {\n    desc.processors.forEach((fn) => {\n      fn(el);\n    });\n  }\n  if (desc.children) {\n    desc.children.forEach((desc2) => {\n      let child = create(desc2);\n      el.appendChild(child);\n    });\n  }\n  return el;\n}\n\n// utils/IDB.js\nvar READY_EVENT_NAME = \"idb-store-ready\";\nvar DEFAULT_DB_NAME = `symbiote-db`;\nvar UPD_EVENT_PREFIX = `symbiote-idb-update_`;\nvar DbInstance = class {\n  _notifyWhenReady(event = null) {\n    window.dispatchEvent(new CustomEvent(READY_EVENT_NAME, {\n      detail: {\n        dbName: this.name,\n        storeName: this.storeName,\n        event\n      }\n    }));\n  }\n  get _updEventName() {\n    return UPD_EVENT_PREFIX + this.name;\n  }\n  _getUpdateEvent(key) {\n    return new CustomEvent(this._updEventName, {\n      detail: {\n        key: this.name,\n        newValue: key\n      }\n    });\n  }\n  _notifySubscribers(key) {\n    window.localStorage.removeItem(this.name);\n    window.localStorage.setItem(this.name, key);\n    window.dispatchEvent(this._getUpdateEvent(key));\n  }\n  constructor(dbName, storeName) {\n    this.name = dbName;\n    this.storeName = storeName;\n    this.version = 1;\n    this.request = window.indexedDB.open(this.name, this.version);\n    this.request.onupgradeneeded = (e) => {\n      this.db = e.target[\"result\"];\n      this.objStore = this.db.createObjectStore(storeName, {\n        keyPath: \"_key\"\n      });\n      this.objStore.transaction.oncomplete = (ev) => {\n        this._notifyWhenReady(ev);\n      };\n    };\n    this.request.onsuccess = (e) => {\n      this.db = e.target.result;\n      this._notifyWhenReady(e);\n    };\n    this.request.onerror = (e) => {\n      console.error(e);\n    };\n    this._subscriptionsMap = {};\n    this._updateHandler = (e) => {\n      if (e.key === this.name && this._subscriptionsMap[e.newValue]) {\n        let set = this._subscriptionsMap[e.newValue];\n        set.forEach(async (callback) => {\n          callback(await this.read(e.newValue));\n        });\n      }\n    };\n    this._localUpdateHandler = (e) => {\n      this._updateHandler(e.detail);\n    };\n    window.addEventListener(\"storage\", this._updateHandler);\n    window.addEventListener(this._updEventName, this._localUpdateHandler);\n  }\n  read(key) {\n    let tx = this.db.transaction(this.storeName, \"readwrite\");\n    let request = tx.objectStore(this.storeName).get(key);\n    return new Promise((resolve, reject) => {\n      request.onsuccess = (e) => {\n        var _a;\n        if ((_a = e.target.result) == null ? void 0 : _a._value) {\n          resolve(e.target.result._value);\n        } else {\n          resolve(null);\n          console.warn(`IDB: cannot read \"${key}\"`);\n        }\n      };\n      request.onerror = (e) => {\n        reject(e);\n      };\n    });\n  }\n  write(key, value, silent = false) {\n    let data = {\n      _key: key,\n      _value: value\n    };\n    let tx = this.db.transaction(this.storeName, \"readwrite\");\n    let request = tx.objectStore(this.storeName).put(data);\n    return new Promise((resolve, reject) => {\n      request.onsuccess = (e) => {\n        if (!silent) {\n          this._notifySubscribers(key);\n        }\n        resolve(e.target.result);\n      };\n      request.onerror = (e) => {\n        reject(e);\n      };\n    });\n  }\n  delete(key, silent = false) {\n    let tx = this.db.transaction(this.storeName, \"readwrite\");\n    let request = tx.objectStore(this.storeName).delete(key);\n    return new Promise((resolve, reject) => {\n      request.onsuccess = (e) => {\n        if (!silent) {\n          this._notifySubscribers(key);\n        }\n        resolve(e);\n      };\n      request.onerror = (e) => {\n        reject(e);\n      };\n    });\n  }\n  getAll() {\n    let tx = this.db.transaction(this.storeName, \"readwrite\");\n    let request = tx.objectStore(this.storeName).getAll();\n    return new Promise((resolve, reject) => {\n      request.onsuccess = (e) => {\n        let all = e.target.result;\n        resolve(all.map((obj) => {\n          return obj._value;\n        }));\n      };\n      request.onerror = (e) => {\n        reject(e);\n      };\n    });\n  }\n  subscribe(key, callback) {\n    if (!this._subscriptionsMap[key]) {\n      this._subscriptionsMap[key] = /* @__PURE__ */ new Set();\n    }\n    let set = this._subscriptionsMap[key];\n    set.add(callback);\n    return {\n      remove: () => {\n        set.delete(callback);\n        if (!set.size) {\n          delete this._subscriptionsMap[key];\n        }\n      }\n    };\n  }\n  stop() {\n    window.removeEventListener(\"storage\", this._updateHandler);\n    this._subscriptionsMap = null;\n    IDB.clear(this.name);\n  }\n};\nvar IDB = class {\n  static get readyEventName() {\n    return READY_EVENT_NAME;\n  }\n  static open(dbName = DEFAULT_DB_NAME, storeName = \"store\") {\n    let key = dbName + \"/\" + storeName;\n    if (!this._reg[key]) {\n      this._reg[key] = new DbInstance(dbName, storeName);\n    }\n    return this._reg[key];\n  }\n  static clear(dbName) {\n    window.indexedDB.deleteDatabase(dbName);\n    for (let key in this._reg) {\n      if (key.split(\"/\")[0] === dbName) {\n        delete this._reg[key];\n      }\n    }\n  }\n};\n__publicField(IDB, \"_reg\", Object.create(null));\nexport {\n  AppRouter,\n  BaseComponent,\n  Data,\n  IDB,\n  UID,\n  applyAttributes,\n  applyStyles,\n  create,\n  kebabToCamel,\n  setNestedProp\n};\n", "/** @typedef {{ [key: String]: String | Number | Boolean | InputData }} InputData */\n\nconst DEFAULT_TRANSFORMER = (value) => value;\nconst OPEN_TOKEN = '{{';\nconst CLOSE_TOKEN = '}}';\nconst PLURAL_PREFIX = 'plural:';\n\n/**\n * @typedef {Object} Options\n * @property {String} [openToken='{{'] Default is `'{{'`\n * @property {String} [closeToken='}}'] Default is `'}}'`\n * @property {(value: String) => String} [transform=DEFAULT_TRANSFORMER] Default is `DEFAULT_TRANSFORMER`\n */\n\n/**\n * @param {String} template\n * @param {InputData} [data={}] Default is `{}`\n * @param {Options} [options={}] Default is `{}`\n * @returns {String}\n */\nexport function applyTemplateData(template, data, options = {}) {\n  let { openToken = OPEN_TOKEN, closeToken = CLOSE_TOKEN, transform = DEFAULT_TRANSFORMER } = options;\n\n  for (let key in data) {\n    let value = data[key]?.toString();\n    template = template.replaceAll(openToken + key + closeToken, typeof value === 'string' ? transform(value) : value);\n  }\n  return template;\n}\n\n/**\n * @param {String} template\n * @returns {{ variable: string; pluralKey: string; countVariable: string }[]}\n */\nexport function getPluralObjects(template) {\n  const pluralObjects = [];\n  let open = template.indexOf(OPEN_TOKEN);\n  while (open !== -1) {\n    const close = template.indexOf(CLOSE_TOKEN, open);\n    const variable = template.substring(open + 2, close);\n    if (variable.startsWith(PLURAL_PREFIX)) {\n      const keyValue = template.substring(open + 2, close).replace(PLURAL_PREFIX, '');\n      const key = keyValue.substring(0, keyValue.indexOf('('));\n      const count = keyValue.substring(keyValue.indexOf('(') + 1, keyValue.indexOf(')'));\n      pluralObjects.push({ variable, pluralKey: key, countVariable: count });\n    }\n    open = template.indexOf(OPEN_TOKEN, close);\n  }\n  return pluralObjects;\n}\n", "/**\n * @template {import('./Block.js').Block} T\n * @param {DocumentFragment} fr\n * @param {T} fnCtx\n */\nexport function l10nProcessor(fr, fnCtx) {\n  [...fr.querySelectorAll('[l10n]')].forEach((el) => {\n    let key = el.getAttribute('l10n');\n    let elProp = 'textContent';\n    if (key.includes(':')) {\n      let arr = key.split(':');\n      elProp = arr[0];\n      key = arr[1];\n    }\n    let ctxKey = 'l10n:' + key;\n    // @ts-ignore\n    fnCtx.__l10nKeys.push(ctxKey);\n    fnCtx.add(ctxKey, key);\n    fnCtx.sub(ctxKey, (val) => {\n      el[elProp] = fnCtx.l10n(val);\n    });\n    el.removeAttribute('l10n');\n  });\n}\n", "export const blockCtx = () => ({\n  /** @type {Set<import('./Block').Block>} */\n  '*blocksRegistry': new Set(),\n});\n\nexport const activityBlockCtx = (fnCtx) => ({\n  ...blockCtx(),\n  '*currentActivity': '',\n  '*currentActivityParams': {},\n  '*history': [],\n  '*historyBack': null,\n  '*closeModal': () => {\n    fnCtx.set$({\n      '*modalActive': false,\n      '*currentActivity': '',\n    });\n  },\n});\n\nexport const uploaderBlockCtx = (fnCtx) => ({\n  ...activityBlockCtx(fnCtx),\n  '*commonProgress': 0,\n  '*uploadList': [],\n  '*outputData': null,\n  '*focusedEntry': null,\n  '*uploadMetadata': null,\n});\n", "/**\n * @template {Function} T\n * @param {T} callback\n * @param {number} wait\n * @returns {T & { cancel: function }}\n */\nexport function debounce(callback, wait) {\n  let timer;\n  /** @type {any} */\n  let debounced = (...args) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => callback(...args), wait);\n  };\n  debounced.cancel = () => {\n    clearTimeout(timer);\n  };\n  return debounced;\n}\n", "import { debounce } from '../blocks/utils/debounce.js';\n\nconst WINDOW_HEIGHT_TRACKER_PROPERTY = '--uploadcare-blocks-window-height';\nconst WINDOW_CACHE_KEY = '__UPLOADCARE_BLOCKS_WINDOW_HEIGHT_TRACKER_ENABLED__';\n\nexport function getIsWindowHeightTracked() {\n  return typeof window[WINDOW_CACHE_KEY] === 'undefined' ? false : !!window[WINDOW_CACHE_KEY];\n}\n\nexport function createWindowHeightTracker() {\n  if (getIsWindowHeightTracked()) {\n    return;\n  }\n  const callback = () => {\n    document.documentElement.style.setProperty(WINDOW_HEIGHT_TRACKER_PROPERTY, `${window.innerHeight}px`);\n    window[WINDOW_CACHE_KEY] = true;\n  };\n  const debouncedCallback = debounce(callback, 100);\n  window.addEventListener('resize', debouncedCallback, { passive: true });\n  callback();\n\n  return () => {\n    window[WINDOW_CACHE_KEY] = false;\n    window.removeEventListener('resize', debouncedCallback);\n  };\n}\n", "import { BaseComponent, Data } from '@symbiotejs/symbiote';\nimport { applyTemplateData, getPluralObjects } from '../utils/template-utils.js';\nimport { l10nProcessor } from './l10nProcessor.js';\nimport { blockCtx } from './CTX.js';\nimport { createWindowHeightTracker, getIsWindowHeightTracked } from '../utils/createWindowHeightTracker.js';\n\nconst TAG_PREFIX = 'lr-';\n\nexport class Block extends BaseComponent {\n  static StateConsumerScope = null;\n  allowCustomTemplate = true;\n\n  ctxInit = blockCtx();\n  init$ = this.ctxInit;\n\n  /**\n   * @param {String} str\n   * @param {{ [key: string]: string | number }} variables\n   * @returns {String}\n   */\n  l10n(str, variables = {}) {\n    if (!str) {\n      return '';\n    }\n    let template = this.getCssData('--l10n-' + str, true) || str;\n    let pluralObjects = getPluralObjects(template);\n    for (let pluralObject of pluralObjects) {\n      variables[pluralObject.variable] = this.pluralize(\n        pluralObject.pluralKey,\n        Number(variables[pluralObject.countVariable])\n      );\n    }\n    let result = applyTemplateData(template, variables);\n    return result;\n  }\n\n  /**\n   * @param {string} key\n   * @param {number} count\n   * @returns {string}\n   */\n  pluralize(key, count) {\n    const locale = this.l10n('locale-name') || 'en-US';\n    const pluralForm = new Intl.PluralRules(locale).select(count);\n    return this.l10n(`${key}__${pluralForm}`);\n  }\n\n  constructor() {\n    super();\n    /** @type {String} */\n    this.activityType = null;\n    this.addTemplateProcessor(l10nProcessor);\n    // TODO: inspect template on lr-* elements\n    // this.addTemplateProcessor((fr) => {\n    //   [...fr.querySelectorAll('*')].forEach((el) => {\n    //     if (el.tagName.includes('LR-')) {\n    //       let tag = el.tagName.toLowerCase();\n    //       console.log(window.customElements.get(tag)?.name);\n    //     }\n    //   });\n    // });\n    /**\n     * @private\n     * @type {String[]}\n     */\n    this.__l10nKeys = [];\n  }\n\n  /**\n   * @param {String} localPropKey\n   * @param {String} l10nKey\n   */\n  applyL10nKey(localPropKey, l10nKey) {\n    let prop = 'l10n:' + localPropKey;\n    this.$[prop] = /** @type {any} */ (l10nKey);\n    this.__l10nKeys.push(localPropKey);\n  }\n\n  /**\n   * @param {(block: Block) => boolean} callback\n   * @returns {Boolean}\n   */\n  findBlockInCtx(callback) {\n    /** @type {Set} */\n    let blocksRegistry = this.$['*blocksRegistry'];\n    for (let block of blocksRegistry) {\n      if (callback(block)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * @param {String} consumerScope\n   * @param {String} prop\n   * @param {any} newVal\n   */\n  setForCtxTarget(consumerScope, prop, newVal) {\n    if (this.findBlockInCtx((b) => /** @type {typeof Block} */ (b.constructor).StateConsumerScope === consumerScope)) {\n      this.$[prop] = newVal;\n    }\n  }\n\n  /** @param {String} activityType */\n  setActivity(activityType) {\n    if (this.findBlockInCtx((b) => b.activityType === activityType)) {\n      this.$['*currentActivity'] = activityType;\n      return;\n    }\n    console.warn(`Activity type \"${activityType}\" not found in the context`);\n  }\n\n  connectedCallback() {\n    if (!getIsWindowHeightTracked()) {\n      this._destroyInnerHeightTracker = createWindowHeightTracker();\n    }\n    if (this.hasAttribute('retpl')) {\n      this.constructor['template'] = null;\n      this.processInnerHtml = true;\n    }\n    if (this.isConnected && this['__ctxOwner']) {\n      let data = Data.getCtx(this.ctxName, false);\n      if (data) {\n        data.store = { ...this.ctxInit };\n      }\n    }\n    super.connectedCallback();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this._destroyInnerHeightTracker?.();\n  }\n\n  initCallback() {\n    let blocksRegistry = this.$['*blocksRegistry'];\n    blocksRegistry.add(this);\n  }\n\n  destroyCallback() {\n    let blocksRegistry = this.$['*blocksRegistry'];\n    blocksRegistry.delete(this);\n  }\n\n  /**\n   * @param {Number} bytes\n   * @param {Number} [decimals]\n   */\n  fileSizeFmt(bytes, decimals = 2) {\n    let units = ['B', 'KB', 'MB', 'GB', 'TB'];\n    /**\n     * @param {String} str\n     * @returns {String}\n     */\n    let getUnit = (str) => {\n      return this.getCssData('--l10n-unit-' + str.toLowerCase(), true) || str;\n    };\n    if (bytes === 0) {\n      return `0 ${getUnit(units[0])}`;\n    }\n    let k = 1024;\n    let dm = decimals < 0 ? 0 : decimals;\n    let i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / k ** i).toFixed(dm)) + ' ' + getUnit(units[i]);\n  }\n\n  /**\n   * @param {String} url\n   * @returns {String}\n   */\n  proxyUrl(url) {\n    let previewProxy = this.getCssData('--cfg-secure-delivery-proxy', true);\n    if (!previewProxy) {\n      return url;\n    }\n    return applyTemplateData(\n      previewProxy,\n      { previewUrl: url },\n      { transform: (value) => window.encodeURIComponent(value) }\n    );\n  }\n\n  updateCtxCssData = () => {\n    /** @type {Set<Block>} */\n    let blocks = this.$['*blocksRegistry'];\n    for (let block of blocks) {\n      if (block.isConnected) {\n        block.updateCssData();\n      }\n    }\n  };\n\n  /** @param {String} [name] */\n  static reg(name) {\n    if (!name) {\n      super.reg();\n      return;\n    }\n    super.reg(name.startsWith(TAG_PREFIX) ? name : TAG_PREFIX + name);\n  }\n}\n\nexport { BaseComponent };\n", "import { Block } from '../../abstract/Block.js';\n\nexport class Modal extends Block {\n  static StateConsumerScope = 'modal';\n\n  _handleBackdropClick = () => {\n    this._closeDialog();\n  };\n\n  _closeDialog = () => {\n    this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', false);\n  };\n\n  _handleDialogClose = () => {\n    this._closeDialog();\n  };\n\n  _handleDialogClick = (e) => {\n    if (e.target === this.ref.dialog) {\n      this._closeDialog();\n    }\n  };\n\n  init$ = {\n    ...this.ctxInit,\n    '*modalActive': false,\n    isOpen: false,\n    closeClicked: this._handleDialogClose,\n  };\n\n  cssInit$ = {\n    '--cfg-modal-backdrop-strokes': 0,\n  };\n\n  show() {\n    if (this.ref.dialog.showModal) {\n      this.ref.dialog.showModal();\n    } else {\n      this.ref.dialog.setAttribute('open', '');\n    }\n  }\n\n  hide() {\n    if (this.ref.dialog.close) {\n      this.ref.dialog.close();\n    } else {\n      this.ref.dialog.removeAttribute('open');\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n    if (typeof HTMLDialogElement === 'function') {\n      this.ref.dialog.addEventListener('close', this._handleDialogClose);\n      this.ref.dialog.addEventListener('click', this._handleDialogClick);\n    } else {\n      this.setAttribute('dialog-fallback', '');\n      let backdrop = document.createElement('div');\n      backdrop.className = 'backdrop';\n      this.appendChild(backdrop);\n      backdrop.addEventListener('click', this._handleBackdropClick);\n    }\n\n    this.sub('*modalActive', (modalActive) => {\n      if (this.$.isOpen !== modalActive) {\n        this.$.isOpen = modalActive;\n      }\n\n      if (modalActive && this.getCssData('--cfg-modal-scroll-lock')) {\n        document.body.style.overflow = 'hidden';\n      } else {\n        document.body.style.overflow = null;\n      }\n    });\n\n    this.sub('--cfg-modal-backdrop-strokes', (val) => {\n      if (val) {\n        this.setAttribute('strokes', '');\n      } else {\n        this.removeAttribute('strokes');\n      }\n    });\n\n    this.sub('isOpen', (isOpen) => {\n      if (isOpen) {\n        this.show();\n      } else {\n        this.hide();\n      }\n    });\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    document.body.style.overflow = null;\n    this.ref.dialog.removeEventListener('close', this._handleDialogClose);\n    this.ref.dialog.removeEventListener('click', this._handleDialogClick);\n  }\n}\n\nModal.template = /* HTML */ `\n  <dialog ref=\"dialog\">\n    <slot></slot>\n  </dialog>\n`;\n", "import { Modal } from '../blocks/Modal/Modal.js';\nimport { debounce } from '../blocks/utils/debounce.js';\nimport { Block } from './Block.js';\nimport { activityBlockCtx } from './CTX.js';\n\nconst ACTIVE_ATTR = 'active';\nconst ACTIVE_PROP = '___ACTIVITY_IS_ACTIVE___';\n\nexport class ActivityBlock extends Block {\n  historyTracked = false;\n  ctxInit = activityBlockCtx(this);\n\n  _debouncedHistoryFlush = debounce(this._historyFlush.bind(this), 10);\n\n  /** @private */\n  _deactivate() {\n    let actDesc = ActivityBlock._activityRegistry[this.activityKey];\n    this[ACTIVE_PROP] = false;\n    this.removeAttribute(ACTIVE_ATTR);\n    actDesc?.deactivateCallback?.();\n    // console.log(`Activity \"${this.activityType}\" deactivated`);\n  }\n\n  /** @private */\n  _activate() {\n    let actDesc = ActivityBlock._activityRegistry[this.activityKey];\n    this.$['*historyBack'] = this.historyBack.bind(this);\n    /** @private */\n    this[ACTIVE_PROP] = true;\n    this.setAttribute(ACTIVE_ATTR, '');\n    actDesc?.activateCallback?.();\n    // console.log(`Activity \"${this.activityType}\" activated`);\n\n    this._debouncedHistoryFlush();\n  }\n\n  initCallback() {\n    super.initCallback();\n    if (this.hasAttribute('current-activity')) {\n      this.sub('*currentActivity', (/** @type {String} */ val) => {\n        this.setAttribute('current-activity', val);\n      });\n    }\n\n    // TODO: rename activityType to activityId\n    if (this.activityType) {\n      if (!this.hasAttribute('activity')) {\n        this.setAttribute('activity', this.activityType);\n      }\n      this.sub('*currentActivity', (/** @type {String} */ val) => {\n        if (this.activityType !== val && this[ACTIVE_PROP]) {\n          this._deactivate();\n        } else if (this.activityType === val && !this[ACTIVE_PROP]) {\n          this._activate();\n        }\n\n        if (!val) {\n          this.$['*history'] = [];\n        }\n      });\n    }\n  }\n\n  /** @private */\n  _historyFlush() {\n    let history = this.$['*history'];\n    if (history) {\n      if (history.length > 10) {\n        history = history.slice(history.length - 11, history.length - 1);\n      }\n      if (this.historyTracked) {\n        history.push(this.activityType);\n      }\n      this.$['*history'] = history;\n    }\n  }\n\n  /** @private */\n  _isActivityRegistered() {\n    return this.activityType && !!ActivityBlock._activityRegistry[this.activityKey];\n  }\n\n  /**\n   * @private\n   * @type {{ String: { activateCallback: Function; deactivateCallback: Function } }}\n   */\n  static _activityRegistry = Object.create(null);\n\n  get isActivityActive() {\n    return this[ACTIVE_PROP];\n  }\n\n  /**\n   * TODO: remove name argument\n   *\n   * @param {String} name\n   * @param {Object} [options]\n   * @param {() => void} [options.onActivate]\n   * @param {() => void} [options.onDeactivate]\n   */\n  registerActivity(name, options = {}) {\n    const { onActivate, onDeactivate } = options;\n    if (!ActivityBlock._activityRegistry) {\n      ActivityBlock._activityRegistry = Object.create(null);\n    }\n    ActivityBlock._activityRegistry[this.activityKey] = {\n      activateCallback: onActivate,\n      deactivateCallback: onDeactivate,\n    };\n  }\n\n  unregisterActivity() {\n    if (this.isActivityActive) {\n      this._deactivate();\n    }\n    ActivityBlock._activityRegistry[this.activityKey] = undefined;\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    this._isActivityRegistered() && this.unregisterActivity();\n\n    if (Object.keys(ActivityBlock._activityRegistry).length === 0) {\n      // TODO: we should track activities more precise and reset current activity only if there is no such registered activity\n      this.$['*currentActivity'] = null;\n    }\n  }\n\n  get activityKey() {\n    return this.ctxName + this.activityType;\n  }\n\n  get activityParams() {\n    return this.$['*currentActivityParams'];\n  }\n\n  /** @type {String} */\n  get initActivity() {\n    return this.getCssData('--cfg-init-activity');\n  }\n\n  /** @type {String} */\n  get doneActivity() {\n    return this.getCssData('--cfg-done-activity');\n  }\n\n  historyBack() {\n    /** @type {String[]} */\n    let history = this.$['*history'];\n    if (history) {\n      let nextActivity = history.pop();\n      while (nextActivity === this.activityType) {\n        nextActivity = history.pop();\n      }\n      this.$['*currentActivity'] = nextActivity;\n      this.$['*history'] = history;\n      if (!nextActivity) {\n        this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', false);\n      }\n    }\n  }\n}\n\n/** @enum {String} */\nActivityBlock.activities = Object.freeze({\n  START_FROM: 'start-from',\n  CAMERA: 'camera',\n  DRAW: 'draw',\n  UPLOAD_LIST: 'upload-list',\n  URL: 'url',\n  CONFIRMATION: 'confirmation',\n  CLOUD_IMG_EDIT: 'cloud-image-edit',\n  EXTERNAL: 'external',\n  DETAILS: 'details',\n});\n", "/**\n * @param {string} str\n * @returns {string[]}\n */\nexport const stringToArray = (str, delimiter = ',') => {\n  return str\n    .trim()\n    .split(delimiter)\n    .map((part) => part.trim())\n    .filter((part) => part.length > 0);\n};\n", "import { stringToArray } from './stringToArray.js';\n\nexport const IMAGE_ACCEPT_LIST = [\n  'image/*',\n  'image/heif',\n  'image/heif-sequence',\n  'image/heic',\n  'image/heic-sequence',\n  'image/avif',\n  'image/avif-sequence',\n  '.heif',\n  '.heifs',\n  '.heic',\n  '.heics',\n  '.avif',\n  '.avifs',\n];\n\n/**\n * @param {string[]} [fileTypes]\n * @returns {string[]}\n */\nexport const mergeFileTypes = (fileTypes) => {\n  if (!fileTypes) {\n    return [];\n  }\n  return fileTypes\n    .filter((item) => typeof item === 'string')\n    .map((str) => stringToArray(str))\n    .flat();\n};\n\n/**\n * @param {String} fileType\n * @param {String[]} allowedFileTypes\n * @returns {Boolean}\n */\nexport const matchFileType = (fileType, allowedFileTypes) => {\n  return allowedFileTypes.some((type) => {\n    if (type.endsWith('*')) {\n      type = type.replace('*', '');\n      return fileType.startsWith(type);\n    }\n\n    return fileType === type;\n  });\n};\n\n/**\n * @param {File} file\n * @returns {Boolean}\n */\nexport const fileIsImage = (file) => {\n  let type = file?.type;\n  if (!type) {\n    return false;\n  }\n  return matchFileType(type, IMAGE_ACCEPT_LIST);\n};\n", "function isObject(o) {\n    return Object.prototype.toString.call(o) === '[object Object]';\n}\n\nconst SEPARATOR = /\\W|_/g;\nfunction camelizeString(text) {\n    return text\n        .split(SEPARATOR)\n        .map((word, index) => word.charAt(0)[index > 0 ? 'toUpperCase' : 'toLowerCase']() +\n        word.slice(1))\n        .join('');\n}\nfunction camelizeArrayItems(array, { ignoreKeys } = { ignoreKeys: [] }) {\n    if (!Array.isArray(array)) {\n        return array;\n    }\n    return array.map((item) => camelizeKeys(item, { ignoreKeys }));\n}\nfunction camelizeKeys(source, { ignoreKeys } = { ignoreKeys: [] }) {\n    if (Array.isArray(source)) {\n        return camelizeArrayItems(source, { ignoreKeys });\n    }\n    if (!isObject(source)) {\n        return source;\n    }\n    const result = {};\n    for (const key of Object.keys(source)) {\n        let value = source[key];\n        if (ignoreKeys.includes(key)) {\n            result[key] = value;\n            continue;\n        }\n        if (isObject(value)) {\n            value = camelizeKeys(value, { ignoreKeys });\n        }\n        else if (Array.isArray(value)) {\n            value = camelizeArrayItems(value, { ignoreKeys });\n        }\n        result[camelizeString(key)] = value;\n    }\n    return result;\n}\n\n/**\n * SetTimeout as Promise.\n *\n * @param {number} ms Timeout in milliseconds.\n */\nconst delay = (ms) => new Promise((resolve) => setTimeout(resolve, ms));\n\nfunction getUserAgent$1({ libraryName, libraryVersion, userAgent, publicKey = '', integration = '' }) {\n    const languageName = 'JavaScript';\n    if (typeof userAgent === 'string') {\n        return userAgent;\n    }\n    if (typeof userAgent === 'function') {\n        return userAgent({\n            publicKey,\n            libraryName,\n            libraryVersion,\n            languageName,\n            integration\n        });\n    }\n    const mainInfo = [libraryName, libraryVersion, publicKey]\n        .filter(Boolean)\n        .join('/');\n    const additionInfo = [languageName, integration].filter(Boolean).join('; ');\n    return `${mainInfo} (${additionInfo})`;\n}\n\nconst defaultOptions = {\n    factor: 2,\n    time: 100\n};\nfunction retrier(fn, options = defaultOptions) {\n    let attempts = 0;\n    function runAttempt(fn) {\n        const defaultDelayTime = Math.round(options.time * options.factor ** attempts);\n        const retry = (ms) => delay(ms ?? defaultDelayTime).then(() => {\n            attempts += 1;\n            return runAttempt(fn);\n        });\n        return fn({\n            attempt: attempts,\n            retry\n        });\n    }\n    return runAttempt(fn);\n}\n\nclass UploadcareNetworkError extends Error {\n    originalProgressEvent;\n    constructor(progressEvent) {\n        super();\n        this.name = 'UploadcareNetworkError';\n        this.message = 'Network error';\n        Object.setPrototypeOf(this, UploadcareNetworkError.prototype);\n        this.originalProgressEvent = progressEvent;\n    }\n}\n\nconst onCancel = (signal, callback) => {\n    if (signal) {\n        if (signal.aborted) {\n            Promise.resolve().then(callback);\n        }\n        else {\n            signal.addEventListener('abort', () => callback(), { once: true });\n        }\n    }\n};\n\nclass CancelError extends Error {\n    isCancel = true;\n    constructor(message = 'Request canceled') {\n        super(message);\n        Object.setPrototypeOf(this, CancelError.prototype);\n    }\n}\n\nconst DEFAULT_INTERVAL = 500;\nconst poll = ({ check, interval = DEFAULT_INTERVAL, timeout, signal }) => new Promise((resolve, reject) => {\n    let tickTimeoutId;\n    let timeoutId;\n    onCancel(signal, () => {\n        tickTimeoutId && clearTimeout(tickTimeoutId);\n        reject(new CancelError('Poll cancelled'));\n    });\n    if (timeout) {\n        timeoutId = setTimeout(() => {\n            tickTimeoutId && clearTimeout(tickTimeoutId);\n            reject(new CancelError('Timed out'));\n        }, timeout);\n    }\n    const tick = () => {\n        try {\n            Promise.resolve(check(signal))\n                .then((result) => {\n                if (result) {\n                    timeoutId && clearTimeout(timeoutId);\n                    resolve(result);\n                }\n                else {\n                    tickTimeoutId = setTimeout(tick, interval);\n                }\n            })\n                .catch((error) => {\n                timeoutId && clearTimeout(timeoutId);\n                reject(error);\n            });\n        }\n        catch (error) {\n            timeoutId && clearTimeout(timeoutId);\n            reject(error);\n        }\n    };\n    tickTimeoutId = setTimeout(tick, 0);\n});\n\n/*\n  Settings for future support:\n  parallelDirectUploads: 10,\n */\nconst defaultSettings = {\n    baseCDN: 'https://ucarecdn.com',\n    baseURL: 'https://upload.uploadcare.com',\n    maxContentLength: 50 * 1024 * 1024,\n    retryThrottledRequestMaxTimes: 1,\n    retryNetworkErrorMaxTimes: 3,\n    multipartMinFileSize: 25 * 1024 * 1024,\n    multipartChunkSize: 5 * 1024 * 1024,\n    multipartMinLastPartSize: 1024 * 1024,\n    maxConcurrentRequests: 4,\n    pollingTimeoutMilliseconds: 10000,\n    pusherKey: '79ae88bd931ea68464d9'\n};\nconst defaultContentType = 'application/octet-stream';\nconst defaultFilename = 'original';\n\nconst request = ({ method, url, data, headers = {}, signal, onProgress }) => new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest();\n    const requestMethod = method?.toUpperCase() || 'GET';\n    let aborted = false;\n    /**\n     * Force synchronous flag to be off Some chrome versions gets\n     * `InvalidAccessError` error when we set `responseType` See\n     * https://xhr.spec.whatwg.org/#synchronous-flag and\n     * https://bugs.chromium.org/p/chromium/issues/detail?id=1346628\n     */\n    xhr.open(requestMethod, url, true);\n    if (headers) {\n        Object.entries(headers).forEach((entry) => {\n            const [key, value] = entry;\n            typeof value !== 'undefined' &&\n                !Array.isArray(value) &&\n                xhr.setRequestHeader(key, value);\n        });\n    }\n    xhr.responseType = 'text';\n    onCancel(signal, () => {\n        aborted = true;\n        xhr.abort();\n        reject(new CancelError());\n    });\n    xhr.onload = () => {\n        if (xhr.status != 200) {\n            // analyze HTTP status of the response\n            reject(new Error(`Error ${xhr.status}: ${xhr.statusText}`)); // e.g. 404: Not Found\n        }\n        else {\n            const request = {\n                method: requestMethod,\n                url,\n                data,\n                headers: headers || undefined,\n                signal,\n                onProgress\n            };\n            // Convert the header string into an array\n            // of individual headers\n            const headersArray = xhr\n                .getAllResponseHeaders()\n                .trim()\n                .split(/[\\r\\n]+/);\n            // Create a map of header names to values\n            const responseHeaders = {};\n            headersArray.forEach(function (line) {\n                const parts = line.split(': ');\n                const header = parts.shift();\n                const value = parts.join(': ');\n                if (header && typeof header !== 'undefined') {\n                    responseHeaders[header] = value;\n                }\n            });\n            const responseData = xhr.response;\n            const responseStatus = xhr.status;\n            resolve({\n                request,\n                data: responseData,\n                headers: responseHeaders,\n                status: responseStatus\n            });\n        }\n    };\n    xhr.onerror = (progressEvent) => {\n        if (aborted)\n            return;\n        // only triggers if the request couldn't be made at all\n        reject(new UploadcareNetworkError(progressEvent));\n    };\n    if (onProgress && typeof onProgress === 'function') {\n        xhr.upload.onprogress = (event) => {\n            if (event.lengthComputable) {\n                onProgress({\n                    isComputable: true,\n                    value: event.loaded / event.total\n                });\n            }\n            else {\n                onProgress({ isComputable: false });\n            }\n        };\n    }\n    if (data) {\n        xhr.send(data);\n    }\n    else {\n        xhr.send();\n    }\n});\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction identity(obj, ..._args) {\n    return obj;\n}\n\nconst getFileOptions = ({ name }) => name ? [name] : [];\nconst transformFile = identity;\nvar getFormData = () => new FormData();\n\nconst isBuffer = (data) => false;\n\nconst isBlob = (data) => {\n    return typeof Blob !== 'undefined' && data instanceof Blob;\n};\nconst isFile = (data) => {\n    return typeof File !== 'undefined' && data instanceof File;\n};\nconst isReactNativeAsset = (data) => {\n    return (!!data &&\n        typeof data === 'object' &&\n        !Array.isArray(data) &&\n        'uri' in data &&\n        typeof data.uri === 'string');\n};\nconst isFileData = (data) => {\n    return (isBlob(data) || isFile(data) || isBuffer() || isReactNativeAsset(data));\n};\n\nconst isSimpleValue = (value) => {\n    return (typeof value === 'string' ||\n        typeof value === 'number' ||\n        typeof value === 'undefined');\n};\nconst isObjectValue = (value) => {\n    return !!value && typeof value === 'object' && !Array.isArray(value);\n};\nconst isFileValue = (value) => !!value &&\n    typeof value === 'object' &&\n    'data' in value &&\n    isFileData(value.data);\nfunction collectParams(params, inputKey, inputValue) {\n    if (isFileValue(inputValue)) {\n        const { name, contentType } = inputValue;\n        const file = transformFile(inputValue.data, name, contentType ?? defaultContentType);\n        const options = getFileOptions({ name, contentType });\n        params.push([inputKey, file, ...options]);\n    }\n    else if (isObjectValue(inputValue)) {\n        for (const [key, value] of Object.entries(inputValue)) {\n            if (typeof value !== 'undefined') {\n                params.push([`${inputKey}[${key}]`, String(value)]);\n            }\n        }\n    }\n    else if (isSimpleValue(inputValue) && inputValue) {\n        params.push([inputKey, inputValue.toString()]);\n    }\n}\nfunction getFormDataParams(options) {\n    const params = [];\n    for (const [key, value] of Object.entries(options)) {\n        collectParams(params, key, value);\n    }\n    return params;\n}\nfunction buildFormData(options) {\n    const formData = getFormData();\n    const paramsList = getFormDataParams(options);\n    for (const params of paramsList) {\n        const [key, value, ...rest] = params;\n        // node form-data has another signature for append\n        formData.append(key, value, ...rest);\n    }\n    return formData;\n}\n\nclass UploadClientError extends Error {\n    isCancel;\n    code;\n    request;\n    response;\n    headers;\n    constructor(message, code, request, response, headers) {\n        super();\n        this.name = 'UploadClientError';\n        this.message = message;\n        this.code = code;\n        this.request = request;\n        this.response = response;\n        this.headers = headers;\n        Object.setPrototypeOf(this, UploadClientError.prototype);\n    }\n}\n\nconst buildSearchParams = (query) => {\n    const searchParams = new URLSearchParams();\n    for (const [key, value] of Object.entries(query)) {\n        if (value && typeof value === 'object' && !Array.isArray(value)) {\n            Object.entries(value)\n                .filter((entry) => entry[1] ?? false)\n                .forEach((entry) => searchParams.set(`${key}[${entry[0]}]`, String(entry[1])));\n        }\n        else if (Array.isArray(value)) {\n            value.forEach((val) => {\n                searchParams.append(`${key}[]`, val);\n            });\n        }\n        else if (typeof value === 'string' && value) {\n            searchParams.set(key, value);\n        }\n        else if (typeof value === 'number') {\n            searchParams.set(key, value.toString());\n        }\n    }\n    return searchParams.toString();\n};\nconst getUrl = (base, path, query) => {\n    const url = new URL(base);\n    url.pathname = (url.pathname + path).replace('//', '/');\n    if (query) {\n        url.search = buildSearchParams(query);\n    }\n    return url.toString();\n};\n\nvar version = '6.6.1';\n\nconst LIBRARY_NAME = 'UploadcareUploadClient';\nconst LIBRARY_VERSION = version;\nfunction getUserAgent(options) {\n    return getUserAgent$1({\n        libraryName: LIBRARY_NAME,\n        libraryVersion: LIBRARY_VERSION,\n        ...options\n    });\n}\n\nconst REQUEST_WAS_THROTTLED_CODE = 'RequestThrottledError';\nconst DEFAULT_RETRY_AFTER_TIMEOUT = 15000;\nconst DEFAULT_NETWORK_ERROR_TIMEOUT = 1000;\nfunction getTimeoutFromThrottledRequest(error) {\n    const { headers } = error || {};\n    if (!headers || typeof headers['retry-after'] !== 'string') {\n        return DEFAULT_RETRY_AFTER_TIMEOUT;\n    }\n    const seconds = parseInt(headers['retry-after'], 10);\n    if (!Number.isFinite(seconds)) {\n        return DEFAULT_RETRY_AFTER_TIMEOUT;\n    }\n    return seconds * 1000;\n}\nfunction retryIfFailed(fn, options) {\n    const { retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes } = options;\n    return retrier(({ attempt, retry }) => fn().catch((error) => {\n        if ('response' in error &&\n            error?.code === REQUEST_WAS_THROTTLED_CODE &&\n            attempt < retryThrottledRequestMaxTimes) {\n            return retry(getTimeoutFromThrottledRequest(error));\n        }\n        if (error instanceof UploadcareNetworkError &&\n            attempt < retryNetworkErrorMaxTimes) {\n            return retry((attempt + 1) * DEFAULT_NETWORK_ERROR_TIMEOUT);\n        }\n        throw error;\n    }));\n}\n\nconst getContentType = (file) => {\n    let contentType = '';\n    if (isBlob(file) || isFile(file) || isReactNativeAsset(file)) {\n        contentType = file.type;\n    }\n    return contentType || defaultContentType;\n};\n\nconst getFileName = (file) => {\n    let filename = '';\n    if (isFile(file) && file.name) {\n        filename = file.name;\n    }\n    else if (isBlob(file) || isBuffer()) {\n        filename = '';\n    }\n    else if (isReactNativeAsset(file) && file.name) {\n        filename = file.name;\n    }\n    return filename || defaultFilename;\n};\n\nfunction getStoreValue(store) {\n    if (typeof store === 'undefined' || store === 'auto') {\n        return 'auto';\n    }\n    return store ? '1' : '0';\n}\n\n/**\n * Performs file uploading request to Uploadcare Upload API. Can be canceled and\n * has progress.\n */\nfunction base(file, { publicKey, fileName, contentType, baseURL = defaultSettings.baseURL, secureSignature, secureExpire, store, signal, onProgress, source = 'local', integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes, metadata }) {\n    return retryIfFailed(() => request({\n        method: 'POST',\n        url: getUrl(baseURL, '/base/', {\n            jsonerrors: 1\n        }),\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        data: buildFormData({\n            file: {\n                data: file,\n                name: fileName || getFileName(file),\n                contentType: contentType || getContentType(file)\n            },\n            UPLOADCARE_PUB_KEY: publicKey,\n            UPLOADCARE_STORE: getStoreValue(store),\n            signature: secureSignature,\n            expire: secureExpire,\n            source: source,\n            metadata\n        }),\n        signal,\n        onProgress\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryNetworkErrorMaxTimes, retryThrottledRequestMaxTimes });\n}\n\nvar TypeEnum;\n(function (TypeEnum) {\n    TypeEnum[\"Token\"] = \"token\";\n    TypeEnum[\"FileInfo\"] = \"file_info\";\n})(TypeEnum || (TypeEnum = {}));\n/** Uploading files from URL. */\nfunction fromUrl(sourceUrl, { publicKey, baseURL = defaultSettings.baseURL, store, fileName, checkForUrlDuplicates, saveUrlForRecurrentUploads, secureSignature, secureExpire, source = 'url', signal, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes, metadata }) {\n    return retryIfFailed(() => request({\n        method: 'POST',\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        url: getUrl(baseURL, '/from_url/', {\n            jsonerrors: 1,\n            pub_key: publicKey,\n            source_url: sourceUrl,\n            store: getStoreValue(store),\n            filename: fileName,\n            check_URL_duplicates: checkForUrlDuplicates ? 1 : undefined,\n            save_URL_duplicates: saveUrlForRecurrentUploads ? 1 : undefined,\n            signature: secureSignature,\n            expire: secureExpire,\n            source: source,\n            metadata\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryNetworkErrorMaxTimes, retryThrottledRequestMaxTimes });\n}\n\nvar Status;\n(function (Status) {\n    Status[\"Unknown\"] = \"unknown\";\n    Status[\"Waiting\"] = \"waiting\";\n    Status[\"Progress\"] = \"progress\";\n    Status[\"Error\"] = \"error\";\n    Status[\"Success\"] = \"success\";\n})(Status || (Status = {}));\nconst isErrorResponse = (response) => {\n    return 'status' in response && response.status === Status.Error;\n};\n/** Checking upload status and working with file tokens. */\nfunction fromUrlStatus(token, { publicKey, baseURL = defaultSettings.baseURL, signal, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes } = {}) {\n    return retryIfFailed(() => request({\n        method: 'GET',\n        headers: publicKey\n            ? {\n                'X-UC-User-Agent': getUserAgent({\n                    publicKey,\n                    integration,\n                    userAgent\n                })\n            }\n            : undefined,\n        url: getUrl(baseURL, '/from_url/status/', {\n            jsonerrors: 1,\n            token\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response && !isErrorResponse(response)) {\n            throw new UploadClientError(response.error.content, undefined, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryNetworkErrorMaxTimes, retryThrottledRequestMaxTimes });\n}\n\n/** Create files group. */\nfunction group(uuids, { publicKey, baseURL = defaultSettings.baseURL, jsonpCallback, secureSignature, secureExpire, signal, source, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes }) {\n    return retryIfFailed(() => request({\n        method: 'POST',\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        url: getUrl(baseURL, '/group/', {\n            jsonerrors: 1,\n            pub_key: publicKey,\n            files: uuids,\n            callback: jsonpCallback,\n            signature: secureSignature,\n            expire: secureExpire,\n            source\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryNetworkErrorMaxTimes, retryThrottledRequestMaxTimes });\n}\n\n/** Get info about group. */\nfunction groupInfo(id, { publicKey, baseURL = defaultSettings.baseURL, signal, source, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes }) {\n    return retryIfFailed(() => request({\n        method: 'GET',\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        url: getUrl(baseURL, '/group/info/', {\n            jsonerrors: 1,\n            pub_key: publicKey,\n            group_id: id,\n            source\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes });\n}\n\n/** Returns a JSON dictionary holding file info. */\nfunction info(uuid, { publicKey, baseURL = defaultSettings.baseURL, signal, source, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes }) {\n    return retryIfFailed(() => request({\n        method: 'GET',\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        url: getUrl(baseURL, '/info/', {\n            jsonerrors: 1,\n            pub_key: publicKey,\n            file_id: uuid,\n            source\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes });\n}\n\n/** Start multipart uploading. */\nfunction multipartStart(size, { publicKey, contentType, fileName, multipartChunkSize = defaultSettings.multipartChunkSize, baseURL = '', secureSignature, secureExpire, store, signal, source = 'local', integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes, metadata }) {\n    return retryIfFailed(() => request({\n        method: 'POST',\n        url: getUrl(baseURL, '/multipart/start/', { jsonerrors: 1 }),\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        data: buildFormData({\n            filename: fileName || defaultFilename,\n            size: size,\n            content_type: contentType || defaultContentType,\n            part_size: multipartChunkSize,\n            UPLOADCARE_STORE: getStoreValue(store),\n            UPLOADCARE_PUB_KEY: publicKey,\n            signature: secureSignature,\n            expire: secureExpire,\n            source: source,\n            metadata\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            // convert to array\n            response.parts = Object.keys(response.parts).map((key) => response.parts[key]);\n            return response;\n        }\n    }), { retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes });\n}\n\n/** Complete multipart uploading. */\nfunction multipartUpload(part, url, { contentType, signal, onProgress, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes }) {\n    return retryIfFailed(() => request({\n        method: 'PUT',\n        url,\n        data: part,\n        // Upload request can't be non-computable because we always know exact size\n        onProgress: onProgress,\n        signal,\n        headers: {\n            'Content-Type': contentType || defaultContentType\n        }\n    })\n        .then((result) => {\n        // hack for node ¯\\_(ツ)_/¯\n        if (onProgress)\n            onProgress({\n                isComputable: true,\n                value: 1\n            });\n        return result;\n    })\n        .then(({ status }) => ({ code: status })), {\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes\n    });\n}\n\n/** Complete multipart uploading. */\nfunction multipartComplete(uuid, { publicKey, baseURL = defaultSettings.baseURL, source = 'local', signal, integration, userAgent, retryThrottledRequestMaxTimes = defaultSettings.retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes = defaultSettings.retryNetworkErrorMaxTimes }) {\n    return retryIfFailed(() => request({\n        method: 'POST',\n        url: getUrl(baseURL, '/multipart/complete/', { jsonerrors: 1 }),\n        headers: {\n            'X-UC-User-Agent': getUserAgent({ publicKey, integration, userAgent })\n        },\n        data: buildFormData({\n            uuid: uuid,\n            UPLOADCARE_PUB_KEY: publicKey,\n            source: source\n        }),\n        signal\n    }).then(({ data, headers, request }) => {\n        const response = camelizeKeys(JSON.parse(data));\n        if ('error' in response) {\n            throw new UploadClientError(response.error.content, response.error.errorCode, request, response, headers);\n        }\n        else {\n            return response;\n        }\n    }), { retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes });\n}\n\nfunction isReadyPoll({ file, publicKey, baseURL, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, signal, onProgress }) {\n    return poll({\n        check: (signal) => info(file, {\n            publicKey,\n            baseURL,\n            signal,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes\n        }).then((response) => {\n            if (response.isReady) {\n                return response;\n            }\n            onProgress && onProgress({ isComputable: true, value: 1 });\n            return false;\n        }),\n        signal\n    });\n}\n\nclass UploadcareFile {\n    uuid;\n    name = null;\n    size = null;\n    isStored = null;\n    isImage = null;\n    mimeType = null;\n    cdnUrl = null;\n    s3Url = null;\n    originalFilename = null;\n    imageInfo = null;\n    videoInfo = null;\n    contentInfo = null;\n    metadata = null;\n    s3Bucket = null;\n    constructor(fileInfo, { baseCDN = defaultSettings.baseCDN, fileName } = {}) {\n        const { uuid, s3Bucket } = fileInfo;\n        const cdnUrl = getUrl(baseCDN, `${uuid}/`);\n        const s3Url = s3Bucket\n            ? getUrl(`https://${s3Bucket}.s3.amazonaws.com/`, `${uuid}/${fileInfo.filename}`)\n            : null;\n        this.uuid = uuid;\n        this.name = fileName || fileInfo.filename;\n        this.size = fileInfo.size;\n        this.isStored = fileInfo.isStored;\n        this.isImage = fileInfo.isImage;\n        this.mimeType = fileInfo.mimeType;\n        this.cdnUrl = cdnUrl;\n        this.originalFilename = fileInfo.originalFilename;\n        this.imageInfo = fileInfo.imageInfo;\n        this.videoInfo = fileInfo.videoInfo;\n        this.contentInfo = fileInfo.contentInfo;\n        this.metadata = fileInfo.metadata || null;\n        this.s3Bucket = s3Bucket || null;\n        this.s3Url = s3Url;\n    }\n}\n\nconst uploadDirect = (file, { publicKey, fileName, baseURL, secureSignature, secureExpire, store, contentType, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, baseCDN, metadata }) => {\n    return base(file, {\n        publicKey,\n        fileName,\n        contentType,\n        baseURL,\n        secureSignature,\n        secureExpire,\n        store,\n        signal,\n        onProgress,\n        source,\n        integration,\n        userAgent,\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes,\n        metadata\n    })\n        .then(({ file }) => {\n        return isReadyPoll({\n            file,\n            publicKey,\n            baseURL,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes,\n            onProgress,\n            signal\n        });\n    })\n        .then((fileInfo) => new UploadcareFile(fileInfo, { baseCDN }));\n};\n\nconst uploadFromUploaded = (uuid, { publicKey, fileName, baseURL, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, baseCDN }) => {\n    return info(uuid, {\n        publicKey,\n        baseURL,\n        signal,\n        source,\n        integration,\n        userAgent,\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes\n    })\n        .then((fileInfo) => new UploadcareFile(fileInfo, { baseCDN, fileName }))\n        .then((result) => {\n        // hack for node ¯\\_(ツ)_/¯\n        if (onProgress)\n            onProgress({\n                isComputable: true,\n                value: 1\n            });\n        return result;\n    });\n};\n\nconst race = (fns, { signal } = {}) => {\n    let lastError = null;\n    let winnerIndex = null;\n    const controllers = fns.map(() => new AbortController());\n    const createStopRaceCallback = (i) => () => {\n        winnerIndex = i;\n        controllers.forEach((controller, index) => index !== i && controller.abort());\n    };\n    onCancel(signal, () => {\n        controllers.forEach((controller) => controller.abort());\n    });\n    return Promise.all(fns.map((fn, i) => {\n        const stopRace = createStopRaceCallback(i);\n        return Promise.resolve()\n            .then(() => fn({ stopRace, signal: controllers[i].signal }))\n            .then((result) => {\n            stopRace();\n            return result;\n        })\n            .catch((error) => {\n            lastError = error;\n            return null;\n        });\n    })).then((results) => {\n        if (winnerIndex === null) {\n            throw lastError;\n        }\n        else {\n            return results[winnerIndex];\n        }\n    });\n};\n\nvar WebSocket = window.WebSocket;\n\nclass Events {\n    events = Object.create({});\n    emit(event, data) {\n        this.events[event]?.forEach((fn) => fn(data));\n    }\n    on(event, callback) {\n        this.events[event] = this.events[event] || [];\n        this.events[event].push(callback);\n    }\n    off(event, callback) {\n        if (callback) {\n            this.events[event] = this.events[event].filter((fn) => fn !== callback);\n        }\n        else {\n            this.events[event] = [];\n        }\n    }\n}\n\nconst response = (type, data) => {\n    if (type === 'success') {\n        return { status: Status.Success, ...data };\n    }\n    if (type === 'progress') {\n        return { status: Status.Progress, ...data };\n    }\n    return { status: Status.Error, ...data };\n};\nclass Pusher {\n    key;\n    disconnectTime;\n    ws = undefined;\n    queue = [];\n    isConnected = false;\n    subscribers = 0;\n    emmitter = new Events();\n    disconnectTimeoutId = null;\n    constructor(pusherKey, disconnectTime = 30000) {\n        this.key = pusherKey;\n        this.disconnectTime = disconnectTime;\n    }\n    connect() {\n        this.disconnectTimeoutId && clearTimeout(this.disconnectTimeoutId);\n        if (!this.isConnected && !this.ws) {\n            const pusherUrl = `wss://ws.pusherapp.com/app/${this.key}?protocol=5&client=js&version=1.12.2`;\n            this.ws = new WebSocket(pusherUrl);\n            this.ws.addEventListener('error', (error) => {\n                this.emmitter.emit('error', new Error(error.message));\n            });\n            this.emmitter.on('connected', () => {\n                this.isConnected = true;\n                this.queue.forEach((message) => this.send(message.event, message.data));\n                this.queue = [];\n            });\n            this.ws.addEventListener('message', (e) => {\n                const data = JSON.parse(e.data.toString());\n                switch (data.event) {\n                    case 'pusher:connection_established': {\n                        this.emmitter.emit('connected', undefined);\n                        break;\n                    }\n                    case 'pusher:ping': {\n                        this.send('pusher:pong', {});\n                        break;\n                    }\n                    case 'progress':\n                    case 'success':\n                    case 'fail': {\n                        this.emmitter.emit(data.channel, response(data.event, JSON.parse(data.data)));\n                    }\n                }\n            });\n        }\n    }\n    disconnect() {\n        const actualDisconect = () => {\n            this.ws?.close();\n            this.ws = undefined;\n            this.isConnected = false;\n        };\n        if (this.disconnectTime) {\n            this.disconnectTimeoutId = setTimeout(() => {\n                actualDisconect();\n            }, this.disconnectTime);\n        }\n        else {\n            actualDisconect();\n        }\n    }\n    send(event, data) {\n        const str = JSON.stringify({ event, data });\n        this.ws?.send(str);\n    }\n    subscribe(token, handler) {\n        this.subscribers += 1;\n        this.connect();\n        const channel = `task-status-${token}`;\n        const message = {\n            event: 'pusher:subscribe',\n            data: { channel }\n        };\n        this.emmitter.on(channel, handler);\n        if (this.isConnected) {\n            this.send(message.event, message.data);\n        }\n        else {\n            this.queue.push(message);\n        }\n    }\n    unsubscribe(token) {\n        this.subscribers -= 1;\n        const channel = `task-status-${token}`;\n        const message = {\n            event: 'pusher:unsubscribe',\n            data: { channel }\n        };\n        this.emmitter.off(channel);\n        if (this.isConnected) {\n            this.send(message.event, message.data);\n        }\n        else {\n            this.queue = this.queue.filter((msg) => msg.data.channel !== channel);\n        }\n        if (this.subscribers === 0) {\n            this.disconnect();\n        }\n    }\n    onError(callback) {\n        this.emmitter.on('error', callback);\n        return () => this.emmitter.off('error', callback);\n    }\n}\nlet pusher = null;\nconst getPusher = (key) => {\n    if (!pusher) {\n        // no timeout for nodeJS and 30000 ms for browser\n        const disconectTimeout = typeof window === 'undefined' ? 0 : 30000;\n        pusher = new Pusher(key, disconectTimeout);\n    }\n    return pusher;\n};\nconst preconnect = (key) => {\n    getPusher(key).connect();\n};\n\nfunction pollStrategy({ token, publicKey, baseURL, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, onProgress, signal }) {\n    return poll({\n        check: (signal) => fromUrlStatus(token, {\n            publicKey,\n            baseURL,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes,\n            signal\n        }).then((response) => {\n            switch (response.status) {\n                case Status.Error: {\n                    return new UploadClientError(response.error, response.errorCode);\n                }\n                case Status.Waiting: {\n                    return false;\n                }\n                case Status.Unknown: {\n                    return new UploadClientError(`Token \"${token}\" was not found.`);\n                }\n                case Status.Progress: {\n                    if (onProgress) {\n                        if (response.total === 'unknown') {\n                            onProgress({ isComputable: false });\n                        }\n                        else {\n                            onProgress({\n                                isComputable: true,\n                                value: response.done / response.total\n                            });\n                        }\n                    }\n                    return false;\n                }\n                case Status.Success: {\n                    if (onProgress)\n                        onProgress({\n                            isComputable: true,\n                            value: response.done / response.total\n                        });\n                    return response;\n                }\n                default: {\n                    throw new Error('Unknown status');\n                }\n            }\n        }),\n        signal\n    });\n}\nconst pushStrategy = ({ token, pusherKey, signal, onProgress }) => new Promise((resolve, reject) => {\n    const pusher = getPusher(pusherKey);\n    const unsubErrorHandler = pusher.onError(reject);\n    const destroy = () => {\n        unsubErrorHandler();\n        pusher.unsubscribe(token);\n    };\n    onCancel(signal, () => {\n        destroy();\n        reject(new CancelError('pusher cancelled'));\n    });\n    pusher.subscribe(token, (result) => {\n        switch (result.status) {\n            case Status.Progress: {\n                if (onProgress) {\n                    if (result.total === 'unknown') {\n                        onProgress({ isComputable: false });\n                    }\n                    else {\n                        onProgress({\n                            isComputable: true,\n                            value: result.done / result.total\n                        });\n                    }\n                }\n                break;\n            }\n            case Status.Success: {\n                destroy();\n                if (onProgress)\n                    onProgress({\n                        isComputable: true,\n                        value: result.done / result.total\n                    });\n                resolve(result);\n                break;\n            }\n            case Status.Error: {\n                destroy();\n                reject(new UploadClientError(result.msg, result.error_code));\n            }\n        }\n    });\n});\nconst uploadFromUrl = (sourceUrl, { publicKey, fileName, baseURL, baseCDN, checkForUrlDuplicates, saveUrlForRecurrentUploads, secureSignature, secureExpire, store, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, pusherKey = defaultSettings.pusherKey, metadata }) => Promise.resolve(preconnect(pusherKey))\n    .then(() => fromUrl(sourceUrl, {\n    publicKey,\n    fileName,\n    baseURL,\n    checkForUrlDuplicates,\n    saveUrlForRecurrentUploads,\n    secureSignature,\n    secureExpire,\n    store,\n    signal,\n    source,\n    integration,\n    userAgent,\n    retryThrottledRequestMaxTimes,\n    metadata\n}))\n    .catch((error) => {\n    const pusher = getPusher(pusherKey);\n    pusher?.disconnect();\n    return Promise.reject(error);\n})\n    .then((urlResponse) => {\n    if (urlResponse.type === TypeEnum.FileInfo) {\n        return urlResponse;\n    }\n    else {\n        return race([\n            ({ signal }) => pollStrategy({\n                token: urlResponse.token,\n                publicKey,\n                baseURL,\n                integration,\n                userAgent,\n                retryThrottledRequestMaxTimes,\n                onProgress,\n                signal\n            }),\n            ({ signal }) => pushStrategy({\n                token: urlResponse.token,\n                pusherKey,\n                signal,\n                onProgress\n            })\n        ], { signal });\n    }\n})\n    .then((result) => {\n    if (result instanceof UploadClientError)\n        throw result;\n    return result;\n})\n    .then((result) => isReadyPoll({\n    file: result.uuid,\n    publicKey,\n    baseURL,\n    integration,\n    userAgent,\n    retryThrottledRequestMaxTimes,\n    onProgress,\n    signal\n}))\n    .then((fileInfo) => new UploadcareFile(fileInfo, { baseCDN }));\n\nconst memo = new WeakMap();\nconst getBlobFromReactNativeAsset = async (asset) => {\n    if (memo.has(asset)) {\n        return memo.get(asset);\n    }\n    const blob = await fetch(asset.uri).then((res) => res.blob());\n    memo.set(asset, blob);\n    return blob;\n};\n\nconst getFileSize = async (file) => {\n    if (isFile(file) || isBlob(file)) {\n        return file.size;\n    }\n    if (isReactNativeAsset(file)) {\n        const blob = await getBlobFromReactNativeAsset(file);\n        return blob.size;\n    }\n    throw new Error(`Unknown file type. Cannot determine file size.`);\n};\n\n/** Check if FileData is multipart data. */\nconst isMultipart = (fileSize, multipartMinFileSize = defaultSettings.multipartMinFileSize) => {\n    return fileSize >= multipartMinFileSize;\n};\n\n/** Uuid type guard. */\nconst isUuid = (data) => {\n    const UUID_REGEX = '[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}';\n    const regExp = new RegExp(UUID_REGEX);\n    return !isFileData(data) && regExp.test(data);\n};\n/**\n * Url type guard.\n *\n * @param {SupportedFileInput | Url | Uuid} data\n */\nconst isUrl = (data) => {\n    const URL_REGEX = '^(?:\\\\w+:)?\\\\/\\\\/([^\\\\s\\\\.]+\\\\.\\\\S{2}|localhost[\\\\:?\\\\d]*)\\\\S*$';\n    const regExp = new RegExp(URL_REGEX);\n    return !isFileData(data) && regExp.test(data);\n};\n\nconst runWithConcurrency = (concurrency, tasks) => {\n    return new Promise((resolve, reject) => {\n        const results = [];\n        let rejected = false;\n        let settled = tasks.length;\n        const forRun = [...tasks];\n        const run = () => {\n            const index = tasks.length - forRun.length;\n            const next = forRun.shift();\n            if (next) {\n                next()\n                    .then((result) => {\n                    if (rejected)\n                        return;\n                    results[index] = result;\n                    settled -= 1;\n                    if (settled) {\n                        run();\n                    }\n                    else {\n                        resolve(results);\n                    }\n                })\n                    .catch((error) => {\n                    rejected = true;\n                    reject(error);\n                });\n            }\n        };\n        for (let i = 0; i < concurrency; i++) {\n            run();\n        }\n    });\n};\n\nconst sliceChunk = (file, index, fileSize, chunkSize) => {\n    const start = chunkSize * index;\n    const end = Math.min(start + chunkSize, fileSize);\n    return file.slice(start, end);\n};\n\nconst prepareChunks = async (file, fileSize, chunkSize) => {\n    return (index) => sliceChunk(file, index, fileSize, chunkSize);\n};\n\nconst uploadPart = (chunk, url, { publicKey, contentType, onProgress, signal, integration, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes }) => multipartUpload(chunk, url, {\n    publicKey,\n    contentType,\n    onProgress,\n    signal,\n    integration,\n    retryThrottledRequestMaxTimes,\n    retryNetworkErrorMaxTimes\n});\nconst uploadMultipart = async (file, { publicKey, fileName, fileSize, baseURL, secureSignature, secureExpire, store, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, contentType, multipartChunkSize = defaultSettings.multipartChunkSize, maxConcurrentRequests = defaultSettings.maxConcurrentRequests, baseCDN, metadata }) => {\n    const size = fileSize ?? (await getFileSize(file));\n    let progressValues;\n    const createProgressHandler = (totalChunks, chunkIdx) => {\n        if (!onProgress)\n            return;\n        if (!progressValues) {\n            progressValues = Array(totalChunks).fill(0);\n        }\n        const sum = (values) => values.reduce((sum, next) => sum + next, 0);\n        return (info) => {\n            if (!info.isComputable) {\n                return;\n            }\n            progressValues[chunkIdx] = info.value;\n            onProgress({\n                isComputable: true,\n                value: sum(progressValues) / totalChunks\n            });\n        };\n    };\n    contentType ||= getContentType(file);\n    return multipartStart(size, {\n        publicKey,\n        contentType,\n        fileName: fileName || getFileName(file),\n        baseURL,\n        secureSignature,\n        secureExpire,\n        store,\n        signal,\n        source,\n        integration,\n        userAgent,\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes,\n        metadata\n    })\n        .then(async ({ uuid, parts }) => {\n        const getChunk = await prepareChunks(file, size, multipartChunkSize);\n        return Promise.all([\n            uuid,\n            runWithConcurrency(maxConcurrentRequests, parts.map((url, index) => () => uploadPart(getChunk(index), url, {\n                publicKey,\n                contentType,\n                onProgress: createProgressHandler(parts.length, index),\n                signal,\n                integration,\n                retryThrottledRequestMaxTimes,\n                retryNetworkErrorMaxTimes\n            })))\n        ]);\n    })\n        .then(([uuid]) => multipartComplete(uuid, {\n        publicKey,\n        baseURL,\n        source,\n        integration,\n        userAgent,\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes\n    }))\n        .then((fileInfo) => {\n        if (fileInfo.isReady) {\n            return fileInfo;\n        }\n        else {\n            return isReadyPoll({\n                file: fileInfo.uuid,\n                publicKey,\n                baseURL,\n                source,\n                integration,\n                userAgent,\n                retryThrottledRequestMaxTimes,\n                retryNetworkErrorMaxTimes,\n                onProgress,\n                signal\n            });\n        }\n    })\n        .then((fileInfo) => new UploadcareFile(fileInfo, { baseCDN }));\n};\n\n/** Uploads file from provided data. */\nasync function uploadFile(data, { publicKey, fileName, baseURL = defaultSettings.baseURL, secureSignature, secureExpire, store, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, contentType, multipartMinFileSize, multipartChunkSize, maxConcurrentRequests, baseCDN = defaultSettings.baseCDN, checkForUrlDuplicates, saveUrlForRecurrentUploads, pusherKey, metadata }) {\n    if (isFileData(data)) {\n        const fileSize = await getFileSize(data);\n        if (isMultipart(fileSize, multipartMinFileSize)) {\n            return uploadMultipart(data, {\n                publicKey,\n                contentType,\n                multipartChunkSize,\n                fileSize,\n                fileName,\n                baseURL,\n                secureSignature,\n                secureExpire,\n                store,\n                signal,\n                onProgress,\n                source,\n                integration,\n                userAgent,\n                maxConcurrentRequests,\n                retryThrottledRequestMaxTimes,\n                retryNetworkErrorMaxTimes,\n                baseCDN,\n                metadata\n            });\n        }\n        return uploadDirect(data, {\n            publicKey,\n            fileName,\n            contentType,\n            baseURL,\n            secureSignature,\n            secureExpire,\n            store,\n            signal,\n            onProgress,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes,\n            baseCDN,\n            metadata\n        });\n    }\n    if (isUrl(data)) {\n        return uploadFromUrl(data, {\n            publicKey,\n            fileName,\n            baseURL,\n            baseCDN,\n            checkForUrlDuplicates,\n            saveUrlForRecurrentUploads,\n            secureSignature,\n            secureExpire,\n            store,\n            signal,\n            onProgress,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes,\n            pusherKey,\n            metadata\n        });\n    }\n    if (isUuid(data)) {\n        return uploadFromUploaded(data, {\n            publicKey,\n            fileName,\n            baseURL,\n            signal,\n            onProgress,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes,\n            baseCDN\n        });\n    }\n    throw new TypeError(`File uploading from \"${data}\" is not supported`);\n}\n\nclass UploadcareGroup {\n    uuid;\n    filesCount;\n    totalSize;\n    isStored;\n    isImage;\n    cdnUrl;\n    files;\n    createdAt;\n    storedAt = null;\n    constructor(groupInfo, files) {\n        this.uuid = groupInfo.id;\n        this.filesCount = groupInfo.filesCount;\n        this.totalSize = Object.values(groupInfo.files).reduce((acc, file) => acc + file.size, 0);\n        this.isStored = !!groupInfo.datetimeStored;\n        this.isImage = !!Object.values(groupInfo.files).filter((file) => file.isImage).length;\n        this.cdnUrl = groupInfo.cdnUrl;\n        this.files = files;\n        this.createdAt = groupInfo.datetimeCreated;\n        this.storedAt = groupInfo.datetimeStored;\n    }\n}\n\n/** FileData type guard. */\nconst isFileDataArray = (data) => {\n    for (const item of data) {\n        if (!isFileData(item)) {\n            return false;\n        }\n    }\n    return true;\n};\n/** Uuid type guard. */\nconst isUuidArray = (data) => {\n    for (const item of data) {\n        if (!isUuid(item)) {\n            return false;\n        }\n    }\n    return true;\n};\n/** Url type guard. */\nconst isUrlArray = (data) => {\n    for (const item of data) {\n        if (!isUrl(item)) {\n            return false;\n        }\n    }\n    return true;\n};\n\nfunction uploadFileGroup(data, { publicKey, fileName, baseURL = defaultSettings.baseURL, secureSignature, secureExpire, store, signal, onProgress, source, integration, userAgent, retryThrottledRequestMaxTimes, retryNetworkErrorMaxTimes, contentType, multipartChunkSize = defaultSettings.multipartChunkSize, baseCDN = defaultSettings.baseCDN, checkForUrlDuplicates, saveUrlForRecurrentUploads, jsonpCallback }) {\n    if (!isFileDataArray(data) && !isUrlArray(data) && !isUuidArray(data)) {\n        throw new TypeError(`Group uploading from \"${data}\" is not supported`);\n    }\n    let progressValues;\n    let isStillComputable = true;\n    const filesCount = data.length;\n    const createProgressHandler = (size, index) => {\n        if (!onProgress)\n            return;\n        if (!progressValues) {\n            progressValues = Array(size).fill(0);\n        }\n        const normalize = (values) => values.reduce((sum, next) => sum + next) / size;\n        return (info) => {\n            if (!info.isComputable || !isStillComputable) {\n                isStillComputable = false;\n                onProgress({ isComputable: false });\n                return;\n            }\n            progressValues[index] = info.value;\n            onProgress({ isComputable: true, value: normalize(progressValues) });\n        };\n    };\n    return Promise.all(data.map((file, index) => uploadFile(file, {\n        publicKey,\n        fileName,\n        baseURL,\n        secureSignature,\n        secureExpire,\n        store,\n        signal,\n        onProgress: createProgressHandler(filesCount, index),\n        source,\n        integration,\n        userAgent,\n        retryThrottledRequestMaxTimes,\n        retryNetworkErrorMaxTimes,\n        contentType,\n        multipartChunkSize,\n        baseCDN,\n        checkForUrlDuplicates,\n        saveUrlForRecurrentUploads\n    }))).then((files) => {\n        const uuids = files.map((file) => file.uuid);\n        return group(uuids, {\n            publicKey,\n            baseURL,\n            jsonpCallback,\n            secureSignature,\n            secureExpire,\n            signal,\n            source,\n            integration,\n            userAgent,\n            retryThrottledRequestMaxTimes,\n            retryNetworkErrorMaxTimes\n        })\n            .then((groupInfo) => new UploadcareGroup(groupInfo, files))\n            .then((group) => {\n            onProgress && onProgress({ isComputable: true, value: 1 });\n            return group;\n        });\n    });\n}\n\n/** Populate options with settings. */\nconst populateOptionsWithSettings = (options, settings) => ({\n    ...settings,\n    ...options\n});\nclass UploadClient {\n    settings;\n    constructor(settings) {\n        this.settings = Object.assign({}, defaultSettings, settings);\n    }\n    updateSettings(newSettings) {\n        this.settings = Object.assign(this.settings, newSettings);\n    }\n    getSettings() {\n        return this.settings;\n    }\n    base(file, options = {}) {\n        const settings = this.getSettings();\n        return base(file, populateOptionsWithSettings(options, settings));\n    }\n    info(uuid, options = {}) {\n        const settings = this.getSettings();\n        return info(uuid, populateOptionsWithSettings(options, settings));\n    }\n    fromUrl(sourceUrl, options = {}) {\n        const settings = this.getSettings();\n        return fromUrl(sourceUrl, populateOptionsWithSettings(options, settings));\n    }\n    fromUrlStatus(token, options = {}) {\n        const settings = this.getSettings();\n        return fromUrlStatus(token, populateOptionsWithSettings(options, settings));\n    }\n    group(uuids, options = {}) {\n        const settings = this.getSettings();\n        return group(uuids, populateOptionsWithSettings(options, settings));\n    }\n    groupInfo(id, options = {}) {\n        const settings = this.getSettings();\n        return groupInfo(id, populateOptionsWithSettings(options, settings));\n    }\n    multipartStart(size, options = {}) {\n        const settings = this.getSettings();\n        return multipartStart(size, populateOptionsWithSettings(options, settings));\n    }\n    multipartUpload(part, url, options = {}) {\n        const settings = this.getSettings();\n        return multipartUpload(part, url, populateOptionsWithSettings(options, settings));\n    }\n    multipartComplete(uuid, options = {}) {\n        const settings = this.getSettings();\n        return multipartComplete(uuid, populateOptionsWithSettings(options, settings));\n    }\n    uploadFile(data, options = {}) {\n        const settings = this.getSettings();\n        return uploadFile(data, populateOptionsWithSettings(options, settings));\n    }\n    uploadFileGroup(data, options = {}) {\n        const settings = this.getSettings();\n        return uploadFileGroup(data, populateOptionsWithSettings(options, settings));\n    }\n}\n\nclass Queue {\n    #concurrency = 1;\n    #pending = [];\n    #running = 0;\n    #resolvers = new WeakMap();\n    #rejectors = new WeakMap();\n    constructor(concurrency) {\n        this.#concurrency = concurrency;\n    }\n    #run() {\n        const tasksLeft = this.#concurrency - this.#running;\n        for (let i = 0; i < tasksLeft; i++) {\n            const task = this.#pending.shift();\n            if (!task) {\n                return;\n            }\n            const resolver = this.#resolvers.get(task);\n            const rejector = this.#rejectors.get(task);\n            if (!resolver || !rejector)\n                throw new Error('Unexpected behavior: resolver or rejector is undefined');\n            this.#running += 1;\n            task()\n                .finally(() => {\n                this.#resolvers.delete(task);\n                this.#rejectors.delete(task);\n                this.#running -= 1;\n                this.#run();\n            })\n                .then((value) => resolver(value))\n                .catch((error) => rejector(error));\n        }\n    }\n    add(task) {\n        return new Promise((resolve, reject) => {\n            this.#resolvers.set(task, resolve);\n            this.#rejectors.set(task, reject);\n            this.#pending.push(task);\n            this.#run();\n        });\n    }\n    get pending() {\n        return this.#pending.length;\n    }\n    get running() {\n        return this.#running;\n    }\n    set concurrency(value) {\n        this.#concurrency = value;\n        this.#run();\n    }\n    get concurrency() {\n        return this.#concurrency;\n    }\n}\n\nexport { Queue, UploadClient, UploadClientError, UploadcareFile, UploadcareGroup, UploadcareNetworkError, base, fromUrl, fromUrlStatus, getUserAgent$1 as getUserAgent, group, groupInfo, info, multipartComplete, multipartStart, multipartUpload, uploadDirect, uploadFile, uploadFileGroup, uploadFromUploaded, uploadFromUrl, uploadMultipart };\n", "import { UploadcareFile } from '@uploadcare/upload-client';\n\n/**\n * @typedef {Object} UploadEntry\n * @property {File} file\n * @property {String} externalUrl\n * @property {String} fileName\n * @property {number} fileSize\n * @property {number} lastModified\n * @property {number} uploadProgress\n * @property {String} uuid\n * @property {Boolean} isImage\n * @property {String} mimeType\n * @property {Error} uploadError\n * @property {String} validationErrorMsg\n * @property {String} ctxName\n * @property {String} cdnUrl\n * @property {String} cdnUrlModifiers\n * @property {UploadcareFile} fileInfo\n * @property {Boolean} isUploading\n */\n\n/** @type {{ [key in keyof UploadEntry]: { type; value; nullable?: Boolean } }} */\nexport const uploadEntrySchema = Object.freeze({\n  file: {\n    type: File,\n    value: null,\n  },\n  externalUrl: {\n    type: String,\n    value: null,\n  },\n  fileName: {\n    type: String,\n    value: null,\n    nullable: true,\n  },\n  fileSize: {\n    type: Number,\n    value: null,\n  },\n  lastModified: {\n    type: Number,\n    value: Date.now(),\n  },\n  uploadProgress: {\n    type: Number,\n    value: 0,\n  },\n  uuid: {\n    type: String,\n    value: null,\n  },\n  isImage: {\n    type: Boolean,\n    value: false,\n  },\n  mimeType: {\n    type: String,\n    value: null,\n  },\n  uploadError: {\n    // TODO: there could be Error or UploadcareClientError\n    type: Error,\n    value: null,\n    nullable: true,\n  },\n  validationErrorMsg: {\n    type: String,\n    value: null,\n    nullable: true,\n  },\n  ctxName: {\n    type: String,\n    value: null,\n  },\n  cdnUrl: {\n    type: String,\n    value: null,\n  },\n  cdnUrlModifiers: {\n    type: String,\n    value: null,\n  },\n  fileInfo: {\n    type: UploadcareFile,\n    value: null,\n  },\n  isUploading: {\n    type: Boolean,\n    value: false,\n  },\n  abortController: {\n    type: AbortController,\n    value: null,\n    nullable: true,\n  },\n  thumbUrl: {\n    type: String,\n    value: null,\n    nullable: true,\n  },\n});\n", "import { getUserAgent } from '@uploadcare/upload-client';\nimport { PACKAGE_VERSION, PACKAGE_NAME } from '../../env.js';\n\n/**\n * @param {import('@uploadcare/upload-client').CustomUserAgentOptions} options\n * @returns {ReturnType<import('@uploadcare/upload-client').CustomUserAgentFn>}\n */\nexport function customUserAgent(options) {\n  return getUserAgent({\n    ...options,\n    libraryName: PACKAGE_NAME,\n    libraryVersion: PACKAGE_VERSION,\n  });\n}\n", "import { Data, UID } from '@symbiotejs/symbiote';\n\nconst MSG_NAME = '[Typed State] Wrong property name: ';\nconst MSG_TYPE = '[Typed State] Wrong property type: ';\n\nexport class TypedData {\n  /**\n   * @param {Object<string, { type: any; value: any; nullable?: Boolean }>} typedSchema\n   * @param {String} [ctxName]\n   */\n  constructor(typedSchema, ctxName) {\n    /** @private */\n    this.__typedSchema = typedSchema;\n    /** @private */\n    this.__ctxId = ctxName || UID.generate();\n    /** @private */\n    this.__schema = Object.keys(typedSchema).reduce((acc, key) => {\n      acc[key] = typedSchema[key].value;\n      return acc;\n    }, {});\n    /**\n     * @private\n     * @type {Data}\n     */\n    this.__data = Data.registerCtx(this.__schema, this.__ctxId);\n  }\n\n  /** @returns {String} */\n  get uid() {\n    return this.__ctxId;\n  }\n\n  /**\n   * @param {String} prop\n   * @param {any} value\n   */\n  setValue(prop, value) {\n    if (!this.__typedSchema.hasOwnProperty(prop)) {\n      console.warn(MSG_NAME + prop);\n      return;\n    }\n    let pDesc = this.__typedSchema[prop];\n    if (value?.constructor === pDesc.type || value instanceof pDesc.type || (pDesc.nullable && value === null)) {\n      this.__data.pub(prop, value);\n      return;\n    }\n    console.warn(MSG_TYPE + prop);\n  }\n\n  /** @param {Object<string, any>} updObj */\n  setMultipleValues(updObj) {\n    for (let prop in updObj) {\n      this.setValue(prop, updObj[prop]);\n    }\n  }\n\n  /** @param {String} prop */\n  getValue(prop) {\n    if (!this.__typedSchema.hasOwnProperty(prop)) {\n      console.warn(MSG_NAME + prop);\n      return undefined;\n    }\n    return this.__data.read(prop);\n  }\n\n  /**\n   * @param {String} prop\n   * @param {(newVal: any) => void} handler\n   */\n  subscribe(prop, handler) {\n    return this.__data.sub(prop, handler);\n  }\n\n  remove() {\n    Data.deleteCtx(this.__ctxId);\n  }\n}\n", "import { Data, UID } from '@symbiotejs/symbiote';\nimport { TypedData } from './TypedData.js';\n\nexport class TypedCollection {\n  /**\n   * @param {Object} options\n   * @param {Object<string, { type: any; value: any }>} options.typedSchema\n   * @param {String[]} [options.watchList]\n   * @param {(list: string[], added: Set<any>, removed: Set<any>) => void} [options.handler]\n   * @param {String} [options.ctxName]\n   */\n  constructor(options) {\n    /**\n     * @private\n     * @type {Object<string, { type: any; value: any }>}\n     */\n    this.__typedSchema = options.typedSchema;\n    /**\n     * @private\n     * @type {String}\n     */\n    this.__ctxId = options.ctxName || UID.generate();\n    /**\n     * @private\n     * @type {Data}\n     */\n    this.__data = Data.registerCtx({}, this.__ctxId);\n    /**\n     * @private\n     * @type {string[]}\n     */\n    this.__watchList = options.watchList || [];\n    /**\n     * @private\n     * @type {(list: string[], added: Set<any>, removed: Set<any>) => void}\n     */\n    this.__handler = options.handler || null;\n    /**\n     * @private\n     * @type {Object<string, any>}\n     */\n    this.__subsMap = Object.create(null);\n    /**\n     * @private\n     * @type {Set}\n     */\n    this.__observers = new Set();\n    /**\n     * @private\n     * @type {Set<string>}\n     */\n    this.__items = new Set();\n    /**\n     * @private\n     * @type {Set<any>}\n     */\n    this.__removed = new Set();\n    /**\n     * @private\n     * @type {Set<any>}\n     */\n    this.__added = new Set();\n\n    let changeMap = Object.create(null);\n\n    /**\n     * @private\n     * @param {String} propName\n     * @param {String} ctxId\n     */\n    this.__notifyObservers = (propName, ctxId) => {\n      if (this.__observeTimeout) {\n        window.clearTimeout(this.__observeTimeout);\n      }\n      if (!changeMap[propName]) {\n        changeMap[propName] = new Set();\n      }\n      changeMap[propName].add(ctxId);\n      /** @private */\n      this.__observeTimeout = window.setTimeout(() => {\n        this.__observers.forEach((handler) => {\n          handler({ ...changeMap });\n        });\n        changeMap = Object.create(null);\n      });\n    };\n  }\n\n  notify() {\n    if (this.__notifyTimeout) {\n      window.clearTimeout(this.__notifyTimeout);\n    }\n    /** @private */\n    this.__notifyTimeout = window.setTimeout(() => {\n      let added = this.__added;\n      let removed = this.__removed;\n      this.__added.clear();\n      this.__removed.clear();\n      this.__handler?.([...this.__items], added, removed);\n    });\n  }\n\n  /**\n   * @param {Object<string, any>} init\n   * @returns {any}\n   */\n  add(init) {\n    let item = new TypedData(this.__typedSchema);\n    for (let prop in init) {\n      item.setValue(prop, init[prop]);\n    }\n    this.__data.add(item.uid, item);\n    this.__added.add(item);\n    this.__watchList.forEach((propName) => {\n      if (!this.__subsMap[item.uid]) {\n        this.__subsMap[item.uid] = [];\n      }\n      this.__subsMap[item.uid].push(\n        item.subscribe(propName, () => {\n          this.__notifyObservers(propName, item.uid);\n        })\n      );\n    });\n    this.__items.add(item.uid);\n    this.notify();\n    return item;\n  }\n\n  /**\n   * @param {String} id\n   * @returns {TypedData}\n   */\n  read(id) {\n    return this.__data.read(id);\n  }\n\n  /**\n   * @param {String} id\n   * @param {String} propName\n   * @returns {any}\n   */\n  readProp(id, propName) {\n    let item = this.read(id);\n    return item.getValue(propName);\n  }\n\n  /**\n   * @template T\n   * @param {String} id\n   * @param {String} propName\n   * @param {T} value\n   */\n  publishProp(id, propName, value) {\n    let item = this.read(id);\n    item.setValue(propName, value);\n  }\n\n  /** @param {String} id */\n  remove(id) {\n    this.__removed.add(this.__data.read(id));\n    this.__items.delete(id);\n    this.notify();\n    this.__data.pub(id, null);\n    delete this.__subsMap[id];\n  }\n\n  clearAll() {\n    this.__items.forEach((id) => {\n      this.remove(id);\n    });\n  }\n\n  /** @param {Function} handler */\n  observe(handler) {\n    this.__observers.add(handler);\n  }\n\n  /** @param {Function} handler */\n  unobserve(handler) {\n    this.__observers.delete(handler);\n  }\n\n  /**\n   * @param {(item: TypedData) => Boolean} checkFn\n   * @returns {String[]}\n   */\n  findItems(checkFn) {\n    let result = [];\n    this.__items.forEach((id) => {\n      let item = this.read(id);\n      if (checkFn(item)) {\n        result.push(id);\n      }\n    });\n    return result;\n  }\n\n  items() {\n    return [...this.__items];\n  }\n\n  get size() {\n    return this.__items.size;\n  }\n\n  destroy() {\n    Data.deleteCtx(this.__data);\n    this.__observers = null;\n    for (let id in this.__subsMap) {\n      this.__subsMap[id].forEach((sub) => {\n        sub.remove();\n      });\n      delete this.__subsMap[id];\n    }\n  }\n}\n", "/** @enum {String} */\nexport const EVENT_TYPES = {\n  UPLOAD_START: 'UPLOAD_START',\n  REMOVE: 'REMOVE',\n  UPLOAD_PROGRESS: 'UPLOAD_PROGRESS',\n  UPLOAD_FINISH: 'UPLOAD_FINISH',\n  UPLOAD_ERROR: 'UPLOAD_ERROR',\n  VALIDATION_ERROR: 'VALIDATION_ERROR',\n  CDN_MODIFICATION: 'CLOUD_MODIFICATION',\n  DATA_OUTPUT: 'DATA_OUTPUT',\n  DONE_FLOW: 'DONE_FLOW',\n  INIT_FLOW: 'INIT_FLOW',\n};\n\nexport class EventData {\n  /**\n   * @param {Object} src\n   * @param {EVENT_TYPES} src.type\n   * @param {String} src.ctx\n   * @param {any} [src.data]\n   */\n  constructor(src) {\n    /** @type {String} */\n    this.ctx = src.ctx;\n    /** @type {EVENT_TYPES} */\n    this.type = src.type;\n    this.data = src.data;\n  }\n}\n\nexport class EventManager {\n  /** @param {EVENT_TYPES} type */\n  static eName(type) {\n    return 'LR_' + type;\n  }\n\n  /** @private */\n  static _timeoutStore = Object.create(null);\n\n  /**\n   * @param {EventData} eData\n   * @param {import('./UploaderBlock.js').UploaderBlock | Window} [el]\n   * @param {Boolean} [debounce]\n   */\n  static emit(eData, el = window, debounce = true) {\n    let dispatch = () => {\n      el.dispatchEvent(\n        new CustomEvent(this.eName(eData.type), {\n          detail: eData,\n        })\n      );\n    };\n    if (!debounce) {\n      dispatch();\n      return;\n    }\n    let timeoutKey = eData.type + eData.ctx;\n    if (this._timeoutStore[timeoutKey]) {\n      window.clearTimeout(this._timeoutStore[timeoutKey]);\n    }\n    this._timeoutStore[timeoutKey] = window.setTimeout(() => {\n      dispatch();\n      delete this._timeoutStore[timeoutKey];\n    }, 20);\n  }\n}\n", "import { ActivityBlock } from './ActivityBlock.js';\n\nimport { Data } from '@symbiotejs/symbiote';\nimport { IMAGE_ACCEPT_LIST, mergeFileTypes, fileIsImage } from '../utils/fileTypes.js';\nimport { uploadEntrySchema } from './uploadEntrySchema.js';\nimport { customUserAgent } from '../blocks/utils/userAgent.js';\nimport { TypedCollection } from './TypedCollection.js';\nimport { uploaderBlockCtx } from './CTX.js';\nimport { EVENT_TYPES, EventData, EventManager } from './EventManager.js';\nimport { Modal } from '../blocks/Modal/Modal.js';\nimport { stringToArray } from '../utils/stringToArray.js';\n\nexport class UploaderBlock extends ActivityBlock {\n  ctxInit = uploaderBlockCtx(this);\n\n  /** @private */\n  __initialUploadMetadata = null;\n\n  /**\n   * This is Public JS API method. Could be called before block initialization, so we need to delay state interactions\n   * until block init.\n   *\n   * TODO: If we add more public methods, it is better to use the single queue instead of tons of private fields per\n   * each method. See https://github.com/uploadcare/blocks/pull/162/\n   *\n   * @param {import('@uploadcare/upload-client').Metadata} metadata\n   * @public\n   */\n  setUploadMetadata(metadata) {\n    if (!this.connectedOnce) {\n      this.__initialUploadMetadata = metadata;\n    } else {\n      this.$['*uploadMetadata'] = metadata;\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n    if (this.__initialUploadMetadata) {\n      this.$['*uploadMetadata'] = this.__initialUploadMetadata;\n    }\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n\n    let blocksRegistry = this.$['*blocksRegistry'];\n    if (blocksRegistry.has(this)) {\n      this.uploadCollection.unobserve(this._handleCollectionUpdate);\n      blocksRegistry.delete(this);\n    }\n  }\n\n  /** @param {File[]} files */\n  addFiles(files) {\n    files.forEach((/** @type {File} */ file) => {\n      this.uploadCollection.add({\n        file,\n        isImage: fileIsImage(file),\n        mimeType: file.type,\n        fileName: file.name,\n        fileSize: file.size,\n      });\n    });\n  }\n\n  /** @param {{ captureCamera?: boolean }} options */\n  openSystemDialog(options = {}) {\n    let accept = mergeFileTypes([\n      this.getCssData('--cfg-accept'),\n      ...(this.getCssData('--cfg-img-only') ? IMAGE_ACCEPT_LIST : []),\n    ]).join(',');\n\n    if (this.getCssData('--cfg-accept') && !!this.getCssData('--cfg-img-only')) {\n      console.warn(\n        'There could be a mistake.\\n' +\n          'Both `--cfg-accept` and `--cfg-img-only` parameters are set.\\n' +\n          'The value of `--cfg-accept` will be concatenated with the internal image mime types list.'\n      );\n    }\n    this.fileInput = document.createElement('input');\n    this.fileInput.type = 'file';\n    this.fileInput.multiple = !!this.getCssData('--cfg-multiple');\n    if (options.captureCamera) {\n      this.fileInput.capture = '';\n      this.fileInput.accept = IMAGE_ACCEPT_LIST.join(',');\n    } else {\n      this.fileInput.accept = accept;\n    }\n    this.fileInput.dispatchEvent(new MouseEvent('click'));\n    this.fileInput.onchange = () => {\n      this.addFiles([...this.fileInput['files']]);\n      // To call uploadTrigger UploadList should draw file items first:\n      this.$['*currentActivity'] = ActivityBlock.activities.UPLOAD_LIST;\n      this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', true);\n      this.fileInput['value'] = '';\n      this.fileInput = null;\n    };\n  }\n\n  /** @type {String[]} */\n  get sourceList() {\n    let list = null;\n    if (this.getCssData('--cfg-source-list')) {\n      list = stringToArray(this.getCssData('--cfg-source-list'));\n    }\n    return list;\n  }\n\n  /** @param {Boolean} [force] */\n  initFlow(force = false) {\n    if (this.$['*uploadList']?.length && !force) {\n      this.set$({\n        '*currentActivity': ActivityBlock.activities.UPLOAD_LIST,\n      });\n      this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', true);\n    } else {\n      if (this.sourceList?.length === 1) {\n        let srcKey = this.sourceList[0];\n        // Single source case:\n        if (srcKey === 'local') {\n          this.$['*currentActivity'] = ActivityBlock.activities.UPLOAD_LIST;\n          this?.['openSystemDialog']();\n        } else {\n          if (Object.values(UploaderBlock.extSrcList).includes(/** @type {any} */ (srcKey))) {\n            this.set$({\n              '*currentActivityParams': {\n                externalSourceType: srcKey,\n              },\n              '*currentActivity': ActivityBlock.activities.EXTERNAL,\n            });\n          } else {\n            this.$['*currentActivity'] = srcKey;\n          }\n          this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', true);\n        }\n      } else {\n        // Multiple sources case:\n        this.set$({\n          '*currentActivity': ActivityBlock.activities.START_FROM,\n        });\n        this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', true);\n      }\n    }\n    EventManager.emit(\n      new EventData({\n        type: EVENT_TYPES.INIT_FLOW,\n        ctx: this.ctxName,\n      }),\n      undefined,\n      false\n    );\n  }\n\n  doneFlow() {\n    this.set$({\n      '*currentActivity': this.doneActivity,\n      '*history': this.doneActivity ? [this.doneActivity] : [],\n    });\n    if (!this.$['*currentActivity']) {\n      this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', false);\n    }\n    EventManager.emit(\n      new EventData({\n        type: EVENT_TYPES.DONE_FLOW,\n        ctx: this.ctxName,\n      }),\n      undefined,\n      false\n    );\n  }\n\n  /** @returns {TypedCollection} */\n  get uploadCollection() {\n    if (!this.has('*uploadCollection')) {\n      let uploadCollection = new TypedCollection({\n        typedSchema: uploadEntrySchema,\n        watchList: ['uploadProgress', 'uuid', 'uploadError', 'validationErrorMsg', 'cdnUrlModifiers'],\n        handler: (entries, added, removed) => {\n          for (let entry of removed) {\n            entry?.getValue('abortController')?.abort();\n            entry?.setValue('abortController', null);\n            URL.revokeObjectURL(entry?.getValue('thumbUrl'));\n          }\n          this.$['*uploadList'] = entries.map((uid) => {\n            return { uid };\n          });\n        },\n      });\n      uploadCollection.observe(this._handleCollectionUpdate);\n      this.add('*uploadCollection', uploadCollection);\n    }\n    return this.$['*uploadCollection'];\n  }\n\n  /** @private */\n  _handleCollectionUpdate = (changeMap) => {\n    let uploadCollection = this.uploadCollection;\n    if (changeMap.uploadProgress) {\n      let commonProgress = 0;\n      /** @type {String[]} */\n      let items = uploadCollection.findItems((entry) => {\n        return !entry.getValue('uploadError');\n      });\n      items.forEach((id) => {\n        commonProgress += uploadCollection.readProp(id, 'uploadProgress');\n      });\n      let progress = Math.round(commonProgress / items.length);\n      this.$['*commonProgress'] = progress;\n      EventManager.emit(\n        new EventData({\n          type: EVENT_TYPES.UPLOAD_PROGRESS,\n          ctx: this.ctxName,\n          data: progress,\n        }),\n        undefined,\n        progress === 100\n      );\n    }\n    if (changeMap.uuid) {\n      let loadedItems = uploadCollection.findItems((entry) => {\n        return !!entry.getValue('uuid');\n      });\n      let errorItems = uploadCollection.findItems((entry) => {\n        return !!entry.getValue('uploadError') || !!entry.getValue('validationErrorMsg');\n      });\n      if (uploadCollection.size - errorItems.length === loadedItems.length) {\n        let data = this.getOutputData((dataItem) => {\n          return !!dataItem.getValue('uuid');\n        });\n        EventManager.emit(\n          new EventData({\n            type: EVENT_TYPES.UPLOAD_FINISH,\n            ctx: this.ctxName,\n            data,\n          })\n        );\n      }\n    }\n    if (changeMap.uploadError) {\n      let items = uploadCollection.findItems((entry) => {\n        return !!entry.getValue('uploadError');\n      });\n      items.forEach((id) => {\n        EventManager.emit(\n          new EventData({\n            type: EVENT_TYPES.UPLOAD_ERROR,\n            ctx: this.ctxName,\n            data: uploadCollection.readProp(id, 'uploadError'),\n          }),\n          undefined,\n          false\n        );\n      });\n    }\n    if (changeMap.validationErrorMsg) {\n      let items = uploadCollection.findItems((entry) => {\n        return !!entry.getValue('validationErrorMsg');\n      });\n      items.forEach((id) => {\n        EventManager.emit(\n          new EventData({\n            type: EVENT_TYPES.VALIDATION_ERROR,\n            ctx: this.ctxName,\n            data: uploadCollection.readProp(id, 'validationErrorMsg'),\n          }),\n          undefined,\n          false\n        );\n      });\n    }\n    if (changeMap.cdnUrlModifiers) {\n      let items = uploadCollection.findItems((entry) => {\n        return !!entry.getValue('cdnUrlModifiers');\n      });\n      items.forEach((id) => {\n        EventManager.emit(\n          new EventData({\n            type: EVENT_TYPES.CDN_MODIFICATION,\n            ctx: this.ctxName,\n            data: Data.getCtx(id).store,\n          }),\n          undefined,\n          false\n        );\n      });\n    }\n  };\n\n  /** @returns {import('@uploadcare/upload-client').FileFromOptions} */\n  getUploadClientOptions() {\n    let store = this.getCssData('--cfg-store', true);\n    let options = {\n      // undefined 'store' means 'auto'\n      store: store === null ? undefined : !!store,\n      publicKey: this.getCssData('--cfg-pubkey'),\n      baseCDN: this.getCssData('--cfg-cdn-cname'),\n      baseURL: this.getCssData('--cfg-base-url'),\n      userAgent: customUserAgent,\n      integration: this.getCssData('--cfg-user-agent-integration'),\n      secureSignature: this.getCssData('--cfg-secure-signature'),\n      secureExpire: this.getCssData('--cfg-secure-expire'),\n      retryThrottledRequestMaxTimes: this.getCssData('--cfg-retry-throttled-request-max-times'),\n      multipartMinFileSize: this.getCssData('--cfg-multipart-min-file-size'),\n      multipartChunkSize: this.getCssData('--cfg-multipart-chunk-size'),\n      maxConcurrentRequests: this.getCssData('--cfg-max-concurrent-requests'),\n      multipartMaxAttempts: this.getCssData('--cfg-multipart-max-attempts'),\n      checkForUrlDuplicates: !!this.getCssData('--cfg-check-for-url-duplicates'),\n      saveUrlForRecurrentUploads: !!this.getCssData('--cfg-save-url-for-recurrent-uploads'),\n      metadata: this.$['*uploadMetadata'],\n    };\n\n    console.log('Upload client options:', options);\n\n    return options;\n  }\n\n  /** @param {(item: import('./TypedData.js').TypedData) => Boolean} checkFn */\n  getOutputData(checkFn) {\n    let data = [];\n    let items = this.uploadCollection.findItems(checkFn);\n    items.forEach((itemId) => {\n      let uploadEntryData = Data.getCtx(itemId).store;\n      /** @type {import('@uploadcare/upload-client').UploadcareFile} */\n      let fileInfo = uploadEntryData.fileInfo || {\n        name: uploadEntryData.fileName,\n        fileSize: uploadEntryData.fileSize,\n        isImage: uploadEntryData.isImage,\n        mimeType: uploadEntryData.mimeType,\n      };\n      let outputItem = {\n        ...fileInfo,\n        cdnUrlModifiers: uploadEntryData.cdnUrlModifiers,\n        cdnUrl: uploadEntryData.cdnUrl || fileInfo.cdnUrl,\n      };\n      data.push(outputItem);\n    });\n    return data;\n  }\n}\n\n/** @enum {String} */\nUploaderBlock.extSrcList = Object.freeze({\n  FACEBOOK: 'facebook',\n  DROPBOX: 'dropbox',\n  GDRIVE: 'gdrive',\n  GPHOTOS: 'gphotos',\n  INSTAGRAM: 'instagram',\n  FLICKR: 'flickr',\n  VK: 'vk',\n  EVERNOTE: 'evernote',\n  BOX: 'box',\n  ONEDRIVE: 'onedrive',\n  HUDDLE: 'huddle',\n});\n\n/** @enum {String} */\nUploaderBlock.sourceTypes = Object.freeze({\n  LOCAL: 'local',\n  URL: 'url',\n  CAMERA: 'camera',\n  DRAW: 'draw',\n  ...UploaderBlock.extSrcList,\n});\n\nObject.values(EVENT_TYPES).forEach((eType) => {\n  let eName = EventManager.eName(eType);\n  window.addEventListener(eName, (e) => {\n    let outputTypes = [EVENT_TYPES.UPLOAD_FINISH, EVENT_TYPES.REMOVE, EVENT_TYPES.CDN_MODIFICATION];\n    if (outputTypes.includes(e.detail.type)) {\n      let dataCtx = Data.getCtx(e.detail.ctx);\n      /** @type {TypedCollection} */\n      let uploadCollection = dataCtx.read('uploadCollection');\n      let data = [];\n      uploadCollection.items().forEach((id) => {\n        let uploadEntryData = Data.getCtx(id).store;\n        /** @type {import('@uploadcare/upload-client').UploadcareFile} */\n        let fileInfo = uploadEntryData.fileInfo;\n        if (fileInfo) {\n          let outputItem = {\n            ...fileInfo,\n            cdnUrlModifiers: uploadEntryData.cdnUrlModifiers,\n            cdnUrl: uploadEntryData.cdnUrl || fileInfo.cdnUrl,\n          };\n          data.push(outputItem);\n        }\n      });\n      EventManager.emit(\n        new EventData({\n          type: EVENT_TYPES.DATA_OUTPUT,\n          ctx: e.detail.ctx,\n          data,\n        })\n      );\n      dataCtx.pub('outputData', data);\n    }\n  });\n});\n", "import { Block } from '../../abstract/Block.js';\n\nexport class Icon extends Block {\n  init$ = {\n    ...this.ctxInit,\n    name: '',\n    path: '',\n    size: '24',\n    viewBox: '',\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.sub('name', (val) => {\n      if (!val) {\n        return;\n      }\n      let path = this.getCssData(`--icon-${val}`);\n      if (path) {\n        this.$.path = path;\n      }\n    });\n\n    this.sub('path', (path) => {\n      if (!path) {\n        return;\n      }\n      let isRaw = path.trimStart().startsWith('<');\n      if (isRaw) {\n        this.setAttribute('raw', '');\n        this.ref.svg.innerHTML = path;\n      } else {\n        this.removeAttribute('raw');\n        this.ref.svg.innerHTML = `<path fill-rule=\"evenodd\" d=\"${path}\"></path>`;\n      }\n    });\n\n    this.sub('size', (size) => {\n      this.$.viewBox = `0 0 ${size} ${size}`;\n    });\n  }\n}\n\nIcon.template = /* HTML */ `\n  <svg ref=\"svg\" xmlns=\"http://www.w3.org/2000/svg\" set=\"@viewBox: viewBox; @height: size; @width: size\"></svg>\n`;\n\nIcon.bindAttributes({\n  name: 'name',\n  size: 'size',\n});\n", "/**\n * Trim leading `-/`, `/` and trailing `/` from CDN operation\n *\n * @param {String | unknown} [operation]\n * @returns {String}\n */\nexport const normalizeCdnOperation = (operation) => {\n  if (typeof operation !== 'string' || !operation) {\n    return '';\n  }\n  let str = operation.trim();\n  if (str.startsWith('-/')) {\n    str = str.slice(2);\n  } else if (str.startsWith('/')) {\n    str = str.slice(1);\n  }\n\n  if (str.endsWith('/')) {\n    str = str.slice(0, str.length - 1);\n  }\n  return str;\n};\n\n/**\n * Join multiple CDN operations into one string without trailing or leading delimeters\n *\n * @param {...(String | unknown)} [operations]\n * @returns {String}\n */\nexport const joinCdnOperations = (...operations) => {\n  return operations\n    .filter((op) => typeof op === 'string' && op)\n    .map((op) => normalizeCdnOperation(/** @type {String} */ (op)))\n    .join('/-/');\n};\n\n/**\n * Create string with leading `-/` from passed CDN operations. Do the same as `joinCdnOperations` but adds leading `-/`\n * and trailing `/`\n *\n * @param {...(String | unknown)} [cdnOperations] -\n * @returns {String}\n */\nexport const createCdnUrlModifiers = (...cdnOperations) => {\n  let joined = joinCdnOperations(...cdnOperations);\n  return joined ? `-/${joined}/` : '';\n};\n\n/**\n * Extract filename or file URL\n *\n * @param {String} cdnUrl\n * @returns {String}\n */\nexport function extractFilename(cdnUrl) {\n  let url = new URL(cdnUrl);\n  let noOrigin = url.pathname + url.search + url.hash;\n  let urlFilenameIdx = noOrigin.lastIndexOf('http');\n  let plainFilenameIdx = noOrigin.lastIndexOf('/');\n  let filename = '';\n\n  if (urlFilenameIdx >= 0) {\n    filename = noOrigin.slice(urlFilenameIdx);\n  } else if (plainFilenameIdx >= 0) {\n    filename = noOrigin.slice(plainFilenameIdx + 1);\n  }\n\n  return filename;\n}\n\n/**\n * Extract UUID from CDN URL\n *\n * @param {string} cdnUrl\n * @returns {string}\n */\nexport function extractUuid(cdnUrl) {\n  let url = new URL(cdnUrl);\n  let { pathname } = url;\n  const slashIndex = pathname.indexOf('/');\n  const secondSlashIndex = pathname.indexOf('/', slashIndex + 1);\n  return pathname.substring(slashIndex + 1, secondSlashIndex);\n}\n\n/**\n * Extract UUID from CDN URL\n *\n * @param {string} cdnUrl\n * @returns {string[]}\n */\nexport function extractOperations(cdnUrl) {\n  let withoutFilename = trimFilename(cdnUrl);\n  let url = new URL(withoutFilename);\n  let operationsMarker = url.pathname.indexOf('/-/');\n  if (operationsMarker === -1) {\n    return [];\n  }\n  let operationsStr = url.pathname.substring(operationsMarker);\n\n  return operationsStr\n    .split('/-/')\n    .filter(Boolean)\n    .map((operation) => normalizeCdnOperation(operation));\n}\n\n/**\n * Trim filename or file URL\n *\n * @param {String} cdnUrl\n * @returns {String}\n */\nexport function trimFilename(cdnUrl) {\n  let url = new URL(cdnUrl);\n  let filename = extractFilename(cdnUrl);\n  let filenamePathPart = isFileUrl(filename) ? splitFileUrl(filename).pathname : filename;\n\n  url.pathname = url.pathname.replace(filenamePathPart, '');\n  url.search = '';\n  url.hash = '';\n  return url.toString();\n}\n\n/**\n * Detect if filename is actually file URL\n *\n * @param {String} filename\n * @returns {Boolean}\n */\nexport function isFileUrl(filename) {\n  return filename.startsWith('http');\n}\n\n/**\n * Split file URL into the path and search parts\n *\n * @param {String} fileUrl\n * @returns {{ pathname: String; search: String; hash: String }}\n */\nexport function splitFileUrl(fileUrl) {\n  let url = new URL(fileUrl);\n  return {\n    pathname: url.origin + url.pathname || '',\n    search: url.search || '',\n    hash: url.hash || '',\n  };\n}\n\n/**\n * Create a final CDN URL with CDN modifiers and filename\n *\n * @param {String} baseCdnUrl - Base URL to CDN or Proxy, CDN modifiers and filename accepted\n * @param {String} [cdnModifiers] - CDN modifiers to apply, will be appended to `baseCdnUrl` ones\n * @param {String} [filename] - Filename for CDN or file URL for Proxy, will override one from `baseCdnUrl`\n * @returns {String}\n */\nexport const createCdnUrl = (baseCdnUrl, cdnModifiers, filename) => {\n  let url = new URL(trimFilename(baseCdnUrl));\n  filename = filename || extractFilename(baseCdnUrl);\n  // TODO: fix double slash pathname bug (--cfg-cdn-cname: 'https://ucarecdn.com/' - trailing slash case)\n  if (url.pathname.startsWith('//')) {\n    url.pathname = url.pathname.replace('//', '/');\n  }\n  if (isFileUrl(filename)) {\n    let splitted = splitFileUrl(filename);\n    url.pathname = url.pathname + (cdnModifiers || '') + (splitted.pathname || '');\n    url.search = splitted.search;\n    url.hash = splitted.hash;\n  } else {\n    url.pathname = url.pathname + (cdnModifiers || '') + (filename || '');\n  }\n  return url.toString();\n};\n\n/**\n * Create URL for an original file on CDN\n *\n * @param {String} cdnUrl - URL to get base domain from, any pathname will be stripped\n * @param {String} uuid\n * @returns {String}\n */\nexport const createOriginalUrl = (cdnUrl, uuid) => {\n  let url = new URL(cdnUrl);\n  url.pathname = uuid + '/';\n  return url.toString();\n};\n", "const DEFAULT_CDN_BASE = 'https://ucarecdn.com';\n\nexport const PROPS_MAP = Object.freeze({\n  'dev-mode': {},\n  pubkey: {},\n  uuid: {},\n  src: {},\n  // alt: {},\n  // 'placeholder-src': {}, // available via CSS\n  lazy: {\n    default: 1,\n  },\n  intersection: {},\n  breakpoints: {\n    // '200, 300, 400'\n  },\n  'cdn-cname': {\n    default: DEFAULT_CDN_BASE,\n  },\n  'proxy-cname': {},\n  'secure-delivery-proxy': {},\n  'hi-res-support': {\n    default: 1,\n  },\n  'ultra-res-support': {}, // ?\n  format: {\n    default: 'auto',\n  },\n  'cdn-operations': {},\n  progressive: {},\n  quality: {\n    default: 'smart',\n  },\n  'is-background-for': {},\n});\n", "/**\n * @template T\n * @param {T[]} arr\n * @returns {T[]}\n */\nexport const uniqueArray = (arr) => {\n  return [...new Set(arr)];\n};\n", "import { BaseComponent } from '@symbiotejs/symbiote';\nimport { applyTemplateData } from '../../utils/template-utils.js';\nimport { createCdnUrl, createCdnUrlModifiers, createOriginalUrl } from '../../utils/cdn-utils.js';\nimport { PROPS_MAP } from './props-map.js';\nimport { stringToArray } from '../../utils/stringToArray.js';\nimport { uniqueArray } from '../../utils/uniqueArray.js';\n\nconst CSS_PREF = '--lr-img-';\nconst UNRESOLVED_ATTR = 'unresolved';\nconst HI_RES_K = 2;\nconst ULTRA_RES_K = 3;\nconst DEV_MODE =\n  !window.location.host.trim() || window.location.host.includes(':') || window.location.hostname.includes('localhost');\n\nconst CSS_PROPS = Object.create(null);\nfor (let prop in PROPS_MAP) {\n  CSS_PROPS[CSS_PREF + prop] = PROPS_MAP[prop]?.default || '';\n}\n\nexport class ImgBase extends BaseComponent {\n  cssInit$ = CSS_PROPS;\n\n  /**\n   * @param {String} key\n   * @returns {any}\n   */\n  $$(key) {\n    return this.$[CSS_PREF + key];\n  }\n\n  /** @param {Object<String, String | Number>} kvObj */\n  set$$(kvObj) {\n    for (let key in kvObj) {\n      this.$[CSS_PREF + key] = kvObj[key];\n    }\n  }\n\n  /**\n   * @param {String} key\n   * @param {(val: any) => void} kbFn\n   */\n  sub$$(key, kbFn) {\n    this.sub(CSS_PREF + key, (val) => {\n      // null comes from CSS context property\n      // empty string comes from attribute value\n      if (val === null || val === '') {\n        return;\n      }\n      kbFn(val);\n    });\n  }\n\n  /**\n   * @private\n   * @param {String} src\n   */\n  _fmtAbs(src) {\n    let isRel = !src.includes('//');\n    if (isRel && !DEV_MODE) {\n      src = new URL(src, document.baseURI).href;\n    }\n    return src;\n  }\n\n  /**\n   * Image operations\n   *\n   * @param {String} [size]\n   */\n  _getCdnModifiers(size = '') {\n    return createCdnUrlModifiers(\n      //\n      size && `resize/${size}`,\n      this.$$('cdn-operations') || '',\n      `format/${this.$$('format') || PROPS_MAP.format.default}`,\n      `quality/${this.$$('quality') || PROPS_MAP.quality.default}`\n    );\n  }\n\n  /**\n   * @private\n   * @param {String} size\n   * @returns {any}\n   */\n  _getUrlBase(size = '') {\n    if (this.$$('src').startsWith('data:') || this.$$('src').startsWith('blob:')) {\n      return this.$$('src');\n    }\n\n    // Localhost + relative image path (DO NOTHING):\n    if (DEV_MODE && this.$$('src') && !this.$$('src').includes('//')) {\n      return this._proxyUrl(this.$$('src'));\n    }\n\n    let cdnModifiers = this._getCdnModifiers(size);\n\n    if (this.$$('src').startsWith(this.$$('cdn-cname'))) {\n      return createCdnUrl(this.$$('src'), cdnModifiers);\n    }\n\n    // Alternative CDN name:\n    if (this.$$('cdn-cname') && this.$$('uuid')) {\n      return this._proxyUrl(\n        createCdnUrl(\n          //\n          createOriginalUrl(this.$$('cdn-cname'), this.$$('uuid')),\n          cdnModifiers\n        )\n      );\n    }\n\n    // UUID only:\n    if (this.$$('uuid')) {\n      return this._proxyUrl(\n        createCdnUrl(\n          //\n          createOriginalUrl(this.$$('cdn-cname'), this.$$('uuid')),\n          cdnModifiers\n        )\n      );\n    }\n\n    // Alternative proxy name:\n    if (this.$$('proxy-cname')) {\n      return this._proxyUrl(\n        createCdnUrl(\n          //\n          this.$$('proxy-cname'),\n          cdnModifiers,\n          this._fmtAbs(this.$$('src'))\n        )\n      );\n    }\n\n    // Project pubkey only:\n    if (this.$$('pubkey')) {\n      return this._proxyUrl(\n        createCdnUrl(\n          //\n          `https://${this.$$('pubkey')}.ucr.io/`,\n          cdnModifiers,\n          this._fmtAbs(this.$$('src'))\n        )\n      );\n    }\n  }\n\n  /**\n   * @private\n   * @param {String} url\n   * @returns {String}\n   */\n  _proxyUrl(url) {\n    let previewProxy = this.$$('secure-delivery-proxy');\n    if (!previewProxy) {\n      return url;\n    }\n    return applyTemplateData(\n      this.$$('secure-delivery-proxy'),\n      { previewUrl: url },\n      { transform: (value) => window.encodeURIComponent(value) }\n    );\n  }\n\n  /**\n   * @param {HTMLElement} el\n   * @param {Number} [k]\n   * @param {Boolean} [wOnly]\n   */\n  _getElSize(el, k = 1, wOnly = true) {\n    let rect = el.getBoundingClientRect();\n    let w = k * Math.round(rect.width);\n    let h = wOnly ? '' : k * Math.round(rect.height);\n    if (w || h) {\n      return `${w ? w : ''}x${h ? h : ''}`;\n    } else {\n      return null;\n    }\n  }\n\n  /** @param {HTMLImageElement} img */\n  _setupEventProxy(img) {\n    /** @param {Event} e */\n    let proxifyEvent = (e) => {\n      e.stopPropagation();\n      let event = new Event(e.type, e);\n      this.dispatchEvent(event);\n    };\n    let EVENTS = ['load', 'error'];\n    for (let event of EVENTS) {\n      img.addEventListener(event, proxifyEvent);\n    }\n  }\n\n  /** @type {HTMLImageElement} */\n  get img() {\n    if (!this._img) {\n      /** @private */\n      this._img = new Image();\n      this._setupEventProxy(this.img);\n      this._img.setAttribute(UNRESOLVED_ATTR, '');\n      this.img.onload = () => {\n        this.img.removeAttribute(UNRESOLVED_ATTR);\n      };\n      this.initAttributes();\n      this.appendChild(this._img);\n    }\n    return this._img;\n  }\n\n  get bgSelector() {\n    return this.$$('is-background-for');\n  }\n\n  initAttributes() {\n    [...this.attributes].forEach((attr) => {\n      if (!PROPS_MAP[attr.name]) {\n        this.img.setAttribute(attr.name, attr.value);\n      }\n    });\n  }\n\n  get breakpoints() {\n    if (this.$$('breakpoints')) {\n      return uniqueArray(stringToArray(this.$$('breakpoints')).map((str) => Number(str)));\n    } else {\n      return null;\n    }\n  }\n\n  /** @param {HTMLElement} el */\n  renderBg(el) {\n    let imgSet = new Set();\n    if (this.breakpoints) {\n      this.breakpoints.forEach((bp) => {\n        imgSet.add(`url(\"${this._getUrlBase(bp + 'x')}\") ${bp}w`);\n        if (this.$$('hi-res-support')) {\n          imgSet.add(`url(\"${this._getUrlBase(bp * HI_RES_K + 'x')}\") ${bp * HI_RES_K}w`);\n        }\n        if (this.$$('ultra-res-support')) {\n          imgSet.add(`url(\"${this._getUrlBase(bp * ULTRA_RES_K + 'x')}\") ${bp * ULTRA_RES_K}w`);\n        }\n      });\n    } else {\n      imgSet.add(`url(\"${this._getUrlBase(this._getElSize(el))}\") 1x`);\n      if (this.$$('hi-res-support')) {\n        imgSet.add(`url(\"${this._getUrlBase(this._getElSize(el, HI_RES_K))}\") ${HI_RES_K}x`);\n      }\n      if (this.$$('ultra-res-support')) {\n        imgSet.add(`url(\"${this._getUrlBase(this._getElSize(el, ULTRA_RES_K))}\") ${ULTRA_RES_K}x`);\n      }\n    }\n    let iSet = `image-set(${[...imgSet].join(', ')})`;\n    el.style.setProperty('background-image', iSet);\n    el.style.setProperty('background-image', '-webkit-' + iSet);\n  }\n\n  getSrcset() {\n    let srcset = new Set();\n    if (this.breakpoints) {\n      this.breakpoints.forEach((bp) => {\n        srcset.add(this._getUrlBase(bp + 'x') + ` ${bp}w`);\n        if (this.$$('hi-res-support')) {\n          srcset.add(this._getUrlBase(bp * HI_RES_K + 'x') + ` ${bp * HI_RES_K}w`);\n        }\n        if (this.$$('ultra-res-support')) {\n          srcset.add(this._getUrlBase(bp * ULTRA_RES_K + 'x') + ` ${bp * ULTRA_RES_K}w`);\n        }\n      });\n    } else {\n      srcset.add(this._getUrlBase(this._getElSize(this.img)) + ' 1x');\n      if (this.$$('hi-res-support')) {\n        srcset.add(this._getUrlBase(this._getElSize(this.img, 2)) + ' 2x');\n      }\n      if (this.$$('ultra-res-support')) {\n        srcset.add(this._getUrlBase(this._getElSize(this.img, 3)) + ' 3x');\n      }\n    }\n    return [...srcset].join();\n  }\n\n  getSrc() {\n    return this._getUrlBase();\n  }\n\n  init() {\n    if (this.bgSelector) {\n      [...document.querySelectorAll(this.bgSelector)].forEach((el) => {\n        if (this.$$('intersection')) {\n          this.initIntersection(el, () => {\n            this.renderBg(el);\n          });\n        } else {\n          this.renderBg(el);\n        }\n      });\n    } else if (this.$$('intersection')) {\n      this.initIntersection(this.img, () => {\n        this.img.srcset = this.getSrcset();\n        this.img.src = this.getSrc();\n      });\n    } else {\n      this.img.srcset = this.getSrcset();\n      this.img.src = this.getSrc();\n    }\n  }\n\n  /**\n   * @param {HTMLElement} el\n   * @param {() => void} cbkFn\n   */\n  initIntersection(el, cbkFn) {\n    let opts = {\n      root: null,\n      rootMargin: '0px',\n    };\n    /** @private */\n    this._isnObserver = new IntersectionObserver((entries) => {\n      entries.forEach((ent) => {\n        if (ent.isIntersecting) {\n          cbkFn();\n          this._isnObserver.unobserve(el);\n        }\n      });\n    }, opts);\n    this._isnObserver.observe(el);\n    if (!this._observed) {\n      /** @private */\n      this._observed = new Set();\n    }\n    this._observed.add(el);\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    if (this._isnObserver) {\n      this._observed.forEach((el) => {\n        this._isnObserver.unobserve(el);\n      });\n      this._isnObserver = null;\n    }\n  }\n\n  static get observedAttributes() {\n    return Object.keys(PROPS_MAP);\n  }\n\n  attributeChangedCallback(name, oldVal, newVal) {\n    window.setTimeout(() => {\n      this.$[CSS_PREF + name] = newVal;\n    });\n  }\n}\n", "import { ImgBase } from './ImgBase.js';\n\nexport class Img extends ImgBase {\n  initCallback() {\n    super.initCallback();\n\n    this.sub$$('src', () => {\n      this.init();\n    });\n\n    this.sub$$('uuid', () => {\n      this.init();\n    });\n\n    this.sub$$('lazy', (val) => {\n      if (!this.$$('is-background-for')) {\n        this.img.loading = val ? 'lazy' : 'eager';\n      }\n    });\n  }\n}\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\n\nexport class SimpleBtn extends UploaderBlock {\n  init$ = {\n    ...this.ctxInit,\n    '*simpleButtonText': '',\n    onClick: () => {\n      this.initFlow();\n    },\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.bindCssData('--cfg-multiple');\n    this.sub('--cfg-multiple', (val) => {\n      this.$['*simpleButtonText'] = val ? this.l10n('upload-files') : this.l10n('upload-file');\n    });\n  }\n}\n\nSimpleBtn.template = /* HTML */ `\n  <lr-drop-area>\n    <button type=\"button\" set=\"onclick: onClick\">\n      <lr-icon name=\"upload\"></lr-icon>\n      <span>{{*simpleButtonText}}</span>\n      <slot></slot>\n      <div class=\"visual-drop-area\"></div>\n    </button>\n  </lr-drop-area>\n`;\n", "import { ActivityBlock } from '../../abstract/ActivityBlock.js';\n\nexport class StartFrom extends ActivityBlock {\n  historyTracked = true;\n  activityType = 'start-from';\n\n  initCallback() {\n    super.initCallback();\n    this.registerActivity(this.activityType);\n  }\n}\n", "/**\n * @param {File} file\n * @returns {Promise<boolean>}\n */\nfunction checkIsDirectory(file) {\n  return new Promise((resolve) => {\n    if (typeof window.FileReader !== 'function') {\n      resolve(false);\n    }\n\n    try {\n      let reader = new FileReader();\n      reader.onerror = () => {\n        resolve(true);\n      };\n      let onLoad = (e) => {\n        if (e.type !== 'loadend') {\n          reader.abort();\n        }\n        resolve(false);\n      };\n      reader.onloadend = onLoad;\n      reader.onprogress = onLoad;\n\n      reader.readAsDataURL(file);\n    } catch (err) {\n      resolve(false);\n    }\n  });\n}\n\nfunction readEntryContentAsync(webkitEntry) {\n  return new Promise((resolve) => {\n    let reading = 0;\n    let contents = [];\n\n    let readEntry = (entry) => {\n      if (!entry) {\n        console.warn('Unexpectedly received empty content entry', { scope: 'drag-and-drop' });\n        resolve(null);\n      }\n      if (entry.isFile) {\n        reading++;\n        entry.file((file) => {\n          reading--;\n          contents.push(file);\n\n          if (reading === 0) {\n            resolve(contents);\n          }\n        });\n      } else if (entry.isDirectory) {\n        readReaderContent(entry.createReader());\n      }\n    };\n\n    let readReaderContent = (reader) => {\n      reading++;\n\n      reader.readEntries((entries) => {\n        reading--;\n        for (let entry of entries) {\n          readEntry(entry);\n        }\n\n        if (reading === 0) {\n          resolve(contents);\n        }\n      });\n    };\n\n    readEntry(webkitEntry);\n  });\n}\n\n/**\n * Note: dataTransfer will be destroyed outside of the call stack. So, do not try to process it asynchronous.\n *\n * @param {DataTransfer} dataTransfer\n * @returns {Promise<(File | String)[]>}\n */\nexport function getDropItems(dataTransfer) {\n  let files = [];\n  let promises = [];\n  for (let i = 0; i < dataTransfer.items.length; i++) {\n    let item = dataTransfer.items[i];\n    if (!item) {\n      continue;\n    }\n    if (item.kind === 'file') {\n      if (typeof item.webkitGetAsEntry === 'function' || typeof (/** @type {any} */ (item).getAsEntry) === 'function') {\n        let entry =\n          typeof item.webkitGetAsEntry === 'function'\n            ? item.webkitGetAsEntry()\n            : /** @type {any} */ (item).getAsEntry();\n        promises.push(\n          readEntryContentAsync(entry).then((entryContent) => {\n            files.push(...entryContent);\n          })\n        );\n        continue;\n      }\n\n      let file = item.getAsFile();\n      promises.push(\n        checkIsDirectory(file).then((isDirectory) => {\n          if (isDirectory) {\n            // we can't get directory files, so we'll skip it\n          } else {\n            files.push(file);\n          }\n        })\n      );\n    } else if (item.kind === 'string' && item.type.match('^text/uri-list')) {\n      promises.push(\n        new Promise((resolve) => {\n          item.getAsString((value) => {\n            files.push(value);\n            resolve();\n          });\n        })\n      );\n    }\n  }\n\n  return Promise.all(promises).then(() => files);\n}\n", "import { getDropItems } from './getDropItems.js';\n\n/** @enum {Number} */\nexport const DropzoneState = {\n  ACTIVE: 0,\n  INACTIVE: 1,\n  NEAR: 2,\n  OVER: 3,\n};\n\nlet RESET_EVENTS = ['focus'];\nlet NEAR_OFFSET = 100;\nlet nearnessRegistry = new Map();\n\n/**\n * @param {[x: number, y: number]} p\n * @param {{ x: number; y: number; width: number; height: number }} r\n * @returns {number}\n */\nfunction distance(p, r) {\n  let cx = Math.max(Math.min(p[0], r.x + r.width), r.x);\n  let cy = Math.max(Math.min(p[1], r.y + r.height), r.y);\n\n  return Math.sqrt((p[0] - cx) * (p[0] - cx) + (p[1] - cy) * (p[1] - cy));\n}\n\n/**\n * @param {Object} desc\n * @param {HTMLElement} desc.element\n * @param {Function} desc.onChange\n * @param {Function} desc.onItems\n * @param {() => Boolean} desc.shouldIgnore\n */\nexport function addDropzone(desc) {\n  let eventCounter = 0;\n\n  let body = document.body;\n  let switchHandlers = new Set();\n  let handleSwitch = (fn) => switchHandlers.add(fn);\n  let state = DropzoneState.INACTIVE;\n\n  let setState = (newState) => {\n    if (desc.shouldIgnore() && newState !== DropzoneState.INACTIVE) {\n      return;\n    }\n    if (state !== newState) {\n      switchHandlers.forEach((fn) => fn(newState));\n    }\n    state = newState;\n  };\n\n  handleSwitch((newState) => desc.onChange(newState));\n\n  let onResetEvent = () => {\n    eventCounter = 0;\n    setState(DropzoneState.INACTIVE);\n  };\n  let onDragEnter = () => {\n    eventCounter += 1;\n    if (state === DropzoneState.INACTIVE) {\n      setState(DropzoneState.ACTIVE);\n    }\n  };\n  let onDragLeave = () => {\n    eventCounter -= 1;\n    let draggingInPage = eventCounter > 0;\n    if (!draggingInPage) {\n      setState(DropzoneState.INACTIVE);\n    }\n  };\n  let onDrop = (e) => {\n    e.preventDefault();\n    eventCounter = 0;\n    setState(DropzoneState.INACTIVE);\n  };\n\n  let onDragOver = (e) => {\n    e.preventDefault();\n\n    /** @type {[Number, Number]} */\n    let dragPoint = [e.x, e.y];\n    let targetRect = desc.element.getBoundingClientRect();\n    let nearness = Math.floor(distance(dragPoint, targetRect));\n    let isNear = nearness < NEAR_OFFSET;\n    let isOver = e.composedPath().includes(desc.element);\n\n    nearnessRegistry.set(desc.element, nearness);\n    let isNearest = Math.min(...nearnessRegistry.values()) === nearness;\n\n    if (isOver && isNearest) {\n      setState(DropzoneState.OVER);\n    } else if (isNear && isNearest) {\n      setState(DropzoneState.NEAR);\n    } else {\n      setState(DropzoneState.ACTIVE);\n    }\n  };\n\n  let onElementDrop = async (e) => {\n    if (desc.shouldIgnore()) {\n      return;\n    }\n    e.preventDefault();\n    let items = await getDropItems(e.dataTransfer);\n    desc.onItems(items);\n    setState(DropzoneState.INACTIVE);\n  };\n\n  body.addEventListener('drop', onDrop);\n  body.addEventListener('dragleave', onDragLeave);\n  body.addEventListener('dragenter', onDragEnter);\n  body.addEventListener('dragover', onDragOver);\n  desc.element.addEventListener('drop', onElementDrop);\n  RESET_EVENTS.forEach((eventName) => {\n    window.addEventListener(eventName, onResetEvent);\n  });\n\n  return () => {\n    nearnessRegistry.delete(desc.element);\n    body.removeEventListener('drop', onDrop);\n    body.removeEventListener('dragleave', onDragLeave);\n    body.removeEventListener('dragenter', onDragEnter);\n    body.removeEventListener('dragover', onDragOver);\n    desc.element.removeEventListener('drop', onElementDrop);\n    RESET_EVENTS.forEach((eventName) => {\n      window.removeEventListener(eventName, onResetEvent);\n    });\n  };\n}\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { DropzoneState, addDropzone } from './addDropzone.js';\nimport { fileIsImage } from '../../utils/fileTypes.js';\nimport { Modal } from '../Modal/Modal.js';\nimport { stringToArray } from '../../utils/stringToArray.js';\n\nexport class DropArea extends UploaderBlock {\n  init$ = {\n    ...this.ctxInit,\n    state: DropzoneState.INACTIVE,\n    withIcon: false,\n    isClickable: false,\n    isFullscreen: false,\n    isDisabled: false,\n    isHidden: false,\n    text: this.l10n('drop-files-here'),\n    'lr-drop-area/targets': null,\n  };\n\n  cssInit$ = {\n    '--cfg-source-list': '',\n  };\n\n  isActive() {\n    if (!this.$.isDisabled) {\n      return false;\n    }\n    const bounds = this.getBoundingClientRect();\n    const hasSize = bounds.width > 0 && bounds.height > 0;\n    const isInViewport =\n      bounds.top >= 0 &&\n      bounds.left >= 0 &&\n      bounds.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n      bounds.right <= (window.innerWidth || document.documentElement.clientWidth);\n\n    const style = window.getComputedStyle(this);\n    const visible = style.visibility !== 'hidden' && style.display !== 'none';\n\n    return hasSize && visible && isInViewport;\n  }\n  initCallback() {\n    super.initCallback();\n\n    if (!this.$['lr-drop-area/targets']) {\n      this.$['lr-drop-area/targets'] = new Set();\n    }\n    this.$['lr-drop-area/targets'].add(this);\n\n    this.defineAccessor('disabled', (value) => {\n      this.set$({ isDisabled: typeof value === 'string' });\n    });\n    this.defineAccessor('clickable', (value) => {\n      this.set$({ isClickable: typeof value === 'string' });\n    });\n    this.defineAccessor('with-icon', (value) => {\n      this.set$({ withIcon: typeof value === 'string' });\n    });\n    this.defineAccessor('fullscreen', (value) => {\n      this.set$({ isFullscreen: typeof value === 'string' });\n    });\n\n    this.defineAccessor('text', (value) => {\n      if (value) {\n        this.set$({ text: this.l10n(value) || value });\n      } else {\n        this.set$({ text: this.l10n('drop-files-here') });\n      }\n    });\n\n    /** @private */\n    this._destroyDropzone = addDropzone({\n      element: this,\n      shouldIgnore: () => this._shouldIgnore(),\n      onChange: (state) => {\n        this.$.state = state;\n      },\n      /** @param {(File | String)[]} items */\n      onItems: (items) => {\n        debugger;\n        if (!items.length) {\n          return;\n        }\n        let isMultiple = this.getCssData('--cfg-multiple');\n        let multipleMax = this.getCssData('--cfg-multiple-max');\n        let currentFilesCount = this.uploadCollection.size;\n        if (isMultiple && multipleMax) {\n          items = items.slice(0, multipleMax - currentFilesCount - 1);\n        } else if (!isMultiple) {\n          items = items.slice(0, currentFilesCount > 0 ? 0 : 1);\n        }\n        items.forEach((/** @type {File | String} */ item) => {\n          if (typeof item === 'string') {\n            this.uploadCollection.add({\n              externalUrl: item,\n            });\n            return;\n          }\n          let isImage = fileIsImage(item);\n          this.uploadCollection.add({\n            file: item,\n            isImage: isImage,\n            mimeType: item.type,\n            fileName: item.name,\n            fileSize: item.size,\n          });\n        });\n        if (this.uploadCollection.size) {\n          this.set$({\n            '*currentActivity': ActivityBlock.activities.UPLOAD_LIST,\n          });\n          this.setForCtxTarget(Modal.StateConsumerScope, '*modalActive', true);\n        }\n      },\n    });\n\n    let contentWrapperEl = this.ref['content-wrapper'];\n    if (contentWrapperEl) {\n      this._destroyContentWrapperDropzone = addDropzone({\n        element: contentWrapperEl,\n        onChange: (state) => {\n          const stateText = Object.entries(DropzoneState)\n            .find(([, value]) => value === state)?.[0]\n            .toLowerCase();\n          stateText && contentWrapperEl.setAttribute('drag-state', stateText);\n        },\n        onItems: () => {},\n        shouldIgnore: () => this._shouldIgnore(),\n      });\n    }\n\n    this.sub('state', (state) => {\n      const stateText = Object.entries(DropzoneState)\n        .find(([, value]) => value === state)?.[0]\n        .toLowerCase();\n      if (stateText) {\n        this.setAttribute('drag-state', stateText);\n      }\n    });\n\n    this.sub('--cfg-source-list', (value) => {\n      const list = stringToArray(value);\n      // Disable drop area if local files are not allowed\n      this.$.isDisabled = !list.includes(UploaderBlock.sourceTypes.LOCAL);\n      // Hide drop area if there is no default slot overrided\n      this.$.isHidden = this.$.isDisabled && !!this.querySelector('[data-default-slot]');\n    });\n\n    this.sub('isHidden', (value) => {\n      this.toggleAttribute('hidden', value);\n    });\n\n    if (this.$.isClickable) {\n      // @private\n      this._onAreaClicked = () => {\n        this.openSystemDialog();\n      };\n      this.addEventListener('click', this._onAreaClicked);\n    }\n  }\n\n  /**\n   * Ignore drop events if there are other visible drop areas on the page\n   *\n   * @private\n   * @returns {Boolean}\n   */\n  _shouldIgnore() {\n    if (this.$.isDisabled) {\n      return true;\n    }\n    if (!this._couldHandleFiles()) {\n      return true;\n    }\n    if (!this.$.isFullscreen) {\n      return false;\n    }\n    const otherTargets = [...this.$['lr-drop-area/targets']].filter((el) => el !== this);\n    const activeTargets = otherTargets.filter((/** @type {typeof this} */ el) => {\n      return el.isActive();\n    });\n    return activeTargets.length > 0;\n  }\n\n  /** @private */\n  _couldHandleFiles() {\n    let isMultiple = this.getCssData('--cfg-multiple');\n    let multipleMax = this.getCssData('--cfg-multiple-max');\n    let currentFilesCount = this.uploadCollection.size;\n\n    if (isMultiple && multipleMax && currentFilesCount >= multipleMax) {\n      return false;\n    }\n\n    if (!isMultiple && currentFilesCount > 0) {\n      return false;\n    }\n\n    return true;\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n\n    this.$['lr-drop-area/targets']?.remove?.(this);\n\n    this._destroyDropzone?.();\n    this._destroyContentWrapperDropzone?.();\n    if (this._onAreaClicked) {\n      this.removeEventListener('click', this._onAreaClicked);\n    }\n  }\n}\n\nDropArea.template = /* HTML */ `\n  <slot>\n    <div data-default-slot hidden></div>\n    <div ref=\"content-wrapper\" class=\"content-wrapper\" set=\"@hidden: isHidden\">\n      <div class=\"icon-container\" set=\"@hidden: !withIcon\">\n        <lr-icon name=\"default\"></lr-icon>\n        <lr-icon name=\"arrow-down\"></lr-icon>\n      </div>\n      <span class=\"text\">{{text}}</span>\n    </div>\n  </slot>\n`;\n\nDropArea.bindAttributes({\n  'with-icon': null,\n  clickable: null,\n  text: null,\n  fullscreen: null,\n  disabled: null,\n});\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\n\nconst L10N_PREFIX = 'src-type-';\n\nexport class SourceBtn extends UploaderBlock {\n  /** @private */\n  _registeredTypes = {};\n\n  init$ = {\n    ...this.ctxInit,\n    iconName: 'default',\n  };\n\n  initTypes() {\n    this.registerType({\n      type: UploaderBlock.sourceTypes.LOCAL,\n      onClick: () => {\n        this.openSystemDialog();\n      },\n    });\n    this.registerType({\n      type: UploaderBlock.sourceTypes.URL,\n      activity: ActivityBlock.activities.URL,\n      textKey: 'from-url',\n    });\n    this.registerType({\n      type: UploaderBlock.sourceTypes.CAMERA,\n      activity: ActivityBlock.activities.CAMERA,\n      onClick: () => {\n        let el = document.createElement('input');\n        var supportsCapture = el.capture !== undefined;\n        if (supportsCapture) {\n          this.openSystemDialog({ captureCamera: true });\n        }\n        return !supportsCapture;\n      },\n    });\n    this.registerType({\n      type: 'draw',\n      activity: ActivityBlock.activities.DRAW,\n      icon: 'edit-draw',\n    });\n\n    for (let externalSourceType of Object.values(UploaderBlock.extSrcList)) {\n      this.registerType({\n        type: externalSourceType,\n        activity: ActivityBlock.activities.EXTERNAL,\n        activityParams: {\n          externalSourceType: externalSourceType,\n        },\n      });\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n    this.initTypes();\n\n    this.setAttribute('role', 'button');\n    this.defineAccessor('type', (val) => {\n      if (!val) {\n        return;\n      }\n      this.applyType(val);\n    });\n  }\n\n  registerType(typeConfig) {\n    this._registeredTypes[typeConfig.type] = typeConfig;\n  }\n\n  getType(type) {\n    return this._registeredTypes[type];\n  }\n\n  applyType(type) {\n    const configType = this._registeredTypes[type];\n    if (!configType) {\n      console.warn('Unsupported source type: ' + type);\n      return;\n    }\n    const { textKey = type, icon = type, activity, onClick, activityParams = {} } = configType;\n\n    this.applyL10nKey('src-type', `${L10N_PREFIX}${textKey}`);\n    this.$.iconName = icon;\n    this.onclick = (e) => {\n      const showActivity = onClick ? onClick(e) : !!activity;\n      showActivity &&\n        this.set$({\n          '*currentActivityParams': activityParams,\n          '*currentActivity': activity,\n        });\n    };\n  }\n}\nSourceBtn.template = /* HTML */ `\n  <lr-icon set=\"@name: iconName\"></lr-icon>\n  <div class=\"txt\" l10n=\"src-type\"></div>\n`;\nSourceBtn.bindAttributes({\n  type: null,\n});\n", "import { Block } from '../../abstract/Block.js';\nimport { stringToArray } from '../../utils/stringToArray.js';\n\nexport class SourceList extends Block {\n  cssInit$ = {\n    '--cfg-source-list': '',\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.sub('--cfg-source-list', (/** @type {String} */ val) => {\n      let list = stringToArray(val);\n      let html = '';\n      list.forEach((srcName) => {\n        html += /* HTML */ `<lr-source-btn type=\"${srcName}\"></lr-source-btn>`;\n      });\n      if (this.getCssData('--cfg-source-list-wrap')) {\n        this.innerHTML = html;\n      } else {\n        this.outerHTML = html;\n      }\n    });\n  }\n}\n", "/**\n * @param {File} imgFile\n * @param {Number} [size]\n */\nexport function generateThumb(imgFile, size = 40) {\n  if (imgFile.type === 'image/svg+xml') {\n    return URL.createObjectURL(imgFile);\n  }\n  let canvas = document.createElement('canvas');\n  let ctx = canvas.getContext('2d');\n  let img = new Image();\n  let promise = new Promise((resolve, reject) => {\n    img.onload = () => {\n      let ratio = img.height / img.width;\n      if (ratio > 1) {\n        canvas.width = size;\n        canvas.height = size * ratio;\n      } else {\n        canvas.height = size;\n        canvas.width = size / ratio;\n      }\n      ctx.fillStyle = 'rgb(240, 240, 240)';\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n      canvas.toBlob((blob) => {\n        if (!blob) {\n          reject();\n          return;\n        }\n        let url = URL.createObjectURL(blob);\n        resolve(url);\n      });\n    };\n    img.onerror = (err) => {\n      reject(err);\n    };\n  });\n  img.src = URL.createObjectURL(imgFile);\n  return promise;\n}\n", "import { Block } from '../../abstract/Block.js';\n\nexport class UiMessage {\n  caption = '';\n  text = '';\n  iconName = '';\n  isError = false;\n}\n\nexport class MessageBox extends Block {\n  init$ = {\n    ...this.ctxInit,\n    iconName: 'info',\n    captionTxt: 'Message caption',\n    msgTxt: 'Message...',\n    '*message': null,\n    onClose: () => {\n      this.$['*message'] = null;\n    },\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.sub('*message', (/** @type {UiMessage} */ msg) => {\n      if (msg) {\n        this.setAttribute('active', '');\n        this.set$({\n          captionTxt: msg.caption || '',\n          msgTxt: msg.text || '',\n          iconName: msg.isError ? 'error' : 'info',\n        });\n        if (msg.isError) {\n          this.setAttribute('error', '');\n        } else {\n          this.removeAttribute('error');\n        }\n      } else {\n        this.removeAttribute('active');\n      }\n    });\n  }\n}\n\nMessageBox.template = /* HTML */ `\n  <div class=\"heading\">\n    <lr-icon set=\"@name: iconName\"></lr-icon>\n    <div class=\"caption\">{{captionTxt}}</div>\n    <button type=\"button\" set=\"onclick: onClose\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </div>\n  <div class=\"msg\">{{msgTxt}}</div>\n`;\n", "/**\n * @param {String} svg\n * @returns {String}\n */\nfunction createSvgBlobUrl(svg) {\n  let blob = new Blob([svg], {\n    type: 'image/svg+xml',\n  });\n  return URL.createObjectURL(blob);\n}\n\n/**\n * @param {String} [color1]\n * @param {String} [color2]\n * @returns {String}\n */\nexport function checkerboardCssBg(color1 = '#fff', color2 = 'rgba(0, 0, 0, .1)') {\n  return createSvgBlobUrl(/*svg*/ `<svg height=\"20\" width=\"20\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\">\n    <rect x=\"0\" y=\"0\" width=\"20\" height=\"20\" fill=\"${color1}\" />\n    <rect x=\"0\" y=\"0\" width=\"10\" height=\"10\" fill=\"${color2}\" />\n    <rect x=\"10\" y=\"10\" width=\"10\" height=\"10\" fill=\"${color2}\" />\n  </svg>`);\n}\n\n/**\n * @param {String} [color]\n * @returns {String}\n */\nexport function strokesCssBg(color = 'rgba(0, 0, 0, .1)') {\n  return createSvgBlobUrl(/*svg*/ `<svg height=\"10\" width=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n    <line x1=\"0\" y1=\"10\" x2=\"10\" y2=\"0\" stroke=\"${color}\" />\n  </svg>`);\n}\n\n/**\n * @param {String} [color]\n * @returns {String}\n */\nexport function fileCssBg(color = 'hsl(209, 21%, 65%)', width = 32, height = 32) {\n  return createSvgBlobUrl(/*svg*/ `\n  <svg width=\"${width}\" height=\"${height}\" viewBox=\"0 0 30 30\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path fill-rule=\"evenodd\" fill=\"${color}\" d=\"M9.68848 8.70068C9.68848 8.42454 9.91233 8.20068 10.1885 8.20068H15.0885C15.2211 8.20068 15.3483 8.25336 15.442 8.34713L20.342 13.2471C20.4358 13.3409 20.4885 13.4681 20.4885 13.6007V21.3007C20.4885 21.5768 20.2646 21.8007 19.9885 21.8007H10.1885C9.91233 21.8007 9.68848 21.5768 9.68848 21.3007V8.70068ZM10.6885 9.20068V20.8007H19.4885V14.1007L15.0885 14.1007C14.8123 14.1007 14.5885 13.8768 14.5885 13.6007L14.5885 9.20068H10.6885ZM15.5885 9.90779L18.7814 13.1007L15.5885 13.1007L15.5885 9.90779Z\"/>\n  </svg>\n  `);\n}\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { generateThumb } from '../utils/resizeImage.js';\nimport { uploadFile } from '@uploadcare/upload-client';\nimport { UiMessage } from '../MessageBox/MessageBox.js';\nimport { fileCssBg } from '../svg-backgrounds/svg-backgrounds.js';\nimport { createCdnUrl, createCdnUrlModifiers, createOriginalUrl } from '../../utils/cdn-utils.js';\nimport { EVENT_TYPES, EventData, EventManager } from '../../abstract/EventManager.js';\nimport { debounce } from '../utils/debounce.js';\nimport { IMAGE_ACCEPT_LIST, mergeFileTypes, matchFileType } from '../../utils/fileTypes.js';\n\nconst FileItemState = Object.freeze({\n  FINISHED: Symbol(0),\n  FAILED: Symbol(1),\n  UPLOADING: Symbol(2),\n  IDLE: Symbol(3),\n});\n\nexport class FileItem extends UploaderBlock {\n  pauseRender = true;\n\n  /** @private */\n  _entrySubs = new Set();\n  /** @private */\n  _entry = null;\n  /** @private */\n  _isIntersecting = false;\n  /** @private */\n  _debouncedGenerateThumb = debounce(this._generateThumbnail.bind(this), 100);\n  /** @private */\n  _debouncedCalculateState = debounce(this._calculateState.bind(this), 100); // TODO: better throttle\n  /** @private */\n  _renderedOnce = false;\n\n  cssInit$ = {\n    '--cfg-use-cloud-image-editor': 0,\n  };\n\n  init$ = {\n    ...this.ctxInit,\n    uid: '',\n    itemName: '',\n    errorText: '',\n    thumbUrl: '',\n    progressValue: 0,\n    progressVisible: false,\n    progressUnknown: false,\n    badgeIcon: '',\n    isFinished: false,\n    isFailed: false,\n    isUploading: false,\n    isFocused: false,\n    isEditable: false,\n    state: FileItemState.IDLE,\n    '*uploadTrigger': null,\n\n    onEdit: () => {\n      this.set$({\n        '*focusedEntry': this._entry,\n      });\n      if (this.findBlockInCtx((b) => b.activityType === ActivityBlock.activities.DETAILS)) {\n        this.$['*currentActivity'] = ActivityBlock.activities.DETAILS;\n      } else {\n        this.$['*currentActivity'] = ActivityBlock.activities.CLOUD_IMG_EDIT;\n      }\n    },\n    onRemove: () => {\n      let entryUuid = this._entry.getValue('uuid');\n      if (entryUuid) {\n        let data = this.getOutputData((dataItem) => {\n          return dataItem.getValue('uuid') === entryUuid;\n        });\n        EventManager.emit(\n          new EventData({\n            type: EVENT_TYPES.REMOVE,\n            ctx: this.ctxName,\n            data,\n          })\n        );\n      }\n      this.uploadCollection.remove(this.$.uid);\n    },\n    onUpload: () => {\n      this.upload();\n    },\n  };\n\n  _reset() {\n    for (let sub of this._entrySubs) {\n      sub.remove();\n    }\n\n    this._debouncedGenerateThumb.cancel();\n    this._entrySubs = new Set();\n    this._entry = null;\n    this._isIntersecting = false;\n  }\n\n  /** @private */\n  _observerCallback(entries) {\n    let [entry] = entries;\n    this._isIntersecting = entry.isIntersecting;\n\n    if (entry.isIntersecting && !this._renderedOnce) {\n      this.render();\n      this._renderedOnce = true;\n    }\n    if (entry.intersectionRatio === 0) {\n      this._debouncedGenerateThumb.cancel();\n    } else {\n      this._debouncedGenerateThumb();\n    }\n  }\n\n  /** @private */\n  _calculateState() {\n    if (!this._entry) {\n      return;\n    }\n    let entry = this._entry;\n    let state = FileItemState.IDLE;\n\n    if (entry.getValue('uploadError') || entry.getValue('validationErrorMsg')) {\n      state = FileItemState.FAILED;\n    } else if (entry.getValue('isUploading')) {\n      state = FileItemState.UPLOADING;\n    } else if (entry.getValue('uuid')) {\n      state = FileItemState.FINISHED;\n    }\n\n    if (this.$.state !== state) {\n      this.$.state = state;\n    }\n  }\n\n  /** @private */\n  async _generateThumbnail() {\n    if (!this._entry) {\n      return;\n    }\n    let entry = this._entry;\n\n    if (entry.getValue('uuid') && entry.getValue('isImage')) {\n      let size = this.getCssData('--cfg-thumb-size') || 76;\n      let thumbUrl = this.proxyUrl(\n        createCdnUrl(\n          createOriginalUrl(this.getCssData('--cfg-cdn-cname'), this._entry.getValue('uuid')),\n          createCdnUrlModifiers(entry.getValue('cdnUrlModifiers'), `scale_crop/${size}x${size}/center`)\n        )\n      );\n      let currentThumbUrl = entry.getValue('thumbUrl');\n      if (currentThumbUrl !== thumbUrl) {\n        entry.setValue('thumbUrl', thumbUrl);\n        currentThumbUrl.startsWith('blob:') && URL.revokeObjectURL(currentThumbUrl);\n      }\n      return;\n    }\n\n    if (entry.getValue('thumbUrl')) {\n      return;\n    }\n\n    if (entry.getValue('file')?.type.includes('image')) {\n      try {\n        let thumbUrl = await generateThumb(entry.getValue('file'), this.getCssData('--cfg-thumb-size') || 76);\n        entry.setValue('thumbUrl', thumbUrl);\n      } catch (err) {\n        let color = window.getComputedStyle(this).getPropertyValue('--clr-generic-file-icon');\n        entry.setValue('thumbUrl', fileCssBg(color));\n      }\n    } else {\n      let color = window.getComputedStyle(this).getPropertyValue('--clr-generic-file-icon');\n      entry.setValue('thumbUrl', fileCssBg(color));\n    }\n  }\n\n  /**\n   * @private\n   * @param {'success' | 'error'} type\n   * @param {String} caption\n   * @param {String} text\n   */\n  _showMessage(type, caption, text) {\n    let msg = new UiMessage();\n    msg.caption = caption;\n    msg.text = text;\n    msg.isError = type === 'error';\n    this.set$({\n      badgeIcon: `badge-${type}`,\n      '*message': msg,\n    });\n  }\n\n  /**\n   * @private\n   * @param {string} prop\n   * @param {(value: any) => void} handler\n   */\n  _subEntry(prop, handler) {\n    let sub = this._entry.subscribe(prop, (value) => {\n      if (this.isConnected) {\n        handler(value);\n      }\n    });\n    this._entrySubs.add(sub);\n  }\n\n  /**\n   * @private\n   * @param {String} id\n   */\n  _handleEntryId(id) {\n    this._reset();\n\n    /** @type {import('../../abstract/TypedData.js').TypedData} */\n    let entry = this.uploadCollection?.read(id);\n    this._entry = entry;\n\n    if (!entry) {\n      return;\n    }\n\n    this._subEntry('validationErrorMsg', (validationErrorMsg) => {\n      this._debouncedCalculateState();\n      this.$.errorText = validationErrorMsg;\n    });\n\n    this._subEntry('uploadError', (uploadError) => {\n      this._debouncedCalculateState();\n      this.$.errorText = uploadError?.message;\n    });\n\n    this._subEntry('isUploading', () => {\n      this._debouncedCalculateState();\n    });\n\n    this._subEntry('uploadProgress', (uploadProgress) => {\n      this.$.progressValue = uploadProgress;\n    });\n\n    this._subEntry('fileName', (name) => {\n      this.$.itemName = name || entry.getValue('externalUrl') || this.l10n('file-no-name');\n    });\n\n    this._subEntry('fileSize', (fileSize) => {\n      let maxFileSize = this.getCssData('--cfg-max-local-file-size-bytes');\n      if (maxFileSize && fileSize && fileSize > maxFileSize) {\n        entry.setValue('validationErrorMsg', this.l10n('files-max-size-limit-error', { maxFileSize }));\n      }\n    });\n\n    this._subEntry('mimeType', (mimeType) => {\n      if (!mimeType) {\n        return;\n      }\n      let imagesOnly = this.getCssData('--cfg-img-only');\n      let accept = this.getCssData('--cfg-accept');\n      let allowedFileTypes = mergeFileTypes([...(imagesOnly ? IMAGE_ACCEPT_LIST : []), accept]);\n      if (allowedFileTypes.length > 0 && !matchFileType(mimeType, allowedFileTypes)) {\n        entry.setValue('validationErrorMsg', this.l10n('file-type-not-allowed'));\n      }\n    });\n\n    this._subEntry('isImage', (isImage) => {\n      let imagesOnly = this.getCssData('--cfg-img-only');\n      if (entry.getValue('externalUrl') && !entry.getValue('uuid') && imagesOnly && !isImage) {\n        // don't validate not uploaded files with external url, cause we don't know if they're images or not\n        return;\n      }\n      if (imagesOnly && !isImage) {\n        entry.setValue('validationErrorMsg', this.l10n('images-only-accepted'));\n      }\n    });\n\n    this._subEntry('externalUrl', (externalUrl) => {\n      this.$.itemName = entry.getValue('fileName') || externalUrl || this.l10n('file-no-name');\n    });\n\n    this._subEntry('uuid', (uuid) => {\n      this._debouncedCalculateState();\n      if (uuid && this._isIntersecting) {\n        this._debouncedGenerateThumb();\n      }\n    });\n\n    this._subEntry('cdnUrlModifiers', () => {\n      if (this._isIntersecting) {\n        this._debouncedGenerateThumb();\n      }\n    });\n\n    this._subEntry('thumbUrl', (thumbUrl) => {\n      this.$.thumbUrl = thumbUrl ? `url(${thumbUrl})` : '';\n    });\n\n    if (!this.getCssData('--cfg-confirm-upload')) {\n      this.upload();\n    }\n\n    if (this._isIntersecting) {\n      this._debouncedGenerateThumb();\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.sub('uid', (uid) => {\n      this._handleEntryId(uid);\n    });\n\n    this.sub('state', (state) => {\n      this._handleState(state);\n    });\n\n    this.sub('--cfg-use-cloud-image-editor', () => {\n      this._handleState(this.$.state);\n    });\n\n    this.onclick = () => {\n      FileItem.activeInstances.forEach((inst) => {\n        if (inst === this) {\n          inst.setAttribute('focused', '');\n        } else {\n          inst.removeAttribute('focused');\n        }\n      });\n    };\n\n    this.$['*uploadTrigger'] = null;\n\n    this.sub('*uploadTrigger', (val) => {\n      if (!val || !this.isConnected) {\n        return;\n      }\n      this.upload();\n    });\n    FileItem.activeInstances.add(this);\n  }\n\n  /** @param {(typeof FileItemState)[keyof typeof FileItemState]} state */\n  _handleState(state) {\n    this.set$({\n      isFailed: state === FileItemState.FAILED,\n      isUploading: state === FileItemState.UPLOADING,\n      isFinished: state === FileItemState.FINISHED,\n      progressVisible: state === FileItemState.UPLOADING,\n      isEditable:\n        this.$['--cfg-use-cloud-image-editor'] && state === FileItemState.FINISHED && this._entry?.getValue('isImage'),\n    });\n\n    if (state === FileItemState.FAILED) {\n      this.$.badgeIcon = 'badge-error';\n    } else if (state === FileItemState.FINISHED) {\n      this.$.badgeIcon = 'badge-success';\n    }\n\n    if (state === FileItemState.UPLOADING) {\n      this.$.isFocused = false;\n    } else {\n      this.$.progressValue = 0;\n    }\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n\n    FileItem.activeInstances.delete(this);\n\n    this._reset();\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    /** @private */\n    this._observer = new window.IntersectionObserver(this._observerCallback.bind(this), {\n      root: this.parentElement,\n      rootMargin: '50% 0px 50% 0px',\n      threshold: [0, 1],\n    });\n    this._observer.observe(this);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n\n    this._debouncedGenerateThumb.cancel();\n    this._observer?.disconnect();\n  }\n\n  async upload() {\n    let entry = this._entry;\n    if (entry.getValue('uuid') || entry.getValue('isUploading') || entry.getValue('validationErrorMsg')) {\n      return;\n    }\n    let data = this.getOutputData((dataItem) => {\n      return !dataItem.getValue('uuid');\n    });\n    EventManager.emit(\n      new EventData({\n        type: EVENT_TYPES.UPLOAD_START,\n        ctx: this.ctxName,\n        data,\n      })\n    );\n\n    this._debouncedCalculateState();\n    entry.setValue('isUploading', true);\n    entry.setValue('uploadError', null);\n    entry.setValue('validationErrorMsg', null);\n\n    if (!entry.getValue('file') && entry.getValue('externalUrl')) {\n      this.$.progressUnknown = true;\n    }\n    try {\n      let abortController = new AbortController();\n      entry.setValue('abortController', abortController);\n\n      let fileInfo = await uploadFile(entry.getValue('file') || entry.getValue('externalUrl'), {\n        ...this.getUploadClientOptions(),\n        fileName: entry.getValue('fileName'),\n        onProgress: (progress) => {\n          if (progress.isComputable) {\n            let percentage = progress.value * 100;\n            entry.setValue('uploadProgress', percentage);\n          }\n          this.$.progressUnknown = !progress.isComputable;\n        },\n        signal: abortController.signal,\n      });\n      entry.setMultipleValues({\n        fileInfo,\n        isUploading: false,\n        fileName: fileInfo.name,\n        fileSize: fileInfo.size,\n        isImage: fileInfo.isImage,\n        mimeType: fileInfo.mimeType,\n        uuid: fileInfo.uuid,\n        cdnUrl: fileInfo.cdnUrl,\n      });\n\n      if (entry === this._entry) {\n        this._debouncedCalculateState();\n      }\n    } catch (error) {\n      entry.setMultipleValues({\n        abortController: null,\n        isUploading: false,\n        uploadProgress: 0,\n      });\n\n      if (entry === this._entry) {\n        this._debouncedCalculateState();\n      }\n\n      if (!error?.isCancel) {\n        entry.setValue('uploadError', error);\n      }\n    }\n  }\n}\n\nFileItem.template = /* HTML */ `\n  <div class=\"inner\" set=\"@finished: isFinished; @uploading: isUploading; @failed: isFailed; @focused: isFocused\">\n    <div class=\"thumb\" set=\"style.backgroundImage: thumbUrl\">\n      <div class=\"badge\">\n        <lr-icon set=\"@name: badgeIcon\"></lr-icon>\n      </div>\n    </div>\n    <div class=\"file-name-wrapper\">\n      <span class=\"file-name\" set=\"@title: itemName\">{{itemName}}</span>\n      <span class=\"file-error\" set=\"@hidden: !errorText\">{{errorText}}</span>\n    </div>\n    <div class=\"file-actions\">\n      <button type=\"button\" class=\"edit-btn mini-btn\" set=\"onclick: onEdit; @hidden: !isEditable\">\n        <lr-icon name=\"edit-file\"></lr-icon>\n      </button>\n      <button type=\"button\" class=\"remove-btn mini-btn\" set=\"onclick: onRemove;\">\n        <lr-icon name=\"remove-file\"></lr-icon>\n      </button>\n      <button type=\"button\" class=\"upload-btn mini-btn\" set=\"onclick: onUpload;\">\n        <lr-icon name=\"upload\"></lr-icon>\n      </button>\n    </div>\n    <lr-progress-bar\n      class=\"progress-bar\"\n      set=\"value: progressValue; visible: progressVisible; unknown: progressUnknown\"\n    >\n    </lr-progress-bar>\n  </div>\n`;\nFileItem.activeInstances = new Set();\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { UiMessage } from '../MessageBox/MessageBox.js';\nimport { EVENT_TYPES, EventData, EventManager } from '../../abstract/EventManager.js';\nimport { debounce } from '../utils/debounce.js';\n\nexport class UploadList extends UploaderBlock {\n  historyTracked = true;\n  activityType = ActivityBlock.activities.UPLOAD_LIST;\n\n  init$ = {\n    ...this.ctxInit,\n    doneBtnVisible: false,\n    doneBtnEnabled: false,\n    uploadBtnVisible: false,\n    addMoreBtnVisible: false,\n    addMoreBtnEnabled: false,\n    headerText: '',\n\n    hasFiles: false,\n    onAdd: () => {\n      this.initFlow(true);\n    },\n    onUpload: () => {\n      this.$['*uploadTrigger'] = {};\n      this._updateUploadsState();\n    },\n    onDone: () => {\n      this.doneFlow();\n    },\n    onCancel: () => {\n      let data = this.getOutputData((dataItem) => {\n        return !!dataItem.getValue('uuid');\n      });\n      EventManager.emit(\n        new EventData({\n          type: EVENT_TYPES.REMOVE,\n          ctx: this.ctxName,\n          data,\n        })\n      );\n      this.uploadCollection.clearAll();\n    },\n  };\n\n  cssInit$ = {\n    '--cfg-multiple': 1,\n    '--cfg-multiple-min': 0,\n    '--cfg-multiple-max': 0,\n  };\n\n  _debouncedHandleCollectionUpdate = debounce(() => {\n    if (!this.isConnected) {\n      return;\n    }\n    this._updateUploadsState();\n    this._updateCountLimitMessage();\n  }, 0);\n\n  /**\n   * @private\n   * @returns {{ passed: Boolean; tooFew: Boolean; tooMany: Boolean; exact: Boolean; min: Number; max: Number }}\n   */\n  _validateFilesCount() {\n    let multiple = !!this.getCssData('--cfg-multiple');\n    let min = multiple ? this.getCssData('--cfg-multiple-min') ?? 0 : 1;\n    let max = multiple ? this.getCssData('--cfg-multiple-max') ?? 0 : 1;\n    let count = this.uploadCollection.size;\n\n    let tooFew = min ? count < min : false;\n    let tooMany = max ? count > max : false;\n    let passed = !tooFew && !tooMany;\n    let exact = max === count;\n\n    return {\n      passed,\n      tooFew,\n      tooMany,\n      min,\n      max,\n      exact,\n    };\n  }\n\n  /** @private */\n  _updateCountLimitMessage() {\n    let filesCount = this.uploadCollection.size;\n    let countValidationResult = this._validateFilesCount();\n    if (filesCount && !countValidationResult.passed) {\n      let msg = new UiMessage();\n      let textKey = countValidationResult.tooFew\n        ? 'files-count-limit-error-too-few'\n        : 'files-count-limit-error-too-many';\n      msg.caption = this.l10n('files-count-limit-error-title');\n      msg.text = this.l10n(textKey, {\n        min: countValidationResult.min,\n        max: countValidationResult.max,\n        total: filesCount,\n      });\n      msg.isError = true;\n      this.set$({\n        '*message': msg,\n      });\n    }\n  }\n\n  /** @private */\n  _updateUploadsState() {\n    let itemIds = this.uploadCollection.items();\n    let filesCount = itemIds.length;\n    let summary = {\n      total: filesCount,\n      succeed: 0,\n      uploading: 0,\n      failed: 0,\n    };\n    for (let id of itemIds) {\n      let item = this.uploadCollection.read(id);\n      if (item.getValue('uuid') && !item.getValue('validationErrorMsg')) {\n        summary.succeed += 1;\n      }\n      if (item.getValue('isUploading')) {\n        summary.uploading += 1;\n      }\n      if (item.getValue('validationErrorMsg') || item.getValue('uploadError')) {\n        summary.failed += 1;\n      }\n    }\n    let allDone = summary.total === summary.succeed + summary.failed;\n    let { passed: fitCountRestrictions, tooMany, exact } = this._validateFilesCount();\n    let fitValidation = summary.failed === 0;\n\n    let doneBtnEnabled = summary.total > 0 && fitCountRestrictions && fitValidation;\n    let uploadBtnVisible =\n      !allDone && summary.total - summary.succeed - summary.uploading - summary.failed > 0 && fitCountRestrictions;\n\n    this.set$({\n      doneBtnVisible: allDone,\n      doneBtnEnabled: doneBtnEnabled,\n\n      uploadBtnVisible,\n\n      addMoreBtnEnabled: summary.total === 0 || (!tooMany && !exact),\n      addMoreBtnVisible: !exact || this.getCssData('--cfg-multiple'),\n\n      headerText: this._getHeaderText(summary),\n    });\n  }\n\n  /** @private */\n  _getHeaderText(summary) {\n    const localizedText = (status) => {\n      const count = summary[status];\n      return this.l10n(`header-${status}`, {\n        count: count,\n      });\n    };\n    if (summary.uploading > 0) {\n      return localizedText('uploading');\n    }\n    if (summary.failed > 0) {\n      return localizedText('failed');\n    }\n    if (summary.succeed > 0) {\n      return localizedText('succeed');\n    }\n\n    return localizedText('total');\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.registerActivity(this.activityType);\n\n    this.sub('--cfg-multiple', this._debouncedHandleCollectionUpdate);\n    this.sub('--cfg-multiple-min', this._debouncedHandleCollectionUpdate);\n    this.sub('--cfg-multiple-max', this._debouncedHandleCollectionUpdate);\n\n    this.sub('*currentActivity', (currentActivity) => {\n      if (\n        this.uploadCollection?.size === 0 &&\n        !this.getCssData('--cfg-show-empty-list') &&\n        currentActivity === this.activityType\n      ) {\n        this.$['*currentActivity'] = this.initActivity;\n      }\n    });\n\n    // TODO: could be performance issue on many files\n    // there is no need to update buttons state on every progress tick\n    this.uploadCollection.observe(this._debouncedHandleCollectionUpdate);\n\n    this.sub('*uploadList', (list) => {\n      this._debouncedHandleCollectionUpdate();\n\n      this.set$({\n        hasFiles: list.length > 0,\n      });\n\n      if (list?.length === 0 && !this.getCssData('--cfg-show-empty-list')) {\n        this.historyBack();\n      }\n    });\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    this.uploadCollection.unobserve(this._debouncedHandleCollectionUpdate);\n  }\n}\n\nUploadList.template = /* HTML */ `\n  <lr-activity-header>\n    <span class=\"header-text\">{{headerText}}</span>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *closeModal\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n\n  <div class=\"no-files\" set=\"@hidden: hasFiles\">\n    <slot name=\"empty\"><span l10n=\"no-files\"></span></slot>\n  </div>\n\n  <div class=\"files\" repeat=\"*uploadList\" repeat-item-tag=\"lr-file-item\"></div>\n\n  <div class=\"toolbar\">\n    <button type=\"button\" class=\"cancel-btn secondary-btn\" set=\"onclick: onCancel;\" l10n=\"clear\"></button>\n    <div class=\"toolbar-spacer\"></div>\n    <button\n      type=\"button\"\n      class=\"add-more-btn secondary-btn\"\n      set=\"onclick: onAdd; @disabled: !addMoreBtnEnabled; @hidden: !addMoreBtnVisible\"\n    >\n      <lr-icon name=\"add\"></lr-icon><span l10n=\"add-more\"></span>\n    </button>\n    <button\n      type=\"button\"\n      class=\"upload-btn primary-btn\"\n      set=\"@hidden: !uploadBtnVisible; onclick: onUpload;\"\n      l10n=\"upload\"\n    ></button>\n    <button\n      type=\"button\"\n      class=\"done-btn primary-btn\"\n      set=\"@hidden: !doneBtnVisible; onclick: onDone;  @disabled: !doneBtnEnabled\"\n      l10n=\"done\"\n    ></button>\n  </div>\n\n  <lr-drop-area ghost></lr-drop-area>\n`;\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\n\nexport class UrlSource extends UploaderBlock {\n  activityType = ActivityBlock.activities.URL;\n\n  init$ = {\n    ...this.ctxInit,\n    importDisabled: true,\n    onUpload: () => {\n      let url = this.ref.input['value'];\n      this.uploadCollection.add({\n        externalUrl: url,\n      });\n      this.$['*currentActivity'] = ActivityBlock.activities.UPLOAD_LIST;\n    },\n    onCancel: () => {\n      this.historyBack();\n    },\n    onInput: (e) => {\n      let value = /** @type {HTMLInputElement} */ (e.target).value;\n      this.set$({ importDisabled: !value });\n    },\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.registerActivity(this.activityType);\n  }\n}\n\nUrlSource.template = /* HTML */ `\n  <lr-activity-header>\n    <button type=\"button\" class=\"mini-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"back\"></lr-icon>\n    </button>\n    <div>\n      <lr-icon name=\"url\"></lr-icon>\n      <span l10n=\"caption-from-url\"></span>\n    </div>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *closeModal\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n  <div class=\"content\">\n    <input placeholder=\"https://\" class=\"url-input\" type=\"text\" ref=\"input\" set=\"oninput: onInput\" />\n    <button\n      type=\"button\"\n      class=\"url-upload-btn primary-btn\"\n      set=\"onclick: onUpload; @disabled: importDisabled\"\n    ></button>\n  </div>\n`;\n", "export const canUsePermissionsApi = () => {\n  return typeof navigator.permissions !== 'undefined';\n};\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { canUsePermissionsApi } from '../utils/abilities.js';\nimport { debounce } from '../utils/debounce.js';\n\nexport class CameraSource extends UploaderBlock {\n  activityType = ActivityBlock.activities.CAMERA;\n\n  /** @private */\n  _unsubPermissions = null;\n\n  init$ = {\n    ...this.ctxInit,\n    video: null,\n    videoTransformCss: null,\n    shotBtnDisabled: true,\n    videoHidden: true,\n    messageHidden: true,\n    requestBtnHidden: canUsePermissionsApi(),\n    l10nMessage: null,\n    originalErrorMessage: null,\n    cameraSelectOptions: null,\n    cameraSelectHidden: true,\n\n    onCameraSelectChange: (e) => {\n      /** @type {String} */\n      this._selectedCameraId = e.target.value;\n      this._capture();\n    },\n    onCancel: () => {\n      this.historyBack();\n    },\n    onShot: () => {\n      this._shot();\n    },\n    onRequestPermissions: () => {\n      this._capture();\n    },\n  };\n\n  cssInit$ = {\n    '--cfg-camera-mirror': 1,\n  };\n\n  /** @private */\n  _onActivate = () => {\n    if (canUsePermissionsApi()) {\n      this._subscribePermissions();\n    }\n    this._capture();\n  };\n\n  /** @private */\n  _onDeactivate = () => {\n    if (this._unsubPermissions) {\n      this._unsubPermissions();\n    }\n\n    this._stopCapture();\n  };\n\n  /** @private */\n  _handlePermissionsChange = () => {\n    this._capture();\n  };\n\n  /**\n   * @private\n   * @param {'granted' | 'denied' | 'prompt'} state\n   */\n  _setPermissionsState = debounce((state) => {\n    this.$.originalErrorMessage = null;\n    this.classList.toggle('initialized', state === 'granted');\n\n    if (state === 'granted') {\n      this.set$({\n        videoHidden: false,\n        shotBtnDisabled: false,\n        messageHidden: true,\n      });\n    } else if (state === 'prompt') {\n      this.$.l10nMessage = this.l10n('camera-permissions-prompt');\n      this.set$({\n        videoHidden: true,\n        shotBtnDisabled: true,\n        messageHidden: false,\n      });\n      this._stopCapture();\n    } else {\n      this.$.l10nMessage = this.l10n('camera-permissions-denied');\n\n      this.set$({\n        videoHidden: true,\n        shotBtnDisabled: true,\n        messageHidden: false,\n      });\n      this._stopCapture();\n    }\n  }, 300);\n\n  /** @private */\n  async _subscribePermissions() {\n    try {\n      // @ts-ignore\n      let permissionsResponse = await navigator.permissions.query({ name: 'camera' });\n      permissionsResponse.addEventListener('change', this._handlePermissionsChange);\n    } catch (err) {\n      console.log('Failed to use permissions API. Fallback to manual request mode.', err);\n      this._capture();\n    }\n  }\n\n  /** @private */\n  async _capture() {\n    let constr = {\n      video: {\n        width: {\n          ideal: 1920,\n        },\n        height: {\n          ideal: 1080,\n        },\n        frameRate: {\n          ideal: 30,\n        },\n      },\n      audio: false,\n    };\n    if (this._selectedCameraId) {\n      constr.video.deviceId = {\n        exact: this._selectedCameraId,\n      };\n    }\n    /** @private */\n    this._canvas = document.createElement('canvas');\n    /** @private */\n    this._ctx = this._canvas.getContext('2d');\n\n    try {\n      this._setPermissionsState('prompt');\n      let stream = await navigator.mediaDevices.getUserMedia(constr);\n      stream.addEventListener('inactive', () => {\n        this._setPermissionsState('denied');\n      });\n      this.$.video = stream;\n      /** @private */\n      this._capturing = true;\n      this._setPermissionsState('granted');\n    } catch (err) {\n      this._setPermissionsState('denied');\n      this.$.originalErrorMessage = err.message;\n    }\n  }\n\n  /** @private */\n  _stopCapture() {\n    if (this._capturing) {\n      this.$.video?.getTracks()[0].stop();\n      this.$.video = null;\n      this._capturing = false;\n    }\n  }\n\n  /** @private */\n  _shot() {\n    this._canvas.height = this.ref.video['videoHeight'];\n    this._canvas.width = this.ref.video['videoWidth'];\n    // @ts-ignore\n    this._ctx.drawImage(this.ref.video, 0, 0);\n    let date = Date.now();\n    let name = `camera-${date}.png`;\n    this._canvas.toBlob((blob) => {\n      let file = new File([blob], name, {\n        lastModified: date,\n        type: 'image/png',\n      });\n      this.uploadCollection.add({\n        file,\n        fileName: name,\n        fileSize: file.size,\n        isImage: true,\n        mimeType: file.type,\n      });\n      this.set$({\n        '*currentActivity': ActivityBlock.activities.UPLOAD_LIST,\n      });\n    });\n  }\n\n  async initCallback() {\n    super.initCallback();\n    this.registerActivity(this.activityType, {\n      onActivate: this._onActivate,\n      onDeactivate: this._onDeactivate,\n    });\n\n    this.sub('--cfg-camera-mirror', (val) => {\n      this.$.videoTransformCss = val ? 'scaleX(-1)' : null;\n    });\n\n    try {\n      let deviceList = await navigator.mediaDevices.enumerateDevices();\n      let cameraSelectOptions = deviceList\n        .filter((info) => {\n          return info.kind === 'videoinput';\n        })\n        .map((info, idx) => {\n          return {\n            text: info.label.trim() || `${this.l10n('caption-camera')} ${idx + 1}`,\n            value: info.deviceId,\n          };\n        });\n      if (cameraSelectOptions.length > 1) {\n        this.$.cameraSelectOptions = cameraSelectOptions;\n        this.$.cameraSelectHidden = false;\n      }\n    } catch (err) {\n      // mediaDevices isn't available for HTTP\n      // TODO: handle this case\n    }\n  }\n}\n\nCameraSource.template = /* HTML */ `\n  <lr-activity-header>\n    <button type=\"button\" class=\"mini-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"back\"></lr-icon>\n    </button>\n    <div set=\"@hidden: !cameraSelectHidden\">\n      <lr-icon name=\"camera\"></lr-icon>\n      <span l10n=\"caption-camera\"></span>\n    </div>\n    <lr-select\n      class=\"camera-select\"\n      set=\"$.options: cameraSelectOptions; @hidden: cameraSelectHidden; onchange: onCameraSelectChange\"\n    >\n    </lr-select>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *closeModal\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n  <div class=\"content\">\n    <video\n      autoplay\n      playsinline\n      set=\"srcObject: video; style.transform: videoTransformCss; @hidden: videoHidden\"\n      ref=\"video\"\n    ></video>\n    <div class=\"message-box\" set=\"@hidden: messageHidden\">\n      <span>{{l10nMessage}}</span>\n      <span>{{originalErrorMessage}}</span>\n      <button\n        type=\"button\"\n        set=\"onclick: onRequestPermissions; @hidden: requestBtnHidden\"\n        l10n=\"camera-permissions-request\"\n      ></button>\n    </div>\n    <button type=\"button\" class=\"shot-btn\" set=\"onclick: onShot; @disabled: shotBtnDisabled\">\n      <lr-icon name=\"camera\"></lr-icon>\n    </button>\n  </div>\n`;\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\n\nexport class UploadCtxProvider extends UploaderBlock {}\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { createCdnUrl, createCdnUrlModifiers } from '../../utils/cdn-utils.js';\nimport { fileCssBg } from '../svg-backgrounds/svg-backgrounds.js';\nimport { fileIsImage } from '../../utils/fileTypes.js';\n\nexport class UploadDetails extends UploaderBlock {\n  activityType = ActivityBlock.activities.DETAILS;\n\n  pauseRender = true;\n\n  init$ = {\n    ...this.ctxInit,\n    checkerboard: false,\n    fileSize: null,\n    fileName: '',\n    cdnUrl: '',\n    errorTxt: '',\n    cloudEditBtnHidden: true,\n    onNameInput: null,\n    onBack: () => {\n      this.historyBack();\n    },\n    onRemove: () => {\n      /** @type {File[]} */\n      this.uploadCollection.remove(this.entry.uid);\n      this.historyBack();\n    },\n    onCloudEdit: () => {\n      if (this.entry.getValue('uuid')) {\n        this.$['*currentActivity'] = ActivityBlock.activities.CLOUD_IMG_EDIT;\n      }\n    },\n  };\n\n  cssInit$ = {\n    '--cfg-use-cloud-image-editor': 0,\n    '--cfg-use-local-image-editor': 0,\n  };\n\n  showNonImageThumb() {\n    let color = window.getComputedStyle(this).getPropertyValue('--clr-generic-file-icon');\n    let url = fileCssBg(color, 108, 108);\n    this.ref.filePreview.setImageUrl(url);\n    this.set$({\n      checkerboard: false,\n    });\n  }\n\n  initCallback() {\n    super.initCallback();\n    // Rendering is postponed for the CSS-context-properties usage in template:\n    this.render();\n    this.$.fileSize = this.l10n('file-size-unknown');\n    this.registerActivity(this.activityType, {\n      onDeactivate: () => {\n        this.ref.filePreview.clear();\n      },\n    });\n    /** @type {import('../FilePreview/FilePreview.js').FilePreview} */\n    this.sub('*focusedEntry', (/** @type {import('../../abstract/TypedData.js').TypedData} */ entry) => {\n      if (!entry) {\n        return;\n      }\n      if (this._entrySubs) {\n        this._entrySubs.forEach((sub) => {\n          this._entrySubs.delete(sub);\n          sub.remove();\n        });\n      } else {\n        /** @private */\n        this._entrySubs = new Set();\n      }\n      this.entry = entry;\n      /** @type {File} */\n      let file = entry.getValue('file');\n      if (file) {\n        /**\n         * @private\n         * @type {File}\n         */\n        this._file = file;\n        let isImage = fileIsImage(this._file);\n        if (isImage && !entry.getValue('cdnUrl')) {\n          this.ref.filePreview.setImageFile(this._file);\n          this.set$({\n            checkerboard: true,\n          });\n        }\n        if (!isImage) {\n          this.showNonImageThumb();\n        }\n      }\n      let tmpSub = (prop, callback) => {\n        this._entrySubs.add(this.entry.subscribe(prop, callback));\n      };\n      tmpSub('fileName', (name) => {\n        this.$.fileName = name;\n        this.$.onNameInput = () => {\n          let value = this.ref.file_name_input['value'];\n          Object.defineProperty(this._file, 'name', {\n            writable: true,\n            value: value,\n          });\n          this.entry.setValue('fileName', value);\n        };\n      });\n      tmpSub('fileSize', (size) => {\n        this.$.fileSize = Number.isFinite(size) ? this.fileSizeFmt(size) : this.l10n('file-size-unknown');\n      });\n      tmpSub('uploadError', (error) => {\n        this.$.errorTxt = error?.message;\n      });\n\n      tmpSub('externalUrl', (url) => {\n        if (!url) {\n          return;\n        }\n        if (!this.entry.getValue('uuid')) {\n          this.showNonImageThumb();\n        }\n      });\n      tmpSub('cdnUrl', (cdnUrl) => {\n        const canUseCloudEditor = this.$['--cfg-use-cloud-image-editor'] && cdnUrl && this.entry.getValue('isImage');\n        cdnUrl && this.ref.filePreview.clear();\n        this.set$({\n          cdnUrl,\n          cloudEditBtnHidden: !canUseCloudEditor,\n        });\n        if (cdnUrl && this.entry.getValue('isImage')) {\n          // TODO: need to resize image to fit the canvas size\n          let imageUrl = createCdnUrl(cdnUrl, createCdnUrlModifiers('format/auto', 'preview'));\n          this.ref.filePreview.setImageUrl(this.proxyUrl(imageUrl));\n        }\n      });\n    });\n  }\n}\n\nUploadDetails.template = /* HTML */ `\n  <lr-activity-header>\n    <button type=\"button\" class=\"mini-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"back\"></lr-icon>\n    </button>\n    <span l10n=\"caption-edit-file\"></span>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *closeModal\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n  <div class=\"content\">\n    <lr-tabs tab-list=\"tab-view, tab-details\">\n      <div tab-ctx=\"tab-details\" class=\"details\">\n        <div class=\"info-block\">\n          <div class=\"info-block_name\" l10n=\"file-name\"></div>\n          <input\n            name=\"name-input\"\n            ref=\"file_name_input\"\n            set=\"value: fileName; oninput: onNameInput; @disabled: !!cdnUrl\"\n            type=\"text\"\n          />\n        </div>\n\n        <div class=\"info-block\">\n          <div class=\"info-block_name\" l10n=\"file-size\"></div>\n          <div>{{fileSize}}</div>\n        </div>\n\n        <div class=\"info-block\">\n          <div class=\"info-block_name\" l10n=\"cdn-url\"></div>\n          <a class=\"cdn-link\" target=\"_blank\" set=\"@href: cdnUrl; @disabled: !cdnUrl\">{{cdnUrl}}</a>\n        </div>\n\n        <div>{{errorTxt}}</div>\n      </div>\n\n      <lr-file-preview tab-ctx=\"tab-view\" set=\"@checkerboard: checkerboard;\" ref=\"filePreview\"> </lr-file-preview>\n    </lr-tabs>\n\n    <div class=\"toolbar\" set=\"@edit-disabled: cloudEditBtnHidden\">\n      <button type=\"button\" class=\"edit-btn secondary-btn\" set=\"onclick: onCloudEdit; @hidden: cloudEditBtnHidden;\">\n        <lr-icon name=\"edit\"></lr-icon>\n        <span l10n=\"edit-image\"></span>\n      </button>\n      <button type=\"button\" class=\"remove-btn secondary-btn\" set=\"onclick: onRemove\">\n        <lr-icon name=\"remove\"></lr-icon>\n        <span l10n=\"remove-from-list\"></span>\n      </button>\n      <div></div>\n      <button type=\"button\" class=\"back-btn primary-btn\" set=\"onclick: onBack\">\n        <span l10n=\"ok\"></span>\n      </button>\n    </div>\n  </div>\n`;\n", "import { ActivityBlock } from '../../abstract/ActivityBlock.js';\n\nexport class UiConfirmation {\n  captionL10nStr = 'confirm-your-action';\n  messageL10Str = 'are-you-sure';\n  confirmL10nStr = 'yes';\n  denyL10nStr = 'no';\n  confirmAction() {\n    console.log('Confirmed');\n  }\n  denyAction() {\n    this['historyBack']();\n  }\n}\n\nexport class ConfirmationDialog extends ActivityBlock {\n  activityType = ActivityBlock.activities.CONFIRMATION;\n\n  /** @private */\n  _defaults = new UiConfirmation();\n\n  init$ = {\n    ...this.ctxInit,\n    activityCaption: '',\n    messageTxt: '',\n    confirmBtnTxt: '',\n    denyBtnTxt: '',\n    '*confirmation': null,\n    onConfirm: this._defaults.confirmAction,\n    onDeny: this._defaults.denyAction.bind(this),\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.set$({\n      messageTxt: this.l10n(this._defaults.messageL10Str),\n      confirmBtnTxt: this.l10n(this._defaults.confirmL10nStr),\n      denyBtnTxt: this.l10n(this._defaults.denyL10nStr),\n    });\n    this.sub('*confirmation', (/** @type {UiConfirmation} */ cfn) => {\n      if (!cfn) {\n        return;\n      }\n      this.set$({\n        '*currentActivity': ActivityBlock.activities.CONFIRMATION,\n        activityCaption: this.l10n(cfn.captionL10nStr),\n        messageTxt: this.l10n(cfn.messageL10Str),\n        confirmBtnTxt: this.l10n(cfn.confirmL10nStr),\n        denyBtnTxt: this.l10n(cfn.denyL10nStr),\n        onDeny: () => {\n          cfn.denyAction();\n        },\n        onConfirm: () => {\n          cfn.confirmAction();\n        },\n      });\n    });\n  }\n}\n\nConfirmationDialog.template = /* HTML */ `\n  <lr-activity-header>\n    <button type=\"button\" class=\"mini-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"back\"></lr-icon>\n    </button>\n    <span>{{activityCaption}}</span>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *closeModal\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n\n  <div class=\"message\">{{messageTxt}}</div>\n  <div class=\"toolbar\">\n    <button type=\"button\" class=\"deny-btn secondary-btn\" set=\"onclick: onDeny\">{{denyBtnTxt}}</button>\n    <button type=\"button\" class=\"confirm-btn primary-btn\" set=\"onclick: onConfirm\">{{confirmBtnTxt}}</button>\n  </div>\n`;\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\n\nexport class ProgressBarCommon extends UploaderBlock {\n  init$ = {\n    ...this.ctxInit,\n    visible: false,\n    unknown: false,\n    value: 0,\n\n    '*commonProgress': 0,\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.uploadCollection.observe(() => {\n      let anyUploading = this.uploadCollection.items().some((id) => {\n        let item = this.uploadCollection.read(id);\n        return item.getValue('isUploading');\n      });\n\n      this.$.visible = anyUploading;\n    });\n\n    this.sub('visible', (visible) => {\n      if (visible) {\n        this.setAttribute('active', '');\n      } else {\n        this.removeAttribute('active');\n      }\n    });\n\n    this.sub('*commonProgress', (progress) => {\n      this.$.value = progress;\n    });\n  }\n}\n\nProgressBarCommon.template = /* HTML */ `\n  <lr-progress-bar set=\"visible: visible; unknown: unknown; value: value\"></lr-progress-bar>\n`;\n", "import { Block } from '../../abstract/Block.js';\n\nexport class ProgressBar extends Block {\n  /** @type {Number} */\n  _value = 0;\n  /** @type {Boolean} */\n  _unknownMode = false;\n\n  init$ = {\n    ...this.ctxInit,\n    width: 0,\n    opacity: 0,\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.defineAccessor('value', (value) => {\n      if (value === undefined) {\n        return;\n      }\n      this._value = value;\n\n      if (!this._unknownMode) {\n        this.style.setProperty('--l-width', this._value.toString());\n      }\n    });\n    this.defineAccessor('visible', (visible) => {\n      this.ref.line.classList.toggle('progress--hidden', !visible);\n    });\n    this.defineAccessor('unknown', (unknown) => {\n      this._unknownMode = unknown;\n      this.ref.line.classList.toggle('progress--unknown', unknown);\n    });\n  }\n}\n\nProgressBar.template = /* HTML */ ` <div ref=\"line\" class=\"progress\"></div> `;\n", "export const TRANSPARENT_PIXEL_SRC =\n  'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=';\n", "import { Block } from '../../abstract/Block.js';\nimport { checkerboardCssBg } from '../svg-backgrounds/svg-backgrounds.js';\nimport { TRANSPARENT_PIXEL_SRC } from '../../utils/transparentPixelSrc.js';\n\nexport class FilePreview extends Block {\n  init$ = {\n    ...this.ctxInit,\n    checkerboard: false,\n    src: TRANSPARENT_PIXEL_SRC,\n  };\n\n  constructor() {\n    super();\n  }\n\n  initCallback() {\n    super.initCallback();\n    this.sub('checkerboard', () => {\n      this.style.backgroundImage = this.hasAttribute('checkerboard') ? `url(${checkerboardCssBg()})` : 'unset';\n    });\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    URL.revokeObjectURL(this._lastObjectUrl);\n  }\n\n  /** @param {HTMLImageElement} img */\n  setImage(img) {\n    this.$.src = img.src;\n  }\n\n  /** @param {File} imgFile */\n  setImageFile(imgFile) {\n    let url = URL.createObjectURL(imgFile);\n    this.$.src = url;\n    this._lastObjectUrl = url;\n  }\n\n  /** @param {String} url */\n  setImageUrl(url) {\n    this.$.src = url;\n  }\n\n  clear() {\n    URL.revokeObjectURL(this._lastObjectUrl);\n    this.$.src = TRANSPARENT_PIXEL_SRC;\n  }\n}\n\nFilePreview.template = /* HTML */ ` <lr-img class=\"img-view\" ref=\"img\" set=\"@src: src; style.aa: src;\" /> `;\n\nFilePreview.bindAttributes({\n  checkerboard: 'checkerboard',\n});\n", "function normalize(...args) {\n  return args.reduce((result, arg) => {\n    if (typeof arg === 'string') {\n      result[arg] = true;\n      return result;\n    }\n\n    for (let token of Object.keys(arg)) {\n      result[token] = arg[token];\n    }\n\n    return result;\n  }, {});\n}\n\nexport function classNames(...args) {\n  let mapping = normalize(...args);\n  return Object.keys(mapping)\n    .reduce((result, token) => {\n      if (mapping[token]) {\n        result.push(token);\n      }\n\n      return result;\n    }, [])\n    .join(' ');\n}\n\nexport function applyClassNames(element, ...args) {\n  let mapping = normalize(...args);\n  for (let token of Object.keys(mapping)) {\n    element.classList.toggle(token, mapping[token]);\n  }\n}\n", "/**\n * @param {function} callback\n * @param {Number} wait\n * @returns {function}\n */\nexport function debounce(callback, wait) {\n  let timer;\n  let debounced = (...args) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => callback(...args), wait);\n  };\n  debounced.cancel = () => {\n    clearTimeout(timer);\n  };\n  return debounced;\n}\n", "import { joinCdnOperations } from '../../../../utils/cdn-utils.js';\nimport { stringToArray } from '../../../../utils/stringToArray.js';\n\nexport const OPERATIONS_ZEROS = {\n  brightness: 0,\n  exposure: 0,\n  gamma: 100,\n  contrast: 0,\n  saturation: 0,\n  vibrance: 0,\n  warmth: 0,\n  enhance: 0,\n  filter: 0,\n  rotate: 0,\n};\n\n/**\n * @param {String} operation\n * @param {Number | String | object} options\n * @returns {String}\n */\nfunction transformationToStr(operation, options) {\n  if (typeof options === 'number') {\n    return OPERATIONS_ZEROS[operation] !== options ? `${operation}/${options}` : '';\n  }\n\n  if (typeof options === 'boolean') {\n    return options && OPERATIONS_ZEROS[operation] !== options ? `${operation}` : '';\n  }\n\n  if (operation === 'filter') {\n    if (!options || OPERATIONS_ZEROS[operation] === options.amount) {\n      return '';\n    }\n    let { name, amount } = options;\n    return `${operation}/${name}/${amount}`;\n  }\n\n  if (operation === 'crop') {\n    if (!options) {\n      return '';\n    }\n    let { dimensions, coords } = options;\n    return `${operation}/${dimensions.join('x')}/${coords.join(',')}`;\n  }\n\n  return '';\n}\n\n// TODO: refactor all the operations constants\nconst SUPPORTED_OPERATIONS_ORDERED = [\n  'enhance',\n  'brightness',\n  'exposure',\n  'gamma',\n  'contrast',\n  'saturation',\n  'vibrance',\n  'warmth',\n  'filter',\n  'mirror',\n  'flip',\n  'rotate',\n  'crop',\n];\n\n/**\n * @param {import('../types').Transformations} transformations\n * @returns {String}\n */\nexport function transformationsToOperations(transformations) {\n  return joinCdnOperations(\n    ...SUPPORTED_OPERATIONS_ORDERED.filter(\n      (operation) => typeof transformations[operation] !== 'undefined' && transformations[operation] !== null\n    )\n      .map((operation) => {\n        let options = transformations[operation];\n        return transformationToStr(operation, options);\n      })\n      .filter((str) => !!str)\n  );\n}\n\nexport const COMMON_OPERATIONS = joinCdnOperations('format/auto', 'progressive/yes');\n\nconst asNumber = ([value]) => (typeof value !== 'undefined' ? Number(value) : undefined);\nconst asBoolean = () => true;\nconst asFilter = ([name, amount]) => ({\n  name,\n  amount: typeof amount !== 'undefined' ? Number(amount) : 100,\n});\n\n// Docs: https://uploadcare.com/docs/transformations/image/resize-crop/#operation-crop\n// We don't support percentages and aligment presets,\n// Because it's unclear how to handle them in the Editor UI\n// TODO: add support for percentages and aligment presets\nconst asCrop = ([dimensions, coords]) => {\n  return { dimensions: stringToArray(dimensions, 'x').map(Number), coords: stringToArray(coords).map(Number) };\n};\n\nconst OPERATION_PROCESSORS = {\n  enhance: asNumber,\n  brightness: asNumber,\n  exposure: asNumber,\n  gamma: asNumber,\n  contrast: asNumber,\n  saturation: asNumber,\n  vibrance: asNumber,\n  warmth: asNumber,\n  filter: asFilter,\n  mirror: asBoolean,\n  flip: asBoolean,\n  rotate: asNumber,\n  crop: asCrop,\n};\n\n/**\n * @param {string[]} operations\n * @returns {import('../types.js').Transformations}\n */\nexport function operationsToTransformations(operations) {\n  /** @type {import('../types.js').Transformations} */\n  let transformations = {};\n  for (let operation of operations) {\n    let [name, ...args] = operation.split('/');\n    if (!SUPPORTED_OPERATIONS_ORDERED.includes(name)) {\n      continue;\n    }\n    const processor = OPERATION_PROCESSORS[name];\n    const value = processor(args);\n    transformations[name] = value;\n  }\n  return transformations;\n}\n", "import { createCdnUrl, createCdnUrlModifiers } from '../../../utils/cdn-utils.js';\nimport { transformationsToOperations } from './lib/transformationUtils.js';\nimport { TRANSPARENT_PIXEL_SRC } from '../../../utils/transparentPixelSrc.js';\n\n/** @param {import('./CloudEditor.js').CloudEditor} fnCtx */\nexport function initState(fnCtx) {\n  return {\n    '*originalUrl': null,\n    '*faderEl': null,\n    '*cropperEl': null,\n    '*imgEl': null,\n    '*imgContainerEl': null,\n    '*networkProblems': false,\n    '*imageSize': null,\n    /** @type {import('./types.js').Transformations} */\n    '*editorTransformations': {},\n\n    entry: null,\n    extension: null,\n    editorMode: false,\n    modalCaption: '',\n    isImage: false,\n    msg: '',\n    src: TRANSPARENT_PIXEL_SRC,\n    fileType: '',\n    showLoader: false,\n    uuid: null,\n    cdnUrl: null,\n\n    'presence.networkProblems': false,\n    'presence.modalCaption': true,\n    'presence.editorToolbar': false,\n    'presence.viewerToolbar': true,\n    // TODO: beware of wrong ctx in case of element re-creation:\n    '*on.retryNetwork': () => {\n      let images = fnCtx.querySelectorAll('img');\n      for (let img of images) {\n        let originalSrc = img.src;\n        img.src = TRANSPARENT_PIXEL_SRC;\n        img.src = originalSrc;\n      }\n      fnCtx.$['*networkProblems'] = false;\n    },\n    '*on.apply': (transformations) => {\n      if (!transformations) {\n        return;\n      }\n      let originalUrl = fnCtx.$['*originalUrl'];\n      let cdnUrlModifiers = createCdnUrlModifiers(transformationsToOperations(transformations));\n      let cdnUrl = createCdnUrl(originalUrl, createCdnUrlModifiers(cdnUrlModifiers, 'preview'));\n\n      /** @type {import('./types.js').ApplyResult} */\n      let eventData = {\n        originalUrl,\n        cdnUrlModifiers,\n        cdnUrl,\n        transformations,\n      };\n      fnCtx.dispatchEvent(\n        new CustomEvent('apply', {\n          detail: eventData,\n          bubbles: true,\n          composed: true,\n        })\n      );\n      fnCtx.remove();\n    },\n    '*on.cancel': () => {\n      fnCtx.remove();\n\n      fnCtx.dispatchEvent(\n        new CustomEvent('cancel', {\n          bubbles: true,\n          composed: true,\n        })\n      );\n    },\n  };\n}\n", "import { TRANSPARENT_PIXEL_SRC } from '../../../utils/transparentPixelSrc.js';\n\nexport const TEMPLATE = /* HTML */ `\n  <div class=\"wrapper wrapper_desktop\">\n    <lr-presence-toggle class=\"network_problems_splash\" set=\"visible: presence.networkProblems;\">\n      <div class=\"network_problems_content\">\n        <div class=\"network_problems_icon\">\n          <lr-icon size=\"20\" name=\"sad\"></lr-icon>\n        </div>\n        <div class=\"network_problems_text\">Network error</div>\n      </div>\n      <div class=\"network_problems_footer\">\n        <lr-btn-ui theme=\"primary\" text=\"Retry\" set=\"onclick: *on.retryNetwork\"></lr-btn-ui>\n      </div>\n    </lr-presence-toggle>\n    <div class=\"viewport\">\n      <div class=\"file_type_outer\">\n        <div class=\"file_type\">{{fileType}}</div>\n      </div>\n      <div class=\"image_container\" ref=\"img-container-el\">\n        <img src=\"${TRANSPARENT_PIXEL_SRC}\" class=\"image image_visible_from_editor\" ref=\"img-el\" />\n        <lr-editor-image-cropper ref=\"cropper-el\"></lr-editor-image-cropper>\n        <lr-editor-image-fader ref=\"fader-el\"></lr-editor-image-fader>\n      </div>\n      <div class=\"info_pan\">{{msg}}</div>\n    </div>\n    <div class=\"toolbar\">\n      <lr-line-loader-ui set=\"active: showLoader\"></lr-line-loader-ui>\n      <div class=\"toolbar_content toolbar_content__editor\">\n        <lr-editor-toolbar></lr-editor-toolbar>\n      </div>\n    </div>\n  </div>\n`;\n", "import { OPERATIONS_ZEROS } from './lib/transformationUtils.js';\n\n/** @type {{ CROP: 'crop'; SLIDERS: 'sliders'; FILTERS: 'filters' }} */\nexport const TabId = {\n  CROP: 'crop',\n  SLIDERS: 'sliders',\n  FILTERS: 'filters',\n};\nexport const TABS = [TabId.CROP, TabId.SLIDERS, TabId.FILTERS];\n\nexport const ALL_COLOR_OPERATIONS = [\n  'brightness',\n  'exposure',\n  'gamma',\n  'contrast',\n  'saturation',\n  'vibrance',\n  'warmth',\n  'enhance',\n];\n\nexport const ALL_FILTERS = [\n  'adaris',\n  'briaril',\n  'calarel',\n  'carris',\n  'cynarel',\n  'cyren',\n  'elmet',\n  'elonni',\n  'enzana',\n  'erydark',\n  'fenralan',\n  'ferand',\n  'galen',\n  'gavin',\n  'gethriel',\n  'iorill',\n  'iothari',\n  'iselva',\n  'jadis',\n  'lavra',\n  'misiara',\n  'namala',\n  'nerion',\n  'nethari',\n  'pamaya',\n  'sarnar',\n  'sedis',\n  'sewen',\n  'sorahel',\n  'sorlen',\n  'tarian',\n  'thellassan',\n  'varriel',\n  'varven',\n  'vevera',\n  'virkas',\n  'yedis',\n  'yllara',\n  'zatvel',\n  'zevcen',\n];\n\nexport const ALL_CROP_OPERATIONS = ['rotate', 'mirror', 'flip'];\n\n/** KeypointsNumber is the number of keypoints loaded from each side of zero, not total number */\nexport const COLOR_OPERATIONS_CONFIG = {\n  brightness: {\n    zero: OPERATIONS_ZEROS.brightness,\n    range: [-100, 100],\n    keypointsNumber: 2,\n  },\n  exposure: {\n    zero: OPERATIONS_ZEROS.exposure,\n    range: [-500, 500],\n    keypointsNumber: 2,\n  },\n  gamma: {\n    zero: OPERATIONS_ZEROS.gamma,\n    range: [0, 1000],\n    keypointsNumber: 2,\n  },\n  contrast: {\n    zero: OPERATIONS_ZEROS.contrast,\n    range: [-100, 500],\n    keypointsNumber: 2,\n  },\n  saturation: {\n    zero: OPERATIONS_ZEROS.saturation,\n    range: [-100, 500],\n    keypointsNumber: 1,\n  },\n  vibrance: {\n    zero: OPERATIONS_ZEROS.vibrance,\n    range: [-100, 500],\n    keypointsNumber: 1,\n  },\n  warmth: {\n    zero: OPERATIONS_ZEROS.warmth,\n    range: [-100, 100],\n    keypointsNumber: 1,\n  },\n  enhance: {\n    zero: OPERATIONS_ZEROS.enhance,\n    range: [0, 100],\n    keypointsNumber: 1,\n  },\n  filter: {\n    zero: OPERATIONS_ZEROS.filter,\n    range: [0, 100],\n    keypointsNumber: 1,\n  },\n};\n", "import { Block } from '../../../abstract/Block.js';\nimport {\n  createCdnUrl,\n  createCdnUrlModifiers,\n  createOriginalUrl,\n  extractOperations,\n  extractUuid,\n} from '../../../utils/cdn-utils.js';\nimport { TRANSPARENT_PIXEL_SRC } from '../../../utils/transparentPixelSrc.js';\nimport { classNames } from './lib/classNames.js';\nimport { debounce } from './lib/debounce.js';\nimport { operationsToTransformations, transformationsToOperations } from './lib/transformationUtils.js';\nimport { initState } from './state.js';\nimport { TEMPLATE } from './template.js';\nimport { TabId } from './toolbar-constants.js';\n\nexport class CloudEditor extends Block {\n  pauseRender = true;\n\n  get ctxName() {\n    return this.autoCtxName;\n  }\n\n  init$ = {\n    ...this.ctxInit,\n    ...initState(this),\n  };\n\n  /** @private */\n  _debouncedShowLoader = debounce(this._showLoader.bind(this), 300);\n\n  _showLoader(show) {\n    this.$.showLoader = show;\n  }\n\n  /**\n   * To proper work, we need non-zero size the element. So, we'll wait for it.\n   *\n   * @private\n   * @returns {Promise<void>}\n   */\n  _waitForSize() {\n    const TIMEOUT = 3000;\n    return new Promise((resolve, reject) => {\n      const timeoutId = setTimeout(() => {\n        reject(new Error('[cloud-image-editor] timout waiting for non-zero container size'));\n      }, TIMEOUT);\n      const resizeObserver = new ResizeObserver(([element]) => {\n        if (element.contentRect.width > 0 && element.contentRect.height > 0) {\n          resolve();\n          clearTimeout(timeoutId);\n          resizeObserver.disconnect();\n        }\n      });\n      resizeObserver.observe(this);\n    });\n  }\n\n  cssInit$ = {\n    '--cfg-cdn-cname': 'https://ucarecdn.com',\n  };\n\n  async connectedCallback() {\n    super.connectedCallback();\n    try {\n      await this._waitForSize();\n    } catch (err) {\n      if (this.isConnected) {\n        console.error(err.message);\n      }\n      return;\n    }\n    this.render();\n\n    this.$['*faderEl'] = this.ref['fader-el'];\n    this.$['*cropperEl'] = this.ref['cropper-el'];\n    this.$['*imgContainerEl'] = this.ref['img-container-el'];\n\n    this.ref['img-el'].addEventListener('load', (e) => {\n      this._imgLoading = false;\n      this._debouncedShowLoader(false);\n\n      if (this.$.src !== TRANSPARENT_PIXEL_SRC) {\n        this.$['*networkProblems'] = false;\n      }\n    });\n\n    this.ref['img-el'].addEventListener('error', (e) => {\n      this._imgLoading = false;\n      this._debouncedShowLoader(false);\n\n      this.$['*networkProblems'] = true;\n    });\n\n    this.sub('src', (src) => {\n      let el = this.ref['img-el'];\n      if (el.src !== src) {\n        this._imgLoading = true;\n        el.src = src || TRANSPARENT_PIXEL_SRC;\n      }\n    });\n\n    this.sub('*tabId', (tabId) => {\n      this.ref['img-el'].className = classNames('image', {\n        image_hidden_to_cropper: tabId === TabId.CROP,\n        image_hidden_effects: tabId !== TabId.CROP,\n      });\n    });\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    if (this.$.cdnUrl) {\n      let uuid = extractUuid(this.$.cdnUrl);\n      this.$['*originalUrl'] = createOriginalUrl(this.$.cdnUrl, uuid);\n      let operations = extractOperations(this.$.cdnUrl);\n      let transformations = operationsToTransformations(operations);\n      this.$['*editorTransformations'] = transformations;\n    } else if (this.$.uuid) {\n      this.$['*originalUrl'] = createOriginalUrl(this.localCtx.read('--cfg-cdn-cname'), this.$.uuid);\n    } else {\n      throw new Error('No UUID nor CDN URL provided');\n    }\n\n    this.classList.add('editor_ON');\n\n    this.sub('*networkProblems', (networkProblems) => {\n      this.$['presence.networkProblems'] = networkProblems;\n      this.$['presence.modalCaption'] = !networkProblems;\n    });\n\n    this.sub(\n      '*editorTransformations',\n      (transformations) => {\n        let originalUrl = this.$['*originalUrl'];\n        let cdnUrlModifiers = createCdnUrlModifiers(transformationsToOperations(transformations));\n        let cdnUrl = createCdnUrl(originalUrl, createCdnUrlModifiers(cdnUrlModifiers, 'preview'));\n\n        /** @type {import('./types.js').ApplyResult} */\n        let eventData = {\n          originalUrl,\n          cdnUrlModifiers,\n          cdnUrl,\n          transformations,\n        };\n        this.dispatchEvent(\n          new CustomEvent('change', {\n            detail: eventData,\n            bubbles: true,\n            composed: true,\n          })\n        );\n      },\n      false\n    );\n\n    try {\n      fetch(createCdnUrl(this.$['*originalUrl'], createCdnUrlModifiers('json')))\n        .then((response) => response.json())\n        .then(({ width, height }) => {\n          this.$['*imageSize'] = { width, height };\n        });\n    } catch (err) {\n      if (err) {\n        console.error('Failed to load image info', err);\n      }\n    }\n  }\n}\n\nCloudEditor.template = TEMPLATE;\nCloudEditor.bindAttributes({\n  uuid: 'uuid',\n  'cdn-url': 'cdnUrl',\n});\n", "export const CROP_PADDING = 20;\nexport const THUMB_CORNER_SIZE = 24;\nexport const THUMB_SIDE_SIZE = 34;\nexport const THUMB_STROKE_WIDTH = 3;\nexport const THUMB_OFFSET = THUMB_STROKE_WIDTH / 2;\n\nexport const GUIDE_STROKE_WIDTH = 1;\nexport const GUIDE_THIRD = 100 / 3;\nexport const MIN_CROP_SIZE = THUMB_CORNER_SIZE * 2 + THUMB_SIDE_SIZE;\n", "import { THUMB_CORNER_SIZE, THUMB_OFFSET, THUMB_SIDE_SIZE } from './cropper-constants.js';\n\n/**\n * @param {SVGElement} node\n * @param {{ [key: String]: String | Number }} attrs\n */\nexport function setSvgNodeAttrs(node, attrs) {\n  for (let p in attrs) node.setAttributeNS(null, p, attrs[p].toString());\n}\n\n/**\n * @param {String} name\n * @param {{ [key: String]: String | Number }} attrs\n * @returns {SVGElement}\n */\nexport function createSvgNode(name, attrs = {}) {\n  let node = document.createElementNS('http://www.w3.org/2000/svg', name);\n  setSvgNodeAttrs(node, attrs);\n  return node;\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {String} direction\n */\nexport function cornerPath(rect, direction) {\n  let { x, y, width, height } = rect;\n\n  let wMul = direction.includes('w') ? 0 : 1;\n  let hMul = direction.includes('n') ? 0 : 1;\n  let xSide = [-1, 1][wMul];\n  let ySide = [-1, 1][hMul];\n\n  let p1 = [\n    x + wMul * width + THUMB_OFFSET * xSide,\n    y + hMul * height + THUMB_OFFSET * ySide - THUMB_CORNER_SIZE * ySide,\n  ];\n  let p2 = [x + wMul * width + THUMB_OFFSET * xSide, y + hMul * height + THUMB_OFFSET * ySide];\n  let p3 = [\n    x + wMul * width - THUMB_CORNER_SIZE * xSide + THUMB_OFFSET * xSide,\n    y + hMul * height + THUMB_OFFSET * ySide,\n  ];\n\n  let path = `M ${p1[0]} ${p1[1]} L ${p2[0]} ${p2[1]} L ${p3[0]} ${p3[1]}`;\n  let center = p2;\n\n  return {\n    d: path,\n    center,\n  };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {String} direction\n */\nexport function sidePath(rect, direction) {\n  let { x, y, width, height } = rect;\n\n  let wMul = ['n', 's'].includes(direction) ? 0.5 : { w: 0, e: 1 }[direction];\n  let hMul = ['w', 'e'].includes(direction) ? 0.5 : { n: 0, s: 1 }[direction];\n  let xSide = [-1, 1][wMul];\n  let ySide = [-1, 1][hMul];\n\n  let p1, p2;\n  if (['n', 's'].includes(direction)) {\n    p1 = [x + wMul * width - THUMB_SIDE_SIZE / 2, y + hMul * height + THUMB_OFFSET * ySide];\n    p2 = [x + wMul * width + THUMB_SIDE_SIZE / 2, y + hMul * height + THUMB_OFFSET * ySide];\n  } else {\n    p1 = [x + wMul * width + THUMB_OFFSET * xSide, y + hMul * height - THUMB_SIDE_SIZE / 2];\n    p2 = [x + wMul * width + THUMB_OFFSET * xSide, y + hMul * height + THUMB_SIDE_SIZE / 2];\n  }\n  let path = `M ${p1[0]} ${p1[1]} L ${p2[0]} ${p2[1]}`;\n  let center = [p2[0] - (p2[0] - p1[0]) / 2, p2[1] - (p2[1] - p1[1]) / 2];\n\n  return { d: path, center };\n}\n\n/** @param {String} direction */\nexport function thumbCursor(direction) {\n  if (direction === '') {\n    return 'move';\n  }\n  if (['e', 'w'].includes(direction)) {\n    return 'ew-resize';\n  }\n  if (['n', 's'].includes(direction)) {\n    return 'ns-resize';\n  }\n  if (['nw', 'se'].includes(direction)) {\n    return 'nwse-resize';\n  }\n  return 'nesw-resize';\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {[Number, Number]} delta\n */\nexport function moveRect(rect, [dx, dy]) {\n  return {\n    ...rect,\n    x: rect.x + dx,\n    y: rect.y + dy,\n  };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect1\n * @param {import('./types.js').Rectangle} rect2\n */\nexport function constraintRect(rect1, rect2) {\n  let { x } = rect1;\n  let { y } = rect1;\n  if (rect1.x < rect2.x) {\n    x = rect2.x;\n  } else if (rect1.x + rect1.width > rect2.x + rect2.width) {\n    x = rect2.x + rect2.width - rect1.width;\n  }\n  if (rect1.y < rect2.y) {\n    y = rect2.y;\n  } else if (rect1.y + rect1.height > rect2.y + rect2.height) {\n    y = rect2.y + rect2.height - rect1.height;\n  }\n\n  return {\n    ...rect1,\n    x,\n    y,\n  };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {[Number, Number]} delta\n * @param {String} direction\n */\nexport function expandRect(rect, [dx, dy], direction) {\n  let { x, y, width, height } = rect;\n\n  if (direction.includes('n')) {\n    y += dy;\n    height -= dy;\n  }\n  if (direction.includes('s')) {\n    height += dy;\n  }\n  if (direction.includes('w')) {\n    x += dx;\n    width -= dx;\n  }\n  if (direction.includes('e')) {\n    width += dx;\n  }\n  return {\n    x,\n    y,\n    width,\n    height,\n  };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect1\n * @param {import('./types.js').Rectangle} rect2\n */\nexport function intersectionRect(rect1, rect2) {\n  let leftX = Math.max(rect1.x, rect2.x);\n  let rightX = Math.min(rect1.x + rect1.width, rect2.x + rect2.width);\n  let topY = Math.max(rect1.y, rect2.y);\n  let bottomY = Math.min(rect1.y + rect1.height, rect2.y + rect2.height);\n\n  return { x: leftX, y: topY, width: rightX - leftX, height: bottomY - topY };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {[Number, Number]} minSize\n * @param {String} direction\n */\nexport function minRectSize(rect, [minWidth, minHeight], direction) {\n  let { x, y, width, height } = rect;\n\n  if (direction.includes('n')) {\n    let prevHeight = height;\n    height = Math.max(minHeight, height);\n    y = y + prevHeight - height;\n  }\n  if (direction.includes('s')) {\n    height = Math.max(minHeight, height);\n  }\n  if (direction.includes('w')) {\n    let prevWidth = width;\n    width = Math.max(minWidth, width);\n    x = x + prevWidth - width;\n  }\n  if (direction.includes('e')) {\n    width = Math.max(minWidth, width);\n  }\n\n  return { x, y, width, height };\n}\n\n/**\n * @param {import('./types.js').Rectangle} rect\n * @param {[Number, Number]} point\n */\nexport function rectContainsPoint(rect, [x, y]) {\n  return rect.x <= x && x <= rect.x + rect.width && rect.y <= y && y <= rect.y + rect.height;\n}\n", "import { Block } from '../../../abstract/Block.js';\nimport {\n  constraintRect,\n  cornerPath,\n  createSvgNode,\n  expandRect,\n  intersectionRect,\n  minRectSize,\n  moveRect,\n  rectContainsPoint,\n  setSvgNodeAttrs,\n  sidePath,\n  thumbCursor,\n} from './crop-utils.js';\nimport {\n  GUIDE_STROKE_WIDTH,\n  GUIDE_THIRD,\n  MIN_CROP_SIZE,\n  THUMB_CORNER_SIZE,\n  THUMB_OFFSET,\n  THUMB_STROKE_WIDTH,\n} from './cropper-constants.js';\nimport { classNames } from './lib/classNames.js';\n\nexport class CropFrame extends Block {\n  init$ = {\n    ...this.ctxInit,\n    dragging: false,\n  };\n\n  constructor() {\n    super();\n\n    /** @private */\n    this._handlePointerUp = this._handlePointerUp_.bind(this);\n\n    /** @private */\n    this._handlePointerMove = this._handlePointerMove_.bind(this);\n\n    /** @private */\n    this._handleSvgPointerMove = this._handleSvgPointerMove_.bind(this);\n  }\n\n  _shouldThumbBeDisabled(direction) {\n    let imageBox = this.$['*imageBox'];\n    if (!imageBox) {\n      return;\n    }\n\n    if (direction === '' && imageBox.height <= MIN_CROP_SIZE && imageBox.width <= MIN_CROP_SIZE) {\n      return true;\n    }\n\n    let tooHigh = imageBox.height <= MIN_CROP_SIZE && (direction.includes('n') || direction.includes('s'));\n    let tooWide = imageBox.width <= MIN_CROP_SIZE && (direction.includes('e') || direction.includes('w'));\n    return tooHigh || tooWide;\n  }\n\n  _createBackdrop() {\n    /** @type {import('./types.js').Rectangle} */\n    let cropBox = this.$['*cropBox'];\n    if (!cropBox) {\n      return;\n    }\n    let { x, y, width, height } = cropBox;\n    let svg = this.ref['svg-el'];\n\n    let mask = createSvgNode('mask', { id: 'backdrop-mask' });\n    let maskRectOuter = createSvgNode('rect', {\n      x: 0,\n      y: 0,\n      width: '100%',\n      height: '100%',\n      fill: 'white',\n    });\n    let maskRectInner = createSvgNode('rect', {\n      x,\n      y,\n      width,\n      height,\n      fill: 'black',\n    });\n    mask.appendChild(maskRectOuter);\n    mask.appendChild(maskRectInner);\n\n    let backdropRect = createSvgNode('rect', {\n      x: 0,\n      y: 0,\n      width: '100%',\n      height: '100%',\n      fill: 'var(--color-image-background)',\n      'fill-opacity': 0.85,\n      mask: 'url(#backdrop-mask)',\n    });\n    svg.appendChild(backdropRect);\n    svg.appendChild(mask);\n\n    this._backdropMask = mask;\n    this._backdropMaskInner = maskRectInner;\n  }\n\n  /** Super tricky workaround for the chromium bug See https://bugs.chromium.org/p/chromium/issues/detail?id=330815 */\n  _resizeBackdrop() {\n    if (!this._backdropMask) {\n      return;\n    }\n    this._backdropMask.style.display = 'none';\n    window.requestAnimationFrame(() => {\n      this._backdropMask.style.display = 'block';\n    });\n  }\n\n  _updateBackdrop() {\n    /** @type {import('./types.js').Rectangle} */\n    let cropBox = this.$['*cropBox'];\n    if (!cropBox) {\n      return;\n    }\n    let { x, y, width, height } = cropBox;\n\n    setSvgNodeAttrs(this._backdropMaskInner, { x, y, width, height });\n  }\n\n  _updateFrame() {\n    /** @type {import('./types.js').Rectangle} */\n    let cropBox = this.$['*cropBox'];\n    if (!cropBox) {\n      return;\n    }\n    for (let thumb of Object.values(this._frameThumbs)) {\n      let { direction, pathNode, interactionNode, groupNode } = thumb;\n      let isCenter = direction === '';\n      let isCorner = direction.length === 2;\n\n      if (isCenter) {\n        let { x, y, width, height } = cropBox;\n        let center = [x + width / 2, y + height / 2];\n        setSvgNodeAttrs(interactionNode, {\n          r: Math.min(width, height) / 3,\n          cx: center[0],\n          cy: center[1],\n        });\n      } else {\n        let { d, center } = isCorner ? cornerPath(cropBox, direction) : sidePath(cropBox, direction);\n        setSvgNodeAttrs(interactionNode, { cx: center[0], cy: center[1] });\n        setSvgNodeAttrs(pathNode, { d });\n      }\n\n      let disableThumb = this._shouldThumbBeDisabled(direction);\n      groupNode.setAttribute(\n        'class',\n        classNames('thumb', {\n          'thumb--hidden': disableThumb,\n          'thumb--visible': !disableThumb,\n        })\n      );\n    }\n\n    let frameGuides = this._frameGuides;\n    setSvgNodeAttrs(frameGuides, {\n      x: cropBox.x - GUIDE_STROKE_WIDTH * 0.5,\n      y: cropBox.y - GUIDE_STROKE_WIDTH * 0.5,\n      width: cropBox.width + GUIDE_STROKE_WIDTH,\n      height: cropBox.height + GUIDE_STROKE_WIDTH,\n    });\n  }\n\n  _createThumbs() {\n    let frameThumbs = {};\n\n    for (let i = 0; i < 3; i++) {\n      for (let j = 0; j < 3; j++) {\n        let direction = `${['n', '', 's'][i]}${['w', '', 'e'][j]}`;\n        let groupNode = createSvgNode('g');\n        groupNode.classList.add('thumb');\n        groupNode.setAttribute('with-effects', '');\n        let interactionNode = createSvgNode('circle', {\n          r: THUMB_CORNER_SIZE + THUMB_OFFSET,\n          fill: 'transparent',\n        });\n        let pathNode = createSvgNode('path', {\n          stroke: 'currentColor',\n          fill: 'none',\n          'stroke-width': THUMB_STROKE_WIDTH,\n        });\n        groupNode.appendChild(pathNode);\n        groupNode.appendChild(interactionNode);\n        frameThumbs[direction] = {\n          direction,\n          pathNode,\n          interactionNode,\n          groupNode,\n        };\n\n        interactionNode.addEventListener('pointerdown', this._handlePointerDown.bind(this, direction));\n      }\n    }\n\n    return frameThumbs;\n  }\n\n  _createGuides() {\n    let svg = createSvgNode('svg');\n\n    let rect = createSvgNode('rect', {\n      x: 0,\n      y: 0,\n      width: '100%',\n      height: '100%',\n      fill: 'none',\n      stroke: '#000000',\n      'stroke-width': GUIDE_STROKE_WIDTH,\n      'stroke-opacity': 0.5,\n    });\n    svg.appendChild(rect);\n\n    for (let i = 1; i <= 2; i++) {\n      let line = createSvgNode('line', {\n        x1: `${GUIDE_THIRD * i}%`,\n        y1: `0%`,\n        x2: `${GUIDE_THIRD * i}%`,\n        y2: `100%`,\n        stroke: '#000000',\n        'stroke-width': GUIDE_STROKE_WIDTH,\n        'stroke-opacity': 0.3,\n      });\n      svg.appendChild(line);\n    }\n\n    for (let i = 1; i <= 2; i++) {\n      let line = createSvgNode('line', {\n        x1: `0%`,\n        y1: `${GUIDE_THIRD * i}%`,\n        x2: `100%`,\n        y2: `${GUIDE_THIRD * i}%`,\n        stroke: '#000000',\n        'stroke-width': GUIDE_STROKE_WIDTH,\n        'stroke-opacity': 0.3,\n      });\n      svg.appendChild(line);\n    }\n\n    svg.classList.add('guides', 'guides--semi-hidden');\n\n    return svg;\n  }\n\n  _createFrame() {\n    let svg = this.ref['svg-el'];\n    let fr = document.createDocumentFragment();\n\n    let frameGuides = this._createGuides();\n    fr.appendChild(frameGuides);\n\n    let frameThumbs = this._createThumbs();\n    for (let { groupNode } of Object.values(frameThumbs)) {\n      fr.appendChild(groupNode);\n    }\n\n    svg.appendChild(fr);\n    this._frameThumbs = frameThumbs;\n    this._frameGuides = frameGuides;\n  }\n\n  _handlePointerDown(direction, e) {\n    let thumb = this._frameThumbs[direction];\n    if (this._shouldThumbBeDisabled(direction)) {\n      return;\n    }\n\n    let cropBox = this.$['*cropBox'];\n    let { x: svgX, y: svgY } = this.ref['svg-el'].getBoundingClientRect();\n    let x = e.x - svgX;\n    let y = e.y - svgY;\n\n    this.$.dragging = true;\n    this._draggingThumb = thumb;\n    this._dragStartPoint = [x, y];\n    /** @type {import('./types.js').Rectangle} */\n    this._dragStartCrop = { ...cropBox };\n  }\n\n  _handlePointerUp_(e) {\n    this._updateCursor();\n\n    if (!this.$.dragging) {\n      return;\n    }\n    e.stopPropagation();\n    e.preventDefault();\n\n    this.$.dragging = false;\n  }\n\n  _handlePointerMove_(e) {\n    if (!this.$.dragging) {\n      return;\n    }\n    e.stopPropagation();\n    e.preventDefault();\n\n    let svg = this.ref['svg-el'];\n    let { x: svgX, y: svgY } = svg.getBoundingClientRect();\n    let x = e.x - svgX;\n    let y = e.y - svgY;\n    let dx = x - this._dragStartPoint[0];\n    let dy = y - this._dragStartPoint[1];\n    let { direction } = this._draggingThumb;\n\n    /** @type {import('./types.js').Rectangle} */\n    let imageBox = this.$['*imageBox'];\n    let rect = this._dragStartCrop;\n\n    if (direction === '') {\n      rect = moveRect(rect, [dx, dy]);\n      rect = constraintRect(rect, imageBox);\n    } else {\n      rect = expandRect(rect, [dx, dy], direction);\n      rect = intersectionRect(rect, imageBox);\n    }\n    /** @type {[Number, Number]} */\n    let minCropRect = [Math.min(imageBox.width, MIN_CROP_SIZE), Math.min(imageBox.height, MIN_CROP_SIZE)];\n    rect = minRectSize(rect, minCropRect, direction);\n\n    if (!Object.values(rect).every((number) => Number.isFinite(number) && number >= 0)) {\n      console.error('CropFrame is trying to create invalid rectangle', {\n        payload: rect,\n      });\n      return;\n    }\n    this.$['*cropBox'] = rect;\n  }\n\n  _handleSvgPointerMove_(e) {\n    let hoverThumb = Object.values(this._frameThumbs).find((thumb) => {\n      if (this._shouldThumbBeDisabled(thumb.direction)) {\n        return false;\n      }\n      let node = thumb.groupNode;\n      let bounds = node.getBoundingClientRect();\n      let rect = {\n        x: bounds.x,\n        y: bounds.y,\n        width: bounds.width,\n        height: bounds.height,\n      };\n      let hover = rectContainsPoint(rect, [e.x, e.y]);\n      return hover;\n    });\n\n    this._hoverThumb = hoverThumb;\n    this._updateCursor();\n  }\n\n  _updateCursor() {\n    let hoverThumb = this._hoverThumb;\n    this.ref['svg-el'].style.cursor = hoverThumb ? thumbCursor(hoverThumb.direction) : 'initial';\n  }\n\n  _render() {\n    this._updateBackdrop();\n    this._updateFrame();\n  }\n\n  toggleThumbs(visible) {\n    Object.values(this._frameThumbs)\n      .map(({ groupNode }) => groupNode)\n      .forEach((groupNode) => {\n        groupNode.setAttribute(\n          'class',\n          classNames('thumb', {\n            'thumb--hidden': !visible,\n            'thumb--visible': visible,\n          })\n        );\n      });\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this._createBackdrop();\n    this._createFrame();\n\n    this.sub('*imageBox', () => {\n      this._resizeBackdrop();\n      window.requestAnimationFrame(() => {\n        this._render();\n      });\n    });\n\n    this.sub('*cropBox', (cropBox) => {\n      if (!cropBox) {\n        return;\n      }\n      this._guidesHidden = cropBox.height <= MIN_CROP_SIZE || cropBox.width <= MIN_CROP_SIZE;\n      window.requestAnimationFrame(() => {\n        this._render();\n      });\n    });\n\n    this.sub('dragging', (dragging) => {\n      this._frameGuides.setAttribute(\n        'class',\n        classNames({\n          'guides--hidden': this._guidesHidden,\n          'guides--visible': !this._guidesHidden && dragging,\n          'guides--semi-hidden': !this._guidesHidden && !dragging,\n        })\n      );\n    });\n\n    this.ref['svg-el'].addEventListener('pointermove', this._handleSvgPointerMove, true);\n    document.addEventListener('pointermove', this._handlePointerMove, true);\n    document.addEventListener('pointerup', this._handlePointerUp, true);\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n\n    document.removeEventListener('pointermove', this._handlePointerMove);\n    document.removeEventListener('pointerup', this._handlePointerUp);\n  }\n}\n\nCropFrame.template = /* HTML */ ` <svg class=\"svg\" ref=\"svg-el\" xmlns=\"http://www.w3.org/2000/svg\"></svg> `;\n", "import { Block } from '../../../abstract/Block.js';\nimport { classNames } from './lib/classNames.js';\n\nexport class EditorButtonControl extends Block {\n  init$ = {\n    ...this.ctxInit,\n    active: false,\n    title: '',\n    icon: '',\n    'on.click': null,\n  };\n\n  initCallback() {\n    super.initCallback();\n\n    this._titleEl = this.ref['title-el'];\n    this._iconEl = this.ref['icon-el'];\n\n    this.setAttribute('role', 'button');\n    if (this.tabIndex === -1) {\n      this.tabIndex = 0;\n    }\n\n    this.sub('title', (title) => {\n      let titleEl = this._titleEl;\n      if (titleEl) {\n        this._titleEl.style.display = title ? 'block' : 'none';\n      }\n    });\n\n    this.sub('active', (active) => {\n      this.className = classNames({\n        active: active,\n        not_active: !active,\n      });\n    });\n\n    this.sub('on.click', (onClick) => {\n      this.onclick = onClick;\n    });\n  }\n}\n\nEditorButtonControl.template = /* HTML */ `\n  <div class=\"before\"></div>\n  <lr-icon size=\"20\" set=\"@name: icon;\"></lr-icon>\n  <div class=\"title\" ref=\"title-el\">{{title}}</div>\n`;\n", "import { EditorButtonControl } from './EditorButtonControl.js';\n\nfunction nextAngle(prev) {\n  let angle = prev + 90;\n  angle = angle >= 360 ? 0 : angle;\n  return angle;\n}\n\nfunction nextValue(operation, prev) {\n  if (operation === 'rotate') {\n    return nextAngle(prev);\n  }\n  if (['mirror', 'flip'].includes(operation)) {\n    return !prev;\n  }\n  return null;\n}\n\nexport class EditorCropButtonControl extends EditorButtonControl {\n  initCallback() {\n    super.initCallback();\n\n    this.defineAccessor('operation', (operation) => {\n      if (!operation) {\n        return;\n      }\n\n      /** @private */\n      this._operation = operation;\n      this.$['icon'] = operation;\n    });\n\n    this.$['on.click'] = (e) => {\n      let prev = this.$['*cropperEl'].getValue(this._operation);\n      let next = nextValue(this._operation, prev);\n      this.$['*cropperEl'].setValue(this._operation, next);\n    };\n  }\n}\n", "import { Block } from '../../../abstract/Block.js';\nimport { COLOR_OPERATIONS_CONFIG } from './toolbar-constants.js';\n\nconst ControlType = {\n  FILTER: 'filter',\n  COLOR_OPERATION: 'color_operation',\n};\n\nexport const FAKE_ORIGINAL_FILTER = 'original';\n\nexport class EditorSlider extends Block {\n  init$ = {\n    ...this.ctxInit,\n    disabled: false,\n    min: 0,\n    max: 100,\n    value: 0,\n    defaultValue: 0,\n    zero: 0,\n    'on.input': (value) => {\n      this.$['*faderEl'].set(value);\n      this.$.value = value;\n    },\n  };\n\n  /**\n   * @param {String} operation\n   * @param {String} [filter]\n   */\n  setOperation(operation, filter) {\n    this._controlType = operation === 'filter' ? ControlType.FILTER : ControlType.COLOR_OPERATION;\n    this._operation = operation;\n    this._iconName = operation;\n    this._title = operation.toUpperCase();\n    this._filter = filter;\n\n    this._initializeValues();\n\n    this.$['*faderEl'].activate({\n      url: this.$['*originalUrl'],\n      operation: this._operation,\n      value: this._filter === FAKE_ORIGINAL_FILTER ? undefined : this.$.value,\n      filter: this._filter === FAKE_ORIGINAL_FILTER ? undefined : this._filter,\n      fromViewer: false,\n    });\n  }\n\n  /** @private */\n  _initializeValues() {\n    let { range, zero } = COLOR_OPERATIONS_CONFIG[this._operation];\n    let [min, max] = range;\n\n    this.$.min = min;\n    this.$.max = max;\n    this.$.zero = zero;\n\n    let transformation = this.$['*editorTransformations'][this._operation];\n    if (this._controlType === ControlType.FILTER) {\n      let value = max;\n      if (transformation) {\n        let { name, amount } = transformation;\n        value = name === this._filter ? amount : max;\n      }\n      this.$.value = value;\n      this.$.defaultValue = value;\n    }\n    if (this._controlType === ControlType.COLOR_OPERATION) {\n      let value = typeof transformation !== 'undefined' ? transformation : zero;\n      this.$.value = value;\n      this.$.defaultValue = value;\n    }\n  }\n\n  apply() {\n    let operationValue;\n    if (this._controlType === ControlType.FILTER) {\n      if (this._filter === FAKE_ORIGINAL_FILTER) {\n        operationValue = null;\n      } else {\n        operationValue = { name: this._filter, amount: this.$.value };\n      }\n    } else {\n      operationValue = this.$.value;\n    }\n\n    /** @type {import('./types.js').Transformations} */\n    let transformations = {\n      ...this.$['*editorTransformations'],\n      [this._operation]: operationValue,\n    };\n\n    this.$['*editorTransformations'] = transformations;\n  }\n\n  cancel() {\n    this.$['*faderEl'].deactivate({ hide: false });\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.sub('*originalUrl', (originalUrl) => {\n      this._originalUrl = originalUrl;\n    });\n\n    this.sub('value', (value) => {\n      let tooltip = `${this._filter || this._operation} ${value}`;\n      this.$['*operationTooltip'] = tooltip;\n    });\n  }\n}\n\nEditorSlider.template = /* HTML */ `\n  <lr-slider-ui\n    ref=\"slider-el\"\n    set=\"disabled: disabled; min: min; max: max; defaultValue: defaultValue; zero: zero; onInput: on.input;\"\n  ></lr-slider-ui>\n`;\n", "import { TRANSPARENT_PIXEL_SRC } from '../../../../utils/transparentPixelSrc.js';\n\nexport function preloadImage(src) {\n  let image = new Image();\n\n  let promise = new Promise((resolve, reject) => {\n    image.src = src;\n    image.onload = resolve;\n    image.onerror = reject;\n  });\n\n  let cancel = () => {\n    if (image.naturalWidth === 0) {\n      image.src = TRANSPARENT_PIXEL_SRC;\n    }\n  };\n\n  return { promise, image, cancel };\n}\n\nexport function batchPreloadImages(list) {\n  let preloaders = [];\n\n  for (let src of list) {\n    let preload = preloadImage(src);\n    preloaders.push(preload);\n  }\n\n  let images = preloaders.map((preload) => preload.image);\n  let promise = Promise.allSettled(preloaders.map((preload) => preload.promise));\n  let cancel = () => {\n    preloaders.forEach((preload) => {\n      preload.cancel();\n    });\n  };\n\n  return { promise, images, cancel };\n}\n", "import { createCdnUrl, createCdnUrlModifiers } from '../../../utils/cdn-utils.js';\nimport { EditorButtonControl } from './EditorButtonControl.js';\nimport { FAKE_ORIGINAL_FILTER } from './EditorSlider.js';\nimport { COMMON_OPERATIONS, transformationsToOperations } from './lib/transformationUtils.js';\nimport { preloadImage } from './lib/preloadImage.js';\n\nexport class EditorFilterControl extends EditorButtonControl {\n  init$ = {\n    ...this.ctxInit,\n    active: false,\n    title: '',\n    icon: '',\n    isOriginal: false,\n    iconSize: '20',\n    'on.click': null,\n  };\n\n  _previewSrc() {\n    let previewSize = parseInt(window.getComputedStyle(this).getPropertyValue('--l-base-min-width'), 10);\n    let dpr = window.devicePixelRatio;\n    let size = Math.ceil(dpr * previewSize);\n    let quality = dpr >= 2 ? 'lightest' : 'normal';\n    let filterValue = 100;\n\n    /** @type {import('./types.js').Transformations} */\n    let transformations = { ...this.$['*editorTransformations'] };\n    transformations[this._operation] =\n      this._filter !== FAKE_ORIGINAL_FILTER\n        ? {\n            name: this._filter,\n            amount: filterValue,\n          }\n        : undefined;\n\n    return createCdnUrl(\n      this._originalUrl,\n      createCdnUrlModifiers(\n        COMMON_OPERATIONS,\n        transformationsToOperations(transformations),\n        `quality/${quality}`,\n        `scale_crop/${size}x${size}/center`\n      )\n    );\n  }\n\n  /**\n   * @param {IntersectionObserverEntry[]} entries\n   * @param {IntersectionObserver} observer\n   */\n  _observerCallback(entries, observer) {\n    let intersectionEntry = entries[0];\n    if (intersectionEntry.isIntersecting) {\n      let src = this.proxyUrl(this._previewSrc());\n      let previewEl = this.ref['preview-el'];\n      let { promise, cancel } = preloadImage(src);\n      this._cancelPreload = cancel;\n      promise\n        .catch((err) => {\n          this.$['*networkProblems'] = true;\n          console.error('Failed to load image', { error: err });\n        })\n        .finally(() => {\n          previewEl.style.backgroundImage = `url(${src})`;\n          previewEl.setAttribute('loaded', '');\n\n          observer.unobserve(this);\n        });\n    } else {\n      this._cancelPreload && this._cancelPreload();\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.$['on.click'] = (e) => {\n      if (!this.$.active) {\n        this.$['*sliderEl'].setOperation(this._operation, this._filter);\n        this.$['*sliderEl'].apply();\n      } else if (!this.$.isOriginal) {\n        this.$['*sliderEl'].setOperation(this._operation, this._filter);\n        this.$['*showSlider'] = true;\n      }\n\n      this.$['*currentFilter'] = this._filter;\n    };\n\n    this.defineAccessor('filter', (filter) => {\n      this._operation = 'filter';\n      this._filter = filter;\n      this.$.isOriginal = filter === FAKE_ORIGINAL_FILTER;\n      this.$.icon = this.$.isOriginal ? 'original' : 'slider';\n    });\n\n    this._observer = new window.IntersectionObserver(this._observerCallback.bind(this), {\n      threshold: [0, 1],\n    });\n\n    let originalUrl = this.$['*originalUrl'];\n    this._originalUrl = originalUrl;\n\n    if (this.$.isOriginal) {\n      this.ref['icon-el'].classList.add('original-icon');\n    } else {\n      this._observer.observe(this);\n    }\n\n    this.sub('*currentFilter', (currentFilter) => {\n      this.$.active = currentFilter && currentFilter === this._filter;\n    });\n\n    this.sub('isOriginal', (isOriginal) => {\n      this.$.iconSize = isOriginal ? 40 : 20;\n    });\n\n    this.sub('active', (active) => {\n      if (this.$.isOriginal) {\n        return;\n      }\n      let iconEl = this.ref['icon-el'];\n      iconEl.style.opacity = active ? '1' : '0';\n\n      let previewEl = this.ref['preview-el'];\n      if (active) {\n        previewEl.style.opacity = '0';\n      } else if (previewEl.style.backgroundImage) {\n        previewEl.style.opacity = '1';\n      }\n    });\n\n    this.sub('*networkProblems', (networkProblems) => {\n      if (!networkProblems) {\n        let src = this.proxyUrl(this._previewSrc());\n        let previewEl = this.ref['preview-el'];\n        if (previewEl.style.backgroundImage) {\n          previewEl.style.backgroundImage = 'none';\n          previewEl.style.backgroundImage = `url(${src})`;\n        }\n      }\n    });\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    this._observer?.disconnect();\n    this._cancelPreload && this._cancelPreload();\n  }\n}\n\nEditorFilterControl.template = /* HTML */ `\n  <div class=\"before\"></div>\n  <div class=\"preview\" ref=\"preview-el\"></div>\n  <lr-icon size=\"40\" ref=\"icon-el\" set=\"@name: icon; @size: iconSize;\"></lr-icon>\n`;\n", "import { EditorButtonControl } from './EditorButtonControl.js';\nimport { COLOR_OPERATIONS_CONFIG } from './toolbar-constants.js';\n\nexport class EditorOperationControl extends EditorButtonControl {\n  /**\n   * @private\n   * @type {String}\n   */\n  _operation = '';\n\n  initCallback() {\n    super.initCallback();\n\n    this.$['on.click'] = (e) => {\n      this.$['*sliderEl'].setOperation(this._operation);\n      this.$['*showSlider'] = true;\n      this.$['*currentOperation'] = this._operation;\n    };\n\n    this.defineAccessor('operation', (operation) => {\n      if (operation) {\n        this._operation = operation;\n        this.$['icon'] = operation;\n        this.$.title = this.l10n(operation);\n      }\n    });\n\n    this.sub('*editorTransformations', (editorTransformations) => {\n      if (!this._operation) {\n        return;\n      }\n\n      let { zero } = COLOR_OPERATIONS_CONFIG[this._operation];\n      let value = editorTransformations[this._operation];\n      let isActive = typeof value !== 'undefined' ? value !== zero : false;\n      this.$.active = isActive;\n    });\n  }\n}\n", "/**\n * @param {{}} obj\n * @param {String[]} keys\n * @returns {{}}\n */\nexport function pick(obj, keys) {\n  let result = {};\n  for (let key of keys) {\n    let value = obj[key];\n    if (obj.hasOwnProperty(key) || value !== undefined) {\n      result[key] = value;\n    }\n  }\n  return result;\n}\n", "import { createCdnUrl, createCdnUrlModifiers } from '../../../utils/cdn-utils.js';\nimport { COMMON_OPERATIONS, transformationsToOperations } from './lib/transformationUtils.js';\n\nexport function viewerImageSrc(originalUrl, width, transformations) {\n  const MAX_CDN_DIMENSION = 3000;\n  let dpr = window.devicePixelRatio;\n  let size = Math.min(Math.ceil(width * dpr), MAX_CDN_DIMENSION);\n  let quality = dpr >= 2 ? 'lightest' : 'normal';\n\n  return createCdnUrl(\n    originalUrl,\n    createCdnUrlModifiers(\n      COMMON_OPERATIONS,\n      transformationsToOperations(transformations),\n      `quality/${quality}`,\n      `stretch/off/-/resize/${size}x`\n    )\n  );\n}\n", "import { Block } from '../../../abstract/Block.js';\nimport { constraintRect, minRectSize } from './crop-utils.js';\nimport { CROP_PADDING, MIN_CROP_SIZE } from './cropper-constants.js';\nimport { classNames } from './lib/classNames.js';\nimport { debounce } from './lib/debounce.js';\nimport { pick } from './lib/pick.js';\nimport { preloadImage } from './lib/preloadImage.js';\nimport { viewerImageSrc } from './util.js';\n\n/**\n * @typedef {Object} Operations\n * @property {boolean} flip\n * @property {boolean} mirror\n * @property {Number} rotate\n */\n\n/**\n * @param {Number} value\n * @param {Number} min\n * @param {Number} max\n * @returns {Number}\n */\nfunction clamp(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\n/**\n * @param {import('./types.js').ImageSize} imageSize\n * @param {Number} angle\n * @returns {import('./types.js').ImageSize}\n */\nfunction rotateSize({ width, height }, angle) {\n  let swap = (angle / 90) % 2 !== 0;\n  return { width: swap ? height : width, height: swap ? width : height };\n}\n\n/**\n * @param {import('./types.js').Transformations['crop']} crop\n * @returns {boolean}\n */\nfunction validateCrop(crop) {\n  if (!crop) {\n    return true;\n  }\n  /** @type {((arg: typeof crop) => boolean)[]} */\n  let shouldMatch = [\n    ({ dimensions, coords }) =>\n      [...dimensions, ...coords].every((number) => Number.isInteger(number) && Number.isFinite(number)),\n    ({ dimensions, coords }) => dimensions.every((d) => d > 0) && coords.every((c) => c >= 0),\n  ];\n  return shouldMatch.every((matcher) => matcher(crop));\n}\n\nexport class EditorImageCropper extends Block {\n  init$ = {\n    ...this.ctxInit,\n    image: null,\n    '*padding': CROP_PADDING,\n    /** @type {Operations} */\n    '*operations': {\n      rotate: 0,\n      mirror: false,\n      flip: false,\n    },\n    /** @type {import('./types.js').Rectangle} */\n    '*imageBox': {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0,\n    },\n    /** @type {import('./types.js').Rectangle} */\n    '*cropBox': {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0,\n    },\n  };\n\n  constructor() {\n    super();\n\n    /** @private */\n    this._commitDebounced = debounce(this._commit.bind(this), 300);\n\n    /** @private */\n    this._handleResizeDebounced = debounce(this._handleResize.bind(this), 10);\n  }\n\n  /** @private */\n  _handleResize() {\n    if (!this.isConnected) {\n      return;\n    }\n    this.deactivate();\n    this.activate(this._imageSize, { fromViewer: false });\n  }\n\n  /** @private */\n  _syncTransformations() {\n    let transformations = this.$['*editorTransformations'];\n    let pickedTransformations = pick(transformations, Object.keys(this.$['*operations']));\n    let operations = { ...this.$['*operations'], ...pickedTransformations };\n    this.$['*operations'] = operations;\n  }\n\n  /** @private */\n  _initCanvas() {\n    /** @type {HTMLCanvasElement} */\n    let canvas = this.ref['canvas-el'];\n    let ctx = canvas.getContext('2d');\n\n    let width = this.offsetWidth;\n    let height = this.offsetHeight;\n    let dpr = window.devicePixelRatio;\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n    canvas.width = width * dpr;\n    canvas.height = height * dpr;\n    ctx.scale(dpr, dpr);\n\n    this._canvas = canvas;\n    this._ctx = ctx;\n  }\n\n  /** @private */\n  _alignImage() {\n    if (!this._isActive || !this.$.image) {\n      return;\n    }\n\n    let image = this.$.image;\n    let padding = this.$['*padding'];\n    let operations = this.$['*operations'];\n    let { rotate } = operations;\n\n    let bounds = { width: this.offsetWidth, height: this.offsetHeight };\n    let naturalSize = rotateSize({ width: image.naturalWidth, height: image.naturalHeight }, rotate);\n\n    if (naturalSize.width > bounds.width - padding * 2 || naturalSize.height > bounds.height - padding * 2) {\n      let imageAspectRatio = naturalSize.width / naturalSize.height;\n      let viewportAspectRatio = bounds.width / bounds.height;\n\n      if (imageAspectRatio > viewportAspectRatio) {\n        let width = bounds.width - padding * 2;\n        let height = width / imageAspectRatio;\n        let x = 0 + padding;\n        let y = padding + (bounds.height - padding * 2) / 2 - height / 2;\n        this.$['*imageBox'] = { x, y, width, height };\n      } else {\n        let height = bounds.height - padding * 2;\n        let width = height * imageAspectRatio;\n        let x = padding + (bounds.width - padding * 2) / 2 - width / 2;\n        let y = 0 + padding;\n        this.$['*imageBox'] = { x, y, width, height };\n      }\n    } else {\n      let { width, height } = naturalSize;\n      let x = padding + (bounds.width - padding * 2) / 2 - width / 2;\n      let y = padding + (bounds.height - padding * 2) / 2 - height / 2;\n      this.$['*imageBox'] = { x, y, width, height };\n    }\n  }\n\n  /** @private */\n  _alignCrop() {\n    let cropBox = this.$['*cropBox'];\n    let imageBox = this.$['*imageBox'];\n    let operations = this.$['*operations'];\n    let { rotate } = operations;\n    let transformation = this.$['*editorTransformations']['crop'];\n\n    if (transformation) {\n      let {\n        dimensions: [width, height],\n        coords: [x, y],\n      } = transformation;\n      let { width: previewWidth, x: previewX, y: previewY } = this.$['*imageBox'];\n      let { width: sourceWidth } = rotateSize(this._imageSize, rotate);\n      let ratio = previewWidth / sourceWidth;\n      cropBox = {\n        x: previewX + x * ratio,\n        y: previewY + y * ratio,\n        width: width * ratio,\n        height: height * ratio,\n      };\n    } else {\n      cropBox = {\n        x: imageBox.x,\n        y: imageBox.y,\n        width: imageBox.width,\n        height: imageBox.height,\n      };\n    }\n    /** @type {[Number, Number]} */\n    let minCropRect = [Math.min(imageBox.width, MIN_CROP_SIZE), Math.min(imageBox.height, MIN_CROP_SIZE)];\n    cropBox = minRectSize(cropBox, minCropRect, 'se');\n    cropBox = constraintRect(cropBox, imageBox);\n\n    this.$['*cropBox'] = cropBox;\n  }\n\n  /** @private */\n  _drawImage() {\n    let image = this.$.image;\n    let imageBox = this.$['*imageBox'];\n    let operations = this.$['*operations'];\n    let { mirror, flip, rotate } = operations;\n    let ctx = this._ctx;\n    let rotated = rotateSize({ width: imageBox.width, height: imageBox.height }, rotate);\n    ctx.save();\n    ctx.translate(imageBox.x + imageBox.width / 2, imageBox.y + imageBox.height / 2);\n    ctx.rotate((rotate * Math.PI * -1) / 180);\n    ctx.scale(mirror ? -1 : 1, flip ? -1 : 1);\n    ctx.drawImage(image, -rotated.width / 2, -rotated.height / 2, rotated.width, rotated.height);\n    ctx.restore();\n  }\n\n  /** @private */\n  _draw() {\n    if (!this._isActive || !this.$.image) {\n      return;\n    }\n    let canvas = this._canvas;\n    let ctx = this._ctx;\n\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    this._drawImage();\n  }\n\n  /** @private */\n  _animateIn({ fromViewer }) {\n    if (this.$.image) {\n      this.ref['frame-el'].toggleThumbs(true);\n      this._transitionToImage();\n      setTimeout(() => {\n        this.className = classNames({\n          active_from_viewer: fromViewer,\n          active_from_editor: !fromViewer,\n          inactive_to_editor: false,\n        });\n      });\n    }\n  }\n\n  /**\n   * @private\n   * @returns {import('./types.js').Transformations['crop']['dimensions']}\n   */\n  _calculateDimensions() {\n    let cropBox = this.$['*cropBox'];\n    let imageBox = this.$['*imageBox'];\n    let operations = this.$['*operations'];\n    let { rotate } = operations;\n    let { width: previewWidth, height: previewHeight } = imageBox;\n    let { width: sourceWidth, height: sourceHeight } = rotateSize(this._imageSize, rotate);\n    let { width: cropWidth, height: cropHeight } = cropBox;\n    let ratioW = previewWidth / sourceWidth;\n    let ratioH = previewHeight / sourceHeight;\n\n    /** @type {[Number, Number]} */\n    let dimensions = [\n      clamp(Math.round(cropWidth / ratioW), 1, sourceWidth),\n      clamp(Math.round(cropHeight / ratioH), 1, sourceHeight),\n    ];\n\n    return dimensions;\n  }\n\n  /**\n   * @private\n   * @returns {import('./types.js').Transformations['crop']}\n   */\n  _calculateCrop() {\n    let cropBox = this.$['*cropBox'];\n    let imageBox = this.$['*imageBox'];\n    let operations = this.$['*operations'];\n    let { rotate } = operations;\n    let { width: previewWidth, height: previewHeight, x: previewX, y: previewY } = imageBox;\n    let { width: sourceWidth, height: sourceHeight } = rotateSize(this._imageSize, rotate);\n    let { x: cropX, y: cropY } = cropBox;\n    let ratioW = previewWidth / sourceWidth;\n    let ratioH = previewHeight / sourceHeight;\n\n    let dimensions = this._calculateDimensions();\n    let crop = {\n      dimensions,\n      coords: /** @type {[Number, Number]} */ ([\n        clamp(Math.round((cropX - previewX) / ratioW), 0, sourceWidth - dimensions[0]),\n        clamp(Math.round((cropY - previewY) / ratioH), 0, sourceHeight - dimensions[1]),\n      ]),\n    };\n    if (!validateCrop(crop)) {\n      console.error('Cropper is trying to create invalid crop object', {\n        payload: crop,\n      });\n      return undefined;\n    }\n    if (dimensions[0] === sourceWidth && dimensions[1] === sourceHeight) {\n      return undefined;\n    }\n\n    return crop;\n  }\n\n  /** @private */\n  _commit() {\n    if (!this.isConnected) {\n      return;\n    }\n    let operations = this.$['*operations'];\n    let { rotate, mirror, flip } = operations;\n    let crop = this._calculateCrop();\n    /** @type {import('./types.js').Transformations} */\n    let editorTransformations = this.$['*editorTransformations'];\n    let transformations = {\n      ...editorTransformations,\n      crop,\n      rotate,\n      mirror,\n      flip,\n    };\n\n    this.$['*editorTransformations'] = transformations;\n  }\n\n  /**\n   * @param {String} operation\n   * @param {Number} value\n   * @returns {void}\n   */\n  setValue(operation, value) {\n    console.log(`Apply cropper operation [${operation}=${value}]`);\n    this.$['*operations'] = {\n      ...this.$['*operations'],\n      [operation]: value,\n    };\n\n    if (!this._isActive) {\n      return;\n    }\n\n    this._alignImage();\n    this._alignCrop();\n    this._draw();\n  }\n\n  /**\n   * @param {keyof Operations} operation\n   * @returns {Number | boolean}\n   */\n  getValue(operation) {\n    return this.$['*operations'][operation];\n  }\n\n  /**\n   * @param {import('./types.js').ImageSize} imageSize\n   * @param {{ fromViewer?: boolean }} options\n   */\n  async activate(imageSize, { fromViewer }) {\n    if (this._isActive) {\n      return;\n    }\n    this._isActive = true;\n    this._imageSize = imageSize;\n    this.removeEventListener('transitionend', this._reset);\n    this._initCanvas();\n\n    try {\n      this.$.image = await this._waitForImage(this.$['*originalUrl'], this.$['*editorTransformations']);\n      this._syncTransformations();\n      this._alignImage();\n      this._alignCrop();\n      this._draw();\n      this._animateIn({ fromViewer });\n    } catch (err) {\n      console.error('Failed to activate cropper', { error: err });\n    }\n  }\n  deactivate() {\n    if (!this._isActive) {\n      return;\n    }\n    this._commit();\n    this._isActive = false;\n\n    this._transitionToCrop();\n\n    this.className = classNames({\n      active_from_viewer: false,\n      active_from_editor: false,\n      inactive_to_editor: true,\n    });\n\n    this.ref['frame-el'].toggleThumbs(false);\n    this.addEventListener('transitionend', this._reset, { once: true });\n  }\n\n  /** @private */\n  _transitionToCrop() {\n    let dimensions = this._calculateDimensions();\n    let scaleX = Math.min(this.offsetWidth, dimensions[0]) / this.$['*cropBox'].width;\n    let scaleY = Math.min(this.offsetHeight, dimensions[1]) / this.$['*cropBox'].height;\n    let scale = Math.min(scaleX, scaleY);\n    let cropCenterX = this.$['*cropBox'].x + this.$['*cropBox'].width / 2;\n    let cropCenterY = this.$['*cropBox'].y + this.$['*cropBox'].height / 2;\n\n    this.style.transform = `scale(${scale}) translate(${(this.offsetWidth / 2 - cropCenterX) / scale}px, ${\n      (this.offsetHeight / 2 - cropCenterY) / scale\n    }px)`;\n    this.style.transformOrigin = `${cropCenterX}px ${cropCenterY}px`;\n  }\n\n  /** @private */\n  _transitionToImage() {\n    let cropCenterX = this.$['*cropBox'].x + this.$['*cropBox'].width / 2;\n    let cropCenterY = this.$['*cropBox'].y + this.$['*cropBox'].height / 2;\n\n    this.style.transform = `scale(1)`;\n    this.style.transformOrigin = `${cropCenterX}px ${cropCenterY}px`;\n  }\n\n  /** @private */\n  _reset() {\n    if (this._isActive) {\n      return;\n    }\n    this.$.image = null;\n  }\n\n  /**\n   * @private\n   * @param {String} originalUrl\n   * @param {import('./types.js').Transformations} transformations\n   * @returns {Promise<HTMLImageElement>}\n   */\n  _waitForImage(originalUrl, transformations) {\n    let width = this.offsetWidth;\n    transformations = {\n      ...transformations,\n      crop: undefined,\n      rotate: undefined,\n      flip: undefined,\n      mirror: undefined,\n    };\n    let src = this.proxyUrl(viewerImageSrc(originalUrl, width, transformations));\n    let { promise, cancel, image } = preloadImage(src);\n\n    let stop = this._handleImageLoading(src);\n    image.addEventListener('load', stop, { once: true });\n    image.addEventListener('error', stop, { once: true });\n    this._cancelPreload && this._cancelPreload();\n    this._cancelPreload = cancel;\n\n    return promise\n      .then(() => image)\n      .catch((err) => {\n        console.error('Failed to load image', { error: err });\n        this.$['*networkProblems'] = true;\n        return Promise.resolve(image);\n      });\n  }\n\n  /**\n   * @private\n   * @param {String} src\n   * @returns {() => void} Destructor\n   */\n  _handleImageLoading(src) {\n    let operation = 'crop';\n    let loadingOperations = this.$['*loadingOperations'];\n    if (!loadingOperations.get(operation)) {\n      loadingOperations.set(operation, new Map());\n    }\n\n    if (!loadingOperations.get(operation).get(src)) {\n      loadingOperations.set(operation, loadingOperations.get(operation).set(src, true));\n      this.$['*loadingOperations'] = loadingOperations;\n    }\n\n    return () => {\n      if (loadingOperations?.get(operation)?.has(src)) {\n        loadingOperations.get(operation).delete(src);\n        this.$['*loadingOperations'] = loadingOperations;\n      }\n    };\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this._observer = new ResizeObserver(([entry]) => {\n      const nonZeroSize = entry.contentRect.width > 0 && entry.contentRect.height > 0;\n      if (nonZeroSize && this._isActive && this.$.image) {\n        this._handleResizeDebounced();\n      }\n    });\n    this._observer.observe(this);\n\n    this.sub('*imageBox', () => {\n      this._draw();\n    });\n\n    this.sub('*cropBox', (cropBox) => {\n      if (this.$.image) {\n        this._commitDebounced();\n      }\n    });\n\n    setTimeout(() => {\n      this.sub('*networkProblems', (networkProblems) => {\n        if (!networkProblems) {\n          this._isActive && this.activate(this._imageSize, { fromViewer: false });\n        }\n      });\n    }, 0);\n  }\n\n  destroyCallback() {\n    super.destroyCallback();\n    this._observer?.disconnect();\n  }\n}\n\nEditorImageCropper.template = /* HTML */ `\n  <canvas class=\"canvas\" ref=\"canvas-el\"></canvas>\n  <lr-crop-frame ref=\"frame-el\"></lr-crop-frame>\n`;\n", "/**\n * @param {Number} a Start of sample (int)\n * @param {Number} b End of sample (int)\n * @param {Number} n Number of elements (int)\n * @returns {Number[]}\n */\nexport function linspace(a, b, n) {\n  let ret = Array(n);\n  n--;\n  for (let i = n; i >= 0; i--) {\n    ret[i] = Math.ceil((i * b + (n - i) * a) / n);\n  }\n  return ret;\n}\n", "import { Block } from '../../../abstract/Block.js';\nimport { classNames } from './lib/classNames.js';\nimport { debounce } from './lib/debounce.js';\nimport { linspace } from './lib/linspace.js';\nimport { batchPreloadImages } from './lib/preloadImage.js';\nimport { COLOR_OPERATIONS_CONFIG } from './toolbar-constants.js';\nimport { viewerImageSrc } from './util.js';\n\n/**\n * @param {Number[]} numbers\n * @returns {[Number, Number][]}\n */\nfunction splitBySections(numbers) {\n  return numbers.reduce(\n    (acc, point, idx) => (idx < numbers.length - 1 ? [...acc, [point, numbers[idx + 1]]] : acc),\n    []\n  );\n}\n\n/**\n * @param {Number[]} keypoints\n * @param {Number} value\n * @param {Number} zero\n */\nfunction calculateOpacities(keypoints, value, zero) {\n  let section = splitBySections(keypoints).find(([left, right]) => left <= value && value <= right);\n  return keypoints.map((point) => {\n    let distance = Math.abs(section[0] - section[1]);\n    let relation = Math.abs(value - section[0]) / distance;\n\n    if (section[0] === point) {\n      return value > zero ? 1 : 1 - relation;\n    }\n    if (section[1] === point) {\n      return value >= zero ? relation : 1;\n    }\n    return 0;\n  });\n}\n\n/**\n * @param {Number[]} keypoints\n * @param {Number} zero\n */\nfunction calculateZIndices(keypoints, zero) {\n  return keypoints.map((point, idx) => (point < zero ? keypoints.length - idx : idx));\n}\n\n/**\n * @param {String} operation\n * @param {Number} value\n * @returns {Number[]}\n */\nfunction keypointsRange(operation, value) {\n  let n = COLOR_OPERATIONS_CONFIG[operation].keypointsNumber;\n  let { range, zero } = COLOR_OPERATIONS_CONFIG[operation];\n\n  return [...new Set([...linspace(range[0], zero, n + 1), ...linspace(zero, range[1], n + 1), zero, value])].sort(\n    (a, b) => a - b\n  );\n}\n\n/**\n * @typedef {Object} Keypoint\n * @property {String} src\n * @property {Number} opacity\n * @property {Number} zIndex\n * @property {HTMLImageElement} image\n * @property {Number} value\n */\n\nexport class EditorImageFader extends Block {\n  constructor() {\n    super();\n\n    /**\n     * @private\n     * @type {Boolean}\n     */\n    this._isActive = false;\n\n    /**\n     * @private\n     * @type {Boolean}\n     */\n    this._hidden = true;\n\n    /** @private */\n    this._addKeypointDebounced = debounce(this._addKeypoint.bind(this), 600);\n\n    this.classList.add('inactive_to_cropper');\n  }\n\n  /**\n   * @private\n   * @param {String} src\n   * @returns {() => void} Destructor\n   */\n  _handleImageLoading(src) {\n    let operation = this._operation;\n\n    let loadingOperations = this.$['*loadingOperations'];\n    if (!loadingOperations.get(operation)) {\n      loadingOperations.set(operation, new Map());\n    }\n\n    if (!loadingOperations.get(operation).get(src)) {\n      loadingOperations.set(operation, loadingOperations.get(operation).set(src, true));\n      this.$['*loadingOperations'] = loadingOperations;\n    }\n\n    return () => {\n      if (loadingOperations?.get(operation)?.has(src)) {\n        loadingOperations.get(operation).delete(src);\n        this.$['*loadingOperations'] = loadingOperations;\n      }\n    };\n  }\n\n  /** @private */\n  _flush() {\n    window.cancelAnimationFrame(this._raf);\n    this._raf = window.requestAnimationFrame(() => {\n      for (let kp of this._keypoints) {\n        let { image } = kp;\n        if (image) {\n          image.style.opacity = kp.opacity.toString();\n          image.style.zIndex = kp.zIndex.toString();\n        }\n      }\n    });\n  }\n\n  /**\n   * @private\n   * @param {Object} options\n   * @param {String} [options.url]\n   * @param {String} [options.filter]\n   * @param {String} [options.operation]\n   * @param {Number} [options.value]\n   * @returns {String}\n   */\n  _imageSrc({ url = this._url, filter = this._filter, operation, value } = {}) {\n    let transformations = { ...this._transformations };\n\n    if (operation) {\n      transformations[operation] = filter ? { name: filter, amount: value } : value;\n    }\n\n    // do not use getBoundingClientRect because scale transform affects it\n    let width = this.offsetWidth;\n    return this.proxyUrl(viewerImageSrc(url, width, transformations));\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   * @param {Number} value\n   * @returns {Keypoint}\n   */\n  _constructKeypoint(operation, value) {\n    let src = this._imageSrc({ operation, value });\n    return {\n      src,\n      image: null,\n      opacity: 0,\n      zIndex: 0,\n      value,\n    };\n  }\n\n  /**\n   * Check if current operation and filter equals passed ones\n   *\n   * @private\n   * @param {String} operation\n   * @param {String} [filter]\n   * @returns {Boolean}\n   */\n  _isSame(operation, filter) {\n    return this._operation === operation && this._filter === filter;\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   * @param {String | null} filter\n   * @param {Number} value\n   */\n  _addKeypoint(operation, filter, value) {\n    let shouldSkip = () =>\n      !this._isSame(operation, filter) || this._value !== value || !!this._keypoints.find((kp) => kp.value === value);\n\n    if (shouldSkip()) {\n      return;\n    }\n    let keypoint = this._constructKeypoint(operation, value);\n    let image = new Image();\n    image.src = keypoint.src;\n    let stop = this._handleImageLoading(keypoint.src);\n    image.addEventListener('load', stop, { once: true });\n    image.addEventListener('error', stop, { once: true });\n    keypoint.image = image;\n    image.classList.add('fader-image');\n\n    image.addEventListener(\n      'load',\n      () => {\n        if (shouldSkip()) {\n          return;\n        }\n        let keypoints = this._keypoints;\n        let idx = keypoints.findIndex((kp) => kp.value > value);\n        let insertBeforeNode = idx < keypoints.length ? keypoints[idx].image : null;\n        if (!this._container || (insertBeforeNode && !this._container.contains(insertBeforeNode))) {\n          return;\n        }\n        keypoints.splice(idx, 0, keypoint);\n        this._container.insertBefore(image, insertBeforeNode);\n        this._update(operation, value);\n      },\n      { once: true }\n    );\n\n    image.addEventListener(\n      'error',\n      () => {\n        this.$['*networkProblems'] = true;\n      },\n      { once: true }\n    );\n  }\n\n  /** @param {String | Number} value */\n  set(value) {\n    value = typeof value === 'string' ? parseInt(value, 10) : value;\n    this._update(this._operation, value);\n    this._addKeypointDebounced(this._operation, this._filter, value);\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   * @param {Number} value\n   */\n  _update(operation, value) {\n    this._operation = operation;\n    this._value = value;\n\n    let { zero } = COLOR_OPERATIONS_CONFIG[operation];\n\n    let keypointValues = this._keypoints.map((kp) => kp.value);\n    let opacities = calculateOpacities(keypointValues, value, zero);\n    let zIndices = calculateZIndices(keypointValues, zero);\n\n    for (let [idx, kp] of Object.entries(this._keypoints)) {\n      kp.opacity = opacities[idx];\n      kp.zIndex = zIndices[idx];\n    }\n\n    this._flush();\n  }\n\n  /** @private */\n  _createPreviewImage() {\n    let image = new Image();\n    image.classList.add('fader-image', 'fader-image--preview');\n    image.style.opacity = '0';\n    return image;\n  }\n\n  /** @private */\n  async _initNodes() {\n    let fr = document.createDocumentFragment();\n    this._previewImage = this._previewImage || this._createPreviewImage();\n    !this.contains(this._previewImage) && fr.appendChild(this._previewImage);\n\n    let container = document.createElement('div');\n    fr.appendChild(container);\n\n    let srcList = this._keypoints.map((kp) => kp.src);\n\n    let { images, promise, cancel } = batchPreloadImages(srcList);\n    images.forEach((node) => {\n      let stop = this._handleImageLoading(node.src);\n      node.addEventListener('load', stop);\n      node.addEventListener('error', stop);\n    });\n    this._cancelLastImages = () => {\n      cancel();\n      this._cancelLastImages = undefined;\n    };\n    let operation = this._operation;\n    let filter = this._filter;\n    await promise;\n    if (this._isActive && this._isSame(operation, filter)) {\n      this._container && this._container.remove();\n      this._container = container;\n      this._keypoints.forEach((kp, idx) => {\n        let kpImage = images[idx];\n        kpImage.classList.add('fader-image');\n        kp.image = kpImage;\n        this._container.appendChild(kpImage);\n      });\n      this.appendChild(fr);\n      this._flush();\n    }\n  }\n\n  /** @param {import('./types.js').Transformations} transformations */\n  setTransformations(transformations) {\n    this._transformations = transformations;\n    if (this._previewImage) {\n      let src = this._imageSrc();\n      let stop = this._handleImageLoading(src);\n      this._previewImage.src = src;\n      this._previewImage.addEventListener('load', stop, { once: true });\n      this._previewImage.addEventListener('error', stop, { once: true });\n      this._previewImage.style.opacity = '1';\n\n      this._previewImage.addEventListener(\n        'error',\n        () => {\n          this.$['*networkProblems'] = true;\n        },\n        { once: true }\n      );\n    }\n  }\n\n  /**\n   * @param {object} options\n   * @param {String} options.url\n   * @param {String} options.operation\n   * @param {Number} options.value\n   * @param {String} [options.filter]\n   */\n  preload({ url, filter, operation, value }) {\n    this._cancelBatchPreload && this._cancelBatchPreload();\n\n    let keypoints = keypointsRange(operation, value);\n    let srcList = keypoints.map((kp) => this._imageSrc({ url, filter, operation, value: kp }));\n    let { cancel } = batchPreloadImages(srcList);\n\n    this._cancelBatchPreload = cancel;\n  }\n\n  /** @private */\n  _setOriginalSrc(src) {\n    let image = this._previewImage || this._createPreviewImage();\n    !this.contains(image) && this.appendChild(image);\n    this._previewImage = image;\n\n    if (image.src === src) {\n      image.style.opacity = '1';\n      image.style.transform = 'scale(1)';\n      this.className = classNames({\n        active_from_viewer: this._fromViewer,\n        active_from_cropper: !this._fromViewer,\n        inactive_to_cropper: false,\n      });\n      return;\n    }\n    image.style.opacity = '0';\n    let stop = this._handleImageLoading(src);\n    image.addEventListener('error', stop, { once: true });\n    image.src = src;\n    image.addEventListener(\n      'load',\n      () => {\n        stop();\n        if (image) {\n          image.style.opacity = '1';\n          image.style.transform = 'scale(1)';\n          this.className = classNames({\n            active_from_viewer: this._fromViewer,\n            active_from_cropper: !this._fromViewer,\n            inactive_to_cropper: false,\n          });\n        }\n      },\n      { once: true }\n    );\n    image.addEventListener(\n      'error',\n      () => {\n        this.$['*networkProblems'] = true;\n      },\n      { once: true }\n    );\n  }\n\n  /**\n   * @param {object} options\n   * @param {String} options.url\n   * @param {String} [options.operation]\n   * @param {Number} [options.value]\n   * @param {String} [options.filter]\n   * @param {Boolean} [options.fromViewer]\n   */\n  activate({ url, operation, value, filter, fromViewer }) {\n    this._isActive = true;\n    this._hidden = false;\n    this._url = url;\n    this._operation = operation || 'initial';\n    this._value = value;\n    this._filter = filter;\n    this._fromViewer = fromViewer;\n\n    let isOriginal = typeof value !== 'number' && !filter;\n    if (isOriginal) {\n      let src = this._imageSrc({ operation, value });\n      this._setOriginalSrc(src);\n      this._container && this._container.remove();\n      return;\n    }\n    this._keypoints = keypointsRange(operation, value).map((keyValue) => this._constructKeypoint(operation, keyValue));\n\n    this._update(operation, value);\n    this._initNodes();\n  }\n\n  /** @param {{ hide?: Boolean }} options */\n  deactivate({ hide = true } = {}) {\n    this._isActive = false;\n\n    this._cancelLastImages && this._cancelLastImages();\n    this._cancelBatchPreload && this._cancelBatchPreload();\n\n    if (hide && !this._hidden) {\n      this._hidden = true;\n      if (this._previewImage) {\n        this._previewImage.style.transform = 'scale(1)';\n      }\n      this.className = classNames({\n        active_from_viewer: false,\n        active_from_cropper: false,\n        inactive_to_cropper: true,\n      });\n      this.addEventListener(\n        'transitionend',\n        () => {\n          this._container && this._container.remove();\n        },\n        { once: true }\n      );\n    } else {\n      this._container && this._container.remove();\n    }\n  }\n}\n", "import { Block } from '../../../abstract/Block.js';\n\nconst X_THRESHOLD = 1;\n\nexport class EditorScroller extends Block {\n  initCallback() {\n    super.initCallback();\n\n    this.addEventListener('wheel', (e) => {\n      e.preventDefault();\n      let { deltaY, deltaX } = e;\n      if (Math.abs(deltaX) > X_THRESHOLD) {\n        this.scrollLeft += deltaX;\n      } else {\n        this.scrollLeft += deltaY;\n      }\n    });\n  }\n}\n\nEditorScroller.template = /* HTML */ ` <slot></slot> `;\n", "import { Block } from '../../../abstract/Block.js';\nimport { EditorCropButtonControl } from './EditorCropButtonControl.js';\nimport { EditorFilterControl } from './EditorFilterControl.js';\nimport { EditorOperationControl } from './EditorOperationControl.js';\nimport { FAKE_ORIGINAL_FILTER } from './EditorSlider.js';\nimport { classNames } from './lib/classNames.js';\nimport { debounce } from './lib/debounce.js';\nimport { batchPreloadImages } from './lib/preloadImage.js';\nimport {\n  ALL_COLOR_OPERATIONS,\n  ALL_CROP_OPERATIONS,\n  ALL_FILTERS,\n  COLOR_OPERATIONS_CONFIG,\n  TabId,\n  TABS,\n} from './toolbar-constants.js';\nimport { viewerImageSrc } from './util.js';\n\n/** @param {String} id */\nfunction renderTabToggle(id) {\n  return /* HTML */ `\n    <lr-btn-ui\n      theme=\"boring\"\n      ref=\"tab-toggle-${id}\"\n      data-id=\"${id}\"\n      icon=\"${id}\"\n      tabindex=\"0\"\n      set=\"onclick: on.clickTab;\"\n    >\n    </lr-btn-ui>\n  `;\n}\n\n/** @param {String} id */\nfunction renderTabContent(id) {\n  return /* HTML */ `\n    <lr-presence-toggle class=\"tab-content\" set=\"visible: presence.tabContent.${id}; styles: presence.tabContentStyles\">\n      <lr-editor-scroller hidden-scrollbar>\n        <div class=\"controls-list_align\">\n          <div class=\"controls-list_inner\" ref=\"controls-list-${id}\"></div>\n        </div>\n      </lr-editor-scroller>\n    </lr-presence-toggle>\n  `;\n}\n\nexport class EditorToolbar extends Block {\n  constructor() {\n    super();\n\n    this.init$ = {\n      ...this.ctxInit,\n      '*sliderEl': null,\n      /** @type {import('./types.js').LoadingOperations} */\n      '*loadingOperations': new Map(),\n      '*showSlider': false,\n      '*currentFilter': FAKE_ORIGINAL_FILTER,\n      '*currentOperation': null,\n      '*tabId': TabId.CROP,\n      showLoader: false,\n      filters: ALL_FILTERS,\n      colorOperations: ALL_COLOR_OPERATIONS,\n      cropOperations: ALL_CROP_OPERATIONS,\n      '*operationTooltip': null,\n\n      'l10n.cancel': this.l10n('cancel'),\n      'l10n.apply': this.l10n('apply'),\n\n      'presence.mainToolbar': true,\n      'presence.subToolbar': false,\n      'presence.tabContent.crop': false,\n      'presence.tabContent.sliders': false,\n      'presence.tabContent.filters': false,\n      'presence.subTopToolbarStyles': {\n        hidden: 'sub-toolbar--top-hidden',\n        visible: 'sub-toolbar--visible',\n      },\n      'presence.subBottomToolbarStyles': {\n        hidden: 'sub-toolbar--bottom-hidden',\n        visible: 'sub-toolbar--visible',\n      },\n      'presence.tabContentStyles': {\n        hidden: 'tab-content--hidden',\n        visible: 'tab-content--visible',\n      },\n      'on.cancel': (e) => {\n        this._cancelPreload && this._cancelPreload();\n        this.$['*on.cancel']();\n      },\n      'on.apply': (e) => {\n        this.$['*on.apply'](this.$['*editorTransformations']);\n      },\n      'on.applySlider': (e) => {\n        this.ref['slider-el'].apply();\n        this._onSliderClose();\n      },\n      'on.cancelSlider': (e) => {\n        this.ref['slider-el'].cancel();\n        this._onSliderClose();\n      },\n      'on.clickTab': (e) => {\n        let id = e.currentTarget.getAttribute('data-id');\n        this._activateTab(id, { fromViewer: false });\n      },\n    };\n\n    /** @private */\n\n    this._debouncedShowLoader = debounce(this._showLoader.bind(this), 500);\n  }\n\n  /** @private */\n  _onSliderClose() {\n    this.$['*showSlider'] = false;\n    if (this.$['*tabId'] === TabId.SLIDERS) {\n      this.ref['tooltip-el'].classList.toggle('info-tooltip_visible', false);\n    }\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   */\n  _createOperationControl(operation) {\n    let el = EditorOperationControl.is && new EditorOperationControl();\n    el['operation'] = operation;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} filter\n   */\n  _createFilterControl(filter) {\n    let el = EditorFilterControl.is && new EditorFilterControl();\n    el['filter'] = filter;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} operation\n   */\n  _createToggleControl(operation) {\n    let el = EditorCropButtonControl.is && new EditorCropButtonControl();\n    el['operation'] = operation;\n    return el;\n  }\n\n  /**\n   * @private\n   * @param {String} tabId\n   */\n  _renderControlsList(tabId) {\n    let listEl = this.ref[`controls-list-${tabId}`];\n    let fr = document.createDocumentFragment();\n\n    if (tabId === TabId.CROP) {\n      this.$.cropOperations.forEach((operation) => {\n        let el = this._createToggleControl(operation);\n        // @ts-ignore\n        fr.appendChild(el);\n      });\n    } else if (tabId === TabId.FILTERS) {\n      [FAKE_ORIGINAL_FILTER, ...this.$.filters].forEach((filterId) => {\n        let el = this._createFilterControl(filterId);\n        // @ts-ignore\n        fr.appendChild(el);\n      });\n    } else if (tabId === TabId.SLIDERS) {\n      this.$.colorOperations.forEach((operation) => {\n        let el = this._createOperationControl(operation);\n        // @ts-ignore\n        fr.appendChild(el);\n      });\n    }\n\n    fr.childNodes.forEach((/** @type {HTMLElement} */ el, idx) => {\n      if (idx === fr.childNodes.length - 1) {\n        el.classList.add('controls-list_last-item');\n      }\n    });\n\n    listEl.innerHTML = '';\n    listEl.appendChild(fr);\n  }\n\n  /**\n   * @private\n   * @param {String} id\n   * @param {{ fromViewer?: Boolean }} options\n   */\n  _activateTab(id, { fromViewer }) {\n    this.$['*tabId'] = id;\n\n    if (id === TabId.CROP) {\n      this.$['*faderEl'].deactivate();\n      this.$['*cropperEl'].activate(this.$['*imageSize'], { fromViewer });\n    } else {\n      this.$['*faderEl'].activate({ url: this.$['*originalUrl'], fromViewer });\n      this.$['*cropperEl'].deactivate();\n    }\n\n    for (let tabId of TABS) {\n      let isCurrentTab = tabId === id;\n\n      let tabToggleEl = this.ref[`tab-toggle-${tabId}`];\n      tabToggleEl.active = isCurrentTab;\n\n      if (isCurrentTab) {\n        this._renderControlsList(id);\n        this._syncTabIndicator();\n      } else {\n        this._unmountTabControls(tabId);\n      }\n      this.$[`presence.tabContent.${tabId}`] = isCurrentTab;\n    }\n  }\n\n  /**\n   * @private\n   * @param {String} tabId\n   */\n  _unmountTabControls(tabId) {\n    let listEl = this.ref[`controls-list-${tabId}`];\n    if (listEl) {\n      listEl.innerHTML = '';\n    }\n  }\n\n  /** @private */\n  _syncTabIndicator() {\n    let tabToggleEl = this.ref[`tab-toggle-${this.$['*tabId']}`];\n    let indicatorEl = this.ref['tabs-indicator'];\n    indicatorEl.style.transform = `translateX(${tabToggleEl.offsetLeft}px)`;\n  }\n\n  /** @private */\n  _preloadEditedImage() {\n    if (this.$['*imgContainerEl'] && this.$['*originalUrl']) {\n      let width = this.$['*imgContainerEl'].offsetWidth;\n      let src = this.proxyUrl(viewerImageSrc(this.$['*originalUrl'], width, this.$['*editorTransformations']));\n      this._cancelPreload && this._cancelPreload();\n      let { cancel } = batchPreloadImages([src]);\n      this._cancelPreload = () => {\n        cancel();\n        this._cancelPreload = undefined;\n      };\n    }\n  }\n\n  /** @private */\n  _showLoader(show) {\n    this.$.showLoader = show;\n  }\n\n  _updateInfoTooltip = debounce(() => {\n    let transformations = this.$['*editorTransformations'];\n    let text = '';\n    let visible = false;\n\n    if (this.$['*tabId'] === TabId.FILTERS) {\n      visible = true;\n      if (this.$['*currentFilter'] && transformations?.filter?.name === this.$['*currentFilter']) {\n        let value = transformations?.filter?.amount || 100;\n        text = this.l10n(this.$['*currentFilter']) + ' ' + value;\n      } else {\n        text = this.l10n(FAKE_ORIGINAL_FILTER);\n      }\n    } else if (this.$['*tabId'] === TabId.SLIDERS && this.$['*currentOperation']) {\n      visible = true;\n      let value =\n        transformations?.[this.$['*currentOperation']] || COLOR_OPERATIONS_CONFIG[this.$['*currentOperation']].zero;\n      text = this.$['*currentOperation'] + ' ' + value;\n    }\n    if (visible) {\n      this.$['*operationTooltip'] = text;\n    }\n    this.ref['tooltip-el'].classList.toggle('info-tooltip_visible', visible);\n  }, 0);\n\n  initCallback() {\n    super.initCallback();\n\n    this.$['*sliderEl'] = this.ref['slider-el'];\n\n    this.sub('*imageSize', (imageSize) => {\n      if (imageSize) {\n        setTimeout(() => {\n          this._activateTab(this.$['*tabId'], { fromViewer: true });\n        }, 0);\n      }\n    });\n\n    this.sub('*editorTransformations', (editorTransformations) => {\n      let appliedFilter = editorTransformations?.filter?.name;\n      if (this.$['*currentFilter'] !== appliedFilter) {\n        this.$['*currentFilter'] = appliedFilter;\n      }\n    });\n\n    this.sub('*currentFilter', () => {\n      this._updateInfoTooltip();\n    });\n\n    this.sub('*currentOperation', () => {\n      this._updateInfoTooltip();\n    });\n\n    this.sub('*tabId', () => {\n      this._updateInfoTooltip();\n    });\n\n    this.sub('*originalUrl', (originalUrl) => {\n      this.$['*faderEl'] && this.$['*faderEl'].deactivate();\n    });\n\n    this.sub('*editorTransformations', (transformations) => {\n      this._preloadEditedImage();\n      if (this.$['*faderEl']) {\n        this.$['*faderEl'].setTransformations(transformations);\n      }\n    });\n\n    this.sub('*loadingOperations', (/** @type {import('./types.js').LoadingOperations} */ loadingOperations) => {\n      let anyLoading = false;\n      for (let [, mapping] of loadingOperations.entries()) {\n        if (anyLoading) {\n          break;\n        }\n        for (let [, loading] of mapping.entries()) {\n          if (loading) {\n            anyLoading = true;\n            break;\n          }\n        }\n      }\n      this._debouncedShowLoader(anyLoading);\n    });\n\n    this.sub('*showSlider', (showSlider) => {\n      this.$['presence.subToolbar'] = showSlider;\n      this.$['presence.mainToolbar'] = !showSlider;\n    });\n\n    this._updateInfoTooltip();\n  }\n}\n\nEditorToolbar.template = /* HTML */ `\n  <lr-line-loader-ui set=\"active: showLoader\"></lr-line-loader-ui>\n  <div class=\"info-tooltip_container\">\n    <div class=\"info-tooltip_wrapper\">\n      <div ref=\"tooltip-el\" class=\"info-tooltip info-tooltip_hidden\">{{*operationTooltip}}</div>\n    </div>\n  </div>\n  <div class=\"toolbar-container\">\n    <lr-presence-toggle class=\"sub-toolbar\" set=\"visible: presence.mainToolbar; styles: presence.subTopToolbarStyles\">\n      <div class=\"tab-content-row\">${TABS.map(renderTabContent).join('')}</div>\n      <div class=\"controls-row\">\n        <lr-btn-ui theme=\"boring\" icon=\"closeMax\" set=\"onclick: on.cancel\"> </lr-btn-ui>\n        <div class=\"tab-toggles\">\n          <div ref=\"tabs-indicator\" class=\"tab-toggles_indicator\"></div>\n          ${TABS.map(renderTabToggle).join('')}\n        </div>\n        <lr-btn-ui theme=\"primary\" icon=\"done\" set=\"onclick: on.apply\"> </lr-btn-ui>\n      </div>\n    </lr-presence-toggle>\n    <lr-presence-toggle class=\"sub-toolbar\" set=\"visible: presence.subToolbar; styles: presence.subBottomToolbarStyles\">\n      <div class=\"slider\">\n        <lr-editor-slider ref=\"slider-el\"></lr-editor-slider>\n      </div>\n      <div class=\"controls-row\">\n        <lr-btn-ui theme=\"boring\" set=\"@text: l10n.cancel; onclick: on.cancelSlider;\"> </lr-btn-ui>\n        <lr-btn-ui theme=\"primary\" set=\"@text: l10n.apply; onclick: on.applySlider;\"> </lr-btn-ui>\n      </div>\n    </lr-presence-toggle>\n  </div>\n`;\n", "import { Block } from '../../../../../abstract/Block.js';\nimport { classNames } from '../../lib/classNames.js';\n\nexport class LrBtnUi extends Block {\n  constructor() {\n    super();\n\n    this._iconReversed = false;\n    this._iconSingle = false;\n    this._iconHidden = false;\n\n    this.init$ = {\n      ...this.ctxInit,\n      text: '',\n      icon: '',\n      iconCss: this._iconCss(),\n      theme: null,\n    };\n\n    this.defineAccessor('active', (active) => {\n      if (active) {\n        this.setAttribute('active', '');\n      } else {\n        this.removeAttribute('active');\n      }\n    });\n  }\n\n  _iconCss() {\n    return classNames('icon', {\n      icon_left: !this._iconReversed,\n      icon_right: this._iconReversed,\n      icon_hidden: this._iconHidden,\n      icon_single: this._iconSingle,\n    });\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.sub('icon', (iconName) => {\n      this._iconSingle = !this.$.text;\n      this._iconHidden = !iconName;\n      this.$.iconCss = this._iconCss();\n    });\n\n    this.sub('theme', (theme) => {\n      if (theme !== 'custom') {\n        this.className = theme;\n      }\n    });\n\n    this.sub('text', (txt) => {\n      this._iconSingle = false;\n    });\n\n    this.setAttribute('role', 'button');\n    if (this.tabIndex === -1) {\n      this.tabIndex = 0;\n    }\n    if (!this.hasAttribute('theme')) {\n      this.setAttribute('theme', 'default');\n    }\n  }\n\n  set reverse(val) {\n    if (this.hasAttribute('reverse')) {\n      this.style.flexDirection = 'row-reverse';\n      this._iconReversed = true;\n    } else {\n      this._iconReversed = false;\n      this.style.flexDirection = null;\n    }\n  }\n}\nLrBtnUi.bindAttributes({ text: 'text', icon: 'icon', reverse: 'reverse', theme: 'theme' });\n\nLrBtnUi.template = /* HTML */ `\n  <lr-icon size=\"20\" set=\"className: iconCss; @name: icon;\"></lr-icon>\n  <div class=\"text\">{{text}}</div>\n`;\n", "import { Block } from '../../../../../abstract/Block.js';\n\nexport class LineLoaderUi extends Block {\n  constructor() {\n    super();\n\n    this._active = false;\n\n    this._handleTransitionEndRight = () => {\n      let lineEl = this.ref['line-el'];\n      lineEl.style.transition = `initial`;\n      lineEl.style.opacity = '0';\n      lineEl.style.transform = `translateX(-101%)`;\n      this._active && this._start();\n    };\n  }\n\n  initCallback() {\n    super.initCallback();\n    this.defineAccessor('active', (active) => {\n      if (typeof active === 'boolean') {\n        if (active) {\n          this._start();\n        } else {\n          this._stop();\n        }\n      }\n    });\n  }\n\n  _start() {\n    this._active = true;\n    let { width } = this.getBoundingClientRect();\n    let lineEl = this.ref['line-el'];\n    lineEl.style.transition = `transform 1s`;\n    lineEl.style.opacity = '1';\n    lineEl.style.transform = `translateX(${width}px)`;\n    lineEl.addEventListener('transitionend', this._handleTransitionEndRight, {\n      once: true,\n    });\n  }\n\n  _stop() {\n    this._active = false;\n  }\n}\n\nLineLoaderUi.template = /* HTML */ `\n  <div class=\"inner\">\n    <div class=\"line\" ref=\"line-el\"></div>\n  </div>\n`;\n", "import { applyClassNames } from '../../lib/classNames.js';\nimport { Block } from '../../../../../abstract/Block.js';\n\n/**\n * @typedef {Object} Style\n * @property {String} [transition]\n * @property {String} [visible]\n * @property {String} [hidden]\n */\n\n/** @type {Style} */\nconst DEFAULT_STYLE = {\n  transition: 'transition',\n  visible: 'visible',\n  hidden: 'hidden',\n};\n\nexport class PresenceToggle extends Block {\n  constructor() {\n    super();\n\n    this._visible = false;\n    this._visibleStyle = DEFAULT_STYLE.visible;\n    this._hiddenStyle = DEFAULT_STYLE.hidden;\n    this._externalTransitions = false;\n\n    this.defineAccessor('styles', (styles) => {\n      if (!styles) {\n        return;\n      }\n      this._externalTransitions = true;\n      this._visibleStyle = styles.visible;\n      this._hiddenStyle = styles.hidden;\n    });\n\n    this.defineAccessor('visible', (visible) => {\n      if (typeof visible !== 'boolean') {\n        return;\n      }\n\n      this._visible = visible;\n      this._handleVisible();\n    });\n  }\n\n  _handleVisible() {\n    this.style.visibility = this._visible ? 'inherit' : 'hidden';\n    applyClassNames(this, {\n      [DEFAULT_STYLE.transition]: !this._externalTransitions,\n      [this._visibleStyle]: this._visible,\n      [this._hiddenStyle]: !this._visible,\n    });\n    this.setAttribute('aria-hidden', this._visible ? 'false' : 'true');\n  }\n\n  initCallback() {\n    super.initCallback();\n    this.setAttribute('hidden', '');\n\n    if (!this._externalTransitions) {\n      this.classList.add(DEFAULT_STYLE.transition);\n    }\n\n    this._handleVisible();\n    setTimeout(() => this.removeAttribute('hidden'), 0);\n  }\n}\nPresenceToggle.template = /* HTML */ ` <slot></slot> `;\n", "import { Block } from '../../../../../abstract/Block.js';\n\nexport class SliderUi extends Block {\n  init$ = {\n    ...this.ctxInit,\n    disabled: false,\n    min: 0,\n    max: 100,\n    onInput: null,\n    onChange: null,\n    defaultValue: null,\n    'on.sliderInput': () => {\n      let value = parseInt(this.ref['input-el'].value, 10);\n      this._updateValue(value);\n      this.$.onInput && this.$.onInput(value);\n    },\n    'on.sliderChange': () => {\n      let value = parseInt(this.ref['input-el'].value, 10);\n      this.$.onChange && this.$.onChange(value);\n    },\n  };\n\n  constructor() {\n    super();\n    this.setAttribute('with-effects', '');\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    this.defineAccessor('disabled', (disabled) => {\n      this.$.disabled = disabled;\n    });\n\n    this.defineAccessor('min', (min) => {\n      this.$.min = min;\n    });\n\n    this.defineAccessor('max', (max) => {\n      this.$.max = max;\n    });\n\n    this.defineAccessor('defaultValue', (defaultValue) => {\n      this.$.defaultValue = defaultValue;\n      this.ref['input-el'].value = defaultValue;\n      this._updateValue(defaultValue);\n    });\n\n    this.defineAccessor('zero', (zero) => {\n      this._zero = zero;\n    });\n\n    this.defineAccessor('onInput', (onInput) => {\n      if (!onInput) return;\n      this.$.onInput = onInput;\n    });\n\n    this.defineAccessor('onChange', (onChange) => {\n      if (!onChange) return;\n      this.$.onChange = onChange;\n    });\n\n    this._updateSteps();\n\n    this._observer = new ResizeObserver(() => {\n      this._updateSteps();\n      let value = parseInt(this.ref['input-el'].value, 10);\n      this._updateValue(value);\n    });\n    this._observer.observe(this);\n\n    this._thumbSize = parseInt(window.getComputedStyle(this).getPropertyValue('--l-thumb-size'), 10);\n\n    setTimeout(() => {\n      let value = parseInt(this.ref['input-el'].value, 10);\n      this._updateValue(value);\n    }, 0);\n\n    this.sub('disabled', (disabled) => {\n      let el = this.ref['input-el'];\n      if (disabled) {\n        el.setAttribute('disabled', 'disabled');\n      } else {\n        el.removeAttribute('disabled');\n      }\n    });\n\n    let inputEl = this.ref['input-el'];\n    inputEl.addEventListener('focus', () => {\n      this.style.setProperty('--color-effect', 'var(--hover-color-rgb)');\n    });\n    inputEl.addEventListener('blur', () => {\n      this.style.setProperty('--color-effect', 'var(--idle-color-rgb)');\n    });\n  }\n\n  _updateValue(value) {\n    this._updateZeroDot(value);\n\n    let { width } = this.getBoundingClientRect();\n    let slope = 100 / (this.$.max - this.$.min);\n    let mappedValue = slope * (value - this.$.min);\n    let offset = (mappedValue * (width - this._thumbSize)) / 100;\n\n    window.requestAnimationFrame(() => {\n      this.ref['thumb-el'].style.transform = `translateX(${offset}px)`;\n    });\n  }\n\n  _updateZeroDot(value) {\n    if (!this._zeroDotEl) {\n      return;\n    }\n    if (value === this._zero) {\n      this._zeroDotEl.style.opacity = '0';\n    } else {\n      this._zeroDotEl.style.opacity = '0.2';\n    }\n    let { width } = this.getBoundingClientRect();\n    let slope = 100 / (this.$.max - this.$.min);\n    let mappedValue = slope * (this._zero - this.$.min);\n    let offset = (mappedValue * (width - this._thumbSize)) / 100;\n    window.requestAnimationFrame(() => {\n      this._zeroDotEl.style.transform = `translateX(${offset}px)`;\n    });\n  }\n\n  _updateSteps() {\n    const STEP_GAP = 15;\n\n    let stepsEl = this.ref['steps-el'];\n    let { width } = stepsEl.getBoundingClientRect();\n    let half = Math.ceil(width / 2);\n    let count = Math.ceil(half / STEP_GAP) - 2;\n\n    if (this._stepsCount === count) {\n      return;\n    }\n\n    let fr = document.createDocumentFragment();\n    let minorStepEl = document.createElement('div');\n    let borderStepEl = document.createElement('div');\n    minorStepEl.className = 'minor-step';\n    borderStepEl.className = 'border-step';\n    fr.appendChild(borderStepEl);\n    for (let i = 0; i < count; i++) {\n      fr.appendChild(minorStepEl.cloneNode());\n    }\n    fr.appendChild(borderStepEl.cloneNode());\n    for (let i = 0; i < count; i++) {\n      fr.appendChild(minorStepEl.cloneNode());\n    }\n    fr.appendChild(borderStepEl.cloneNode());\n\n    let zeroDotEl = document.createElement('div');\n    zeroDotEl.className = 'zero-dot';\n    fr.appendChild(zeroDotEl);\n    this._zeroDotEl = zeroDotEl;\n\n    stepsEl.innerHTML = '';\n    stepsEl.appendChild(fr);\n    this._stepsCount = count;\n  }\n\n  destroyCallback() {\n    this._observer?.disconnect();\n  }\n}\nSliderUi.template = /* HTML */ `\n  <div class=\"steps\" ref=\"steps-el\"></div>\n  <div ref=\"thumb-el\" class=\"thumb\"></div>\n  <input\n    class=\"input\"\n    type=\"range\"\n    ref=\"input-el\"\n    tabindex=\"0\"\n    set=\"oninput: on.sliderInput; onchange: on.sliderChange; @min: min; @max: max; @value: defaultValue;\"\n  />\n`;\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { CloudEditor } from './index.js';\n\nexport class CloudImageEditor extends UploaderBlock {\n  activityType = ActivityBlock.activities.CLOUD_IMG_EDIT;\n\n  init$ = {\n    ...this.ctxInit,\n    cdnUrl: null,\n  };\n\n  initCallback() {\n    super.initCallback();\n    this.bindCssData('--cfg-pubkey');\n\n    this.registerActivity(this.activityType, {\n      onActivate: () => this.mountEditor(),\n      onDeactivate: () => this.unmountEditor(),\n    });\n\n    this.sub('*focusedEntry', (/** @type {import('../../abstract/TypedData.js').TypedData} */ entry) => {\n      if (!entry) {\n        return;\n      }\n      this.entry = entry;\n\n      this.entry.subscribe('cdnUrl', (cdnUrl) => {\n        if (cdnUrl) {\n          this.$.cdnUrl = cdnUrl;\n        }\n      });\n    });\n  }\n\n  /** @param {CustomEvent<import('./src/types.js').ApplyResult>} e */\n  handleApply(e) {\n    let result = e.detail;\n    this.entry.setMultipleValues({\n      cdnUrl: result.cdnUrl,\n      cdnUrlModifiers: result.cdnUrlModifiers,\n    });\n    this.historyBack();\n  }\n\n  handleCancel() {\n    this.historyBack();\n  }\n\n  mountEditor() {\n    let instance = new CloudEditor();\n    instance.classList.add('lr-cldtr-common');\n    let cdnUrl = this.$.cdnUrl;\n    instance.setAttribute('cdn-url', cdnUrl);\n\n    instance.addEventListener('apply', (result) => this.handleApply(result));\n    instance.addEventListener('cancel', () => this.handleCancel());\n\n    this.innerHTML = '';\n    this.appendChild(instance);\n  }\n\n  unmountEditor() {\n    this.innerHTML = '';\n  }\n}\n", "let cbMapping = {};\n\nwindow.addEventListener('message', (e) => {\n  let message;\n  try {\n    message = JSON.parse(e.data);\n  } catch (err) {\n    return;\n  }\n\n  if (message?.type in cbMapping) {\n    let cbList = cbMapping[message.type];\n    for (let [sender, callback] of cbList) {\n      if (e.source === sender) {\n        callback(message);\n      }\n    }\n  }\n});\n\nconst registerMessage = function (type, sender, callback) {\n  if (!(type in cbMapping)) {\n    cbMapping[type] = [];\n  }\n\n  cbMapping[type].push([sender, callback]);\n};\n\nconst unregisterMessage = function (type, sender) {\n  if (type in cbMapping) {\n    cbMapping[type] = cbMapping[type].filter((item) => item[0] !== sender);\n  }\n};\n\nexport { registerMessage, unregisterMessage };\n", "let styleToCss = (style) => {\n  let css = Object.keys(style).reduce((acc, selector) => {\n    let propertiesObj = style[selector];\n    let propertiesStr = Object.keys(propertiesObj).reduce((acc, prop) => {\n      let value = propertiesObj[prop];\n      return acc + `${prop}: ${value};`;\n    }, '');\n    return acc + `${selector}{${propertiesStr}}`;\n  }, '');\n  return css;\n};\n\nexport function buildStyles({ textColor, backgroundColor, linkColor, linkColorHover, shadeColor }) {\n  let border = `solid 1px ${shadeColor}`;\n\n  // TODO: we need to update source source styles, add css custom properties to control theme\n  return styleToCss({\n    body: {\n      color: textColor,\n      'background-color': backgroundColor,\n    },\n    '.side-bar': {\n      background: 'inherit',\n      'border-right': border,\n    },\n    '.main-content': {\n      background: 'inherit',\n    },\n    '.main-content-header': {\n      background: 'inherit',\n    },\n    '.main-content-footer': {\n      background: 'inherit',\n    },\n    '.list-table-row': {\n      color: 'inherit',\n    },\n    '.list-table-row:hover': {\n      background: shadeColor,\n    },\n    '.list-table-row .list-table-cell-a, .list-table-row .list-table-cell-b': {\n      'border-top': border,\n    },\n    '.list-table-body .list-items': {\n      'border-bottom': border,\n    },\n    '.bread-crumbs a': {\n      color: linkColor,\n    },\n    '.bread-crumbs a:hover': {\n      color: linkColorHover,\n    },\n    '.main-content.loading': {\n      background: `${backgroundColor} url(/static/images/loading_spinner.gif) center no-repeat`,\n      'background-size': '25px 25px',\n    },\n    '.list-icons-item': {\n      background: `center no-repeat ${shadeColor}`,\n    },\n    '.source-gdrive .side-bar-menu a, .source-gphotos .side-bar-menu a': {\n      color: linkColor,\n    },\n    '.source-gdrive .side-bar-menu a, .source-gphotos .side-bar-menu a:hover': {\n      color: linkColorHover,\n    },\n    '.side-bar-menu a': {\n      color: linkColor,\n    },\n    '.side-bar-menu a:hover': {\n      color: linkColorHover,\n    },\n    '.source-gdrive .side-bar-menu .current, .source-gdrive .side-bar-menu a:hover, .source-gphotos .side-bar-menu .current, .source-gphotos .side-bar-menu a:hover':\n      {\n        color: linkColorHover,\n      },\n    '.source-vk .side-bar-menu a': {\n      color: linkColor,\n    },\n    '.source-vk .side-bar-menu a:hover': {\n      color: linkColorHover,\n      background: 'none',\n    },\n  });\n}\n", "/**\n * @param {{ [key: string]: string | number | boolean | null | undefined }} params\n * @returns {string}\n */\nexport function queryString(params) {\n  let list = [];\n  for (let [key, value] of Object.entries(params)) {\n    if (value === undefined || value === null || (typeof value === 'string' && value.length === 0)) {\n      continue;\n    }\n    list.push(`${key}=${encodeURIComponent(value)}`);\n  }\n  return list.join('&');\n}\n", "/**\n * @param {string} str\n * @returns {string}\n */\nconst escapeRegExp = function (str) {\n  return str.replace(/[\\\\-\\\\[]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n};\n\n/**\n * @param {string} str\n * @param {string} flags\n * @returns {RegExp}\n */\nexport const wildcardRegexp = function (str, flags = 'i') {\n  const parts = str.split('*').map(escapeRegExp);\n  return new RegExp('^' + parts.join('.+') + '$', flags);\n};\n", "import { create } from '@symbiotejs/symbiote';\nimport { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { ActivityBlock } from '../../abstract/ActivityBlock.js';\nimport { registerMessage, unregisterMessage } from './messages.js';\nimport { buildStyles } from './buildStyles.js';\nimport { queryString } from './query-string.js';\nimport { wildcardRegexp } from '../../utils/wildcardRegexp.js';\nimport { stringToArray } from '../../utils/stringToArray.js';\n/**\n * @typedef {Object} ActivityParams\n * @property {String} externalSourceType\n */\n\nexport class ExternalSource extends UploaderBlock {\n  activityType = ActivityBlock.activities.EXTERNAL;\n\n  init$ = {\n    ...this.ctxInit,\n    activityIcon: '',\n    activityCaption: '',\n    counter: 0,\n    onDone: () => {\n      this.$['*currentActivity'] = ActivityBlock.activities.UPLOAD_LIST;\n    },\n    onCancel: () => {\n      this.historyBack();\n    },\n  };\n\n  /** @private */\n  _iframe = null;\n\n  initCallback() {\n    super.initCallback();\n    this.registerActivity(this.activityType, {\n      onActivate: () => {\n        let { externalSourceType } = /** @type {ActivityParams} */ (this.activityParams);\n\n        this.set$({\n          activityCaption: `${externalSourceType?.[0].toUpperCase()}${externalSourceType?.slice(1)}`,\n          activityIcon: externalSourceType,\n        });\n\n        this.$.counter = 0;\n        this.mountIframe();\n      },\n    });\n    this.sub('*currentActivity', (val) => {\n      if (val !== this.activityType) {\n        this.unmountIframe();\n      }\n    });\n  }\n\n  sendMessage(message) {\n    this._iframe.contentWindow.postMessage(JSON.stringify(message), '*');\n  }\n\n  async handleFileSelected(message) {\n    this.$.counter = this.$.counter + 1;\n\n    const url = (() => {\n      if (message.alternatives) {\n        const preferredTypes = stringToArray(this.getCssData('--cfg-external-sources-preferred-types'));\n        for (const preferredType of preferredTypes) {\n          const regexp = wildcardRegexp(preferredType);\n          for (const [type, typeUrl] of Object.entries(message.alternatives)) {\n            if (regexp.test(type)) {\n              return typeUrl;\n            }\n          }\n        }\n      }\n      return message.url;\n    })();\n\n    let { filename } = message;\n    this.uploadCollection.add({\n      externalUrl: url,\n      fileName: filename ?? null,\n    });\n  }\n\n  handleIframeLoad() {\n    this.applyStyles();\n  }\n\n  _inheritedUpdateCssData = this.updateCssData;\n  updateCssData = () => {\n    if (this.isActivityActive) {\n      this._inheritedUpdateCssData();\n      this.applyStyles();\n    }\n  };\n\n  getCssValue(propName) {\n    let style = window.getComputedStyle(this);\n    return style.getPropertyValue(propName).trim();\n  }\n\n  applyStyles() {\n    let colors = {\n      backgroundColor: this.getCssValue('--clr-background-light'),\n      textColor: this.getCssValue('--clr-txt'),\n      shadeColor: this.getCssValue('--clr-shade-lv1'),\n      linkColor: '#157cfc',\n      linkColorHover: '#3891ff',\n    };\n\n    this.sendMessage({\n      type: 'embed-css',\n      style: buildStyles(colors),\n    });\n  }\n\n  remoteUrl() {\n    let pubkey = this.getCssData('--cfg-pubkey');\n    let imagesOnly = false.toString();\n    let { externalSourceType } = this.activityParams;\n    let params = {\n      lang: 'en', // TOOD: pass correct lang\n      // TODO: we should add a new property to the social sources application\n      // to collect lr-blocks data separately from legacy widget\n      widget_version: '3.11.3',\n      public_key: pubkey,\n      images_only: imagesOnly,\n      pass_window_open: false,\n      session_key: this.getCssData('--cfg-remote-tab-session-key'),\n    };\n    return `https://social.uploadcare.com/window3/${externalSourceType}?${queryString(params)}`;\n  }\n\n  mountIframe() {\n    /** @type {HTMLIFrameElement} */\n    // @ts-ignore\n    let iframe = create({\n      tag: 'iframe',\n      attributes: {\n        src: this.remoteUrl(),\n        marginheight: 0,\n        marginwidth: 0,\n        frameborder: 0,\n        allowTransparency: true,\n      },\n    });\n    iframe.addEventListener('load', this.handleIframeLoad.bind(this));\n\n    this.ref.iframeWrapper.innerHTML = '';\n    this.ref.iframeWrapper.appendChild(iframe);\n\n    registerMessage('file-selected', iframe.contentWindow, this.handleFileSelected.bind(this));\n\n    this._iframe = iframe;\n  }\n\n  unmountIframe() {\n    this._iframe && unregisterMessage('file-selected', this._iframe.contentWindow);\n    this.ref.iframeWrapper.innerHTML = '';\n    this._iframe = undefined;\n  }\n}\n\nExternalSource.template = /* HTML */ `\n  <lr-activity-header>\n    <button type=\"button\" class=\"mini-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"back\"></lr-icon>\n    </button>\n    <div>\n      <lr-icon set=\"@name: activityIcon\"></lr-icon>\n      <span>{{activityCaption}}</span>\n    </div>\n    <button type=\"button\" class=\"mini-btn close-btn\" set=\"onclick: *historyBack\">\n      <lr-icon name=\"close\"></lr-icon>\n    </button>\n  </lr-activity-header>\n  <div class=\"content\">\n    <div ref=\"iframeWrapper\" class=\"iframe-wrapper\"></div>\n    <div class=\"toolbar\">\n      <button type=\"button\" class=\"cancel-btn secondary-btn\" set=\"onclick: onCancel\" l10n=\"cancel\"></button>\n      <div></div>\n      <div class=\"selected-counter\"><span l10n=\"selected-count\"></span>{{counter}}</div>\n      <button type=\"button\" class=\"done-btn primary-btn\" set=\"onclick: onDone; @disabled: !counter\">\n        <lr-icon name=\"check\"></lr-icon>\n      </button>\n    </div>\n  </div>\n`;\n", "import { Block } from '../../abstract/Block.js';\nimport { create } from '@symbiotejs/symbiote';\nimport { stringToArray } from '../../utils/stringToArray.js';\n\nexport class Tabs extends Block {\n  /** @param {String} tabL10nStr */\n  setCurrentTab(tabL10nStr) {\n    if (!tabL10nStr) {\n      return;\n    }\n    let ctxList = [...this.ref.context.querySelectorAll('[tab-ctx]')];\n    ctxList.forEach((ctxEl) => {\n      if (ctxEl.getAttribute('tab-ctx') === tabL10nStr) {\n        ctxEl.removeAttribute('hidden');\n      } else {\n        ctxEl.setAttribute('hidden', '');\n      }\n    });\n    for (let lStr in this._tabMap) {\n      if (lStr === tabL10nStr) {\n        this._tabMap[lStr].setAttribute('current', '');\n      } else {\n        this._tabMap[lStr].removeAttribute('current');\n      }\n    }\n  }\n\n  initCallback() {\n    super.initCallback();\n    /**\n     * @private\n     * @type {Object<string, HTMLElement>}\n     */\n    this._tabMap = {};\n    this.defineAccessor('tab-list', (/** @type {String} */ val) => {\n      if (!val) {\n        return;\n      }\n      let tabList = stringToArray(val);\n      tabList.forEach((tabL10nStr) => {\n        let tabEl = create({\n          tag: 'div',\n          attributes: {\n            class: 'tab',\n          },\n          properties: {\n            onclick: () => {\n              this.setCurrentTab(tabL10nStr);\n            },\n          },\n        });\n        tabEl.textContent = this.l10n(tabL10nStr);\n        this.ref.row.appendChild(tabEl);\n        this._tabMap[tabL10nStr] = tabEl;\n      });\n    });\n\n    this.defineAccessor('default', (val) => {\n      this.setCurrentTab(val);\n    });\n\n    if (!this.hasAttribute('default')) {\n      this.setCurrentTab(Object.keys(this._tabMap)[0]);\n    }\n  }\n}\n\nTabs.bindAttributes({\n  'tab-list': null,\n  default: null,\n});\n\nTabs.template = /* HTML */ `\n  <div ref=\"row\" class=\"tabs-row\"></div>\n  <div ref=\"context\" class=\"tabs-context\">\n    <slot></slot>\n  </div>\n`;\n", "import { UploaderBlock } from '../../abstract/UploaderBlock.js';\nimport { uploadFileGroup } from '@uploadcare/upload-client';\n\n/** @typedef {import('@uploadcare/upload-client').UploadcareFile[]} FileList} */\n\nexport class DataOutput extends UploaderBlock {\n  processInnerHtml = true;\n\n  init$ = {\n    ...this.ctxInit,\n    output: null,\n    filesData: null,\n  };\n\n  cssInit$ = {\n    '--cfg-group-output': 0,\n  };\n\n  get dict() {\n    return DataOutput.dict;\n  }\n\n  get validationInput() {\n    return this._validationInputElement;\n  }\n\n  initCallback() {\n    super.initCallback();\n\n    if (this.hasAttribute(this.dict.FORM_INPUT_ATTR)) {\n      this._dynamicInputsContainer = document.createElement('div');\n      this.appendChild(this._dynamicInputsContainer);\n\n      if (this.hasAttribute(this.dict.INPUT_REQUIRED)) {\n        let input = document.createElement('input');\n        input.type = 'text';\n        input.name = '__UPLOADCARE_VALIDATION_INPUT__';\n        input.required = true;\n        this.appendChild(input);\n        this._validationInputElement = input;\n      }\n    }\n\n    this.sub(\n      'output',\n      (data) => {\n        if (!data) {\n          return;\n        }\n        if (this.hasAttribute(this.dict.FIRE_EVENT_ATTR)) {\n          this.dispatchEvent(\n            new CustomEvent(this.dict.EVENT_NAME, {\n              bubbles: true,\n              composed: true,\n              detail: {\n                timestamp: Date.now(),\n                ctxName: this.ctxName,\n                data,\n              },\n            })\n          );\n        }\n\n        if (this.hasAttribute(this.dict.FORM_INPUT_ATTR)) {\n          this._dynamicInputsContainer.innerHTML = '';\n          let values = data.groupData ? [data.groupData.cdnUrl] : data.map((file) => file.cdnUrl);\n          for (let value of values) {\n            let input = document.createElement('input');\n            input.type = 'hidden';\n            input.name = this.getAttribute(this.dict.INPUT_NAME_ATTR) || this.ctxName;\n            input.value = value;\n            this._dynamicInputsContainer.appendChild(input);\n          }\n          if (this.hasAttribute(this.dict.INPUT_REQUIRED)) {\n            this._validationInputElement.value = values.length ? '__VALUE__' : '';\n          }\n        }\n\n        if (this.hasAttribute(this.dict.CONSOLE_ATTR)) {\n          console.log(data);\n        }\n      },\n      false\n    );\n\n    this.sub(\n      this.dict.SRC_CTX_KEY,\n      async (/** @type {FileList} */ data) => {\n        if (!data) {\n          this.$.output = null;\n          this.$.filesData = null;\n          return;\n        }\n        this.$.filesData = data;\n        if (this.getCssData('--cfg-group-output') || this.hasAttribute(this.dict.GROUP_ATTR)) {\n          let uuidList = data.map((fileDesc) => {\n            return fileDesc.uuid;\n          });\n          let resp = await uploadFileGroup(uuidList, {\n            ...this.getUploadClientOptions(),\n          });\n          this.$.output = {\n            groupData: resp,\n            files: data,\n          };\n        } else {\n          this.$.output = data;\n        }\n      },\n      false\n    );\n  }\n}\n\n/** @enum {Object<[x: string], string>} */\nDataOutput.dict = {\n  SRC_CTX_KEY: '*outputData',\n  EVENT_NAME: 'lr-data-output',\n  FIRE_EVENT_ATTR: 'use-event',\n  CONSOLE_ATTR: 'use-console',\n  GROUP_ATTR: 'use-group',\n  FORM_INPUT_ATTR: 'use-input',\n  INPUT_NAME_ATTR: 'input-name',\n  INPUT_REQUIRED: 'input-required',\n};\n", "import { ActivityBlock } from '../../abstract/ActivityBlock.js';\n\nexport class ActivityHeader extends ActivityBlock {}\n", "import { Block } from '../../abstract/Block.js';\n\nexport class Select extends Block {\n  init$ = {\n    ...this.ctxInit,\n    currentText: '',\n    options: [],\n    selectHtml: '',\n    onSelect: (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.value = this.ref.select.value;\n      this.$.currentText =\n        this.$.options.find((opt) => {\n          return opt.value == this.value;\n        })?.text || '';\n      this.dispatchEvent(new Event('change'));\n    },\n  };\n\n  initCallback() {\n    super.initCallback();\n\n    this.sub('options', (/** @type {{ text: String; value: String }[]} */ options) => {\n      this.$.currentText = options?.[0]?.text || '';\n      let html = '';\n      options?.forEach((opt) => {\n        html += /* HTML */ `<option value=\"${opt.value}\">${opt.text}</option>`;\n      });\n      this.$.selectHtml = html;\n    });\n  }\n}\n\nSelect.template = /* HTML */ `\n  <button>\n    {{currentText}}\n    <lr-icon name=\"select\"></lr-icon>\n    <select ref=\"select\" set=\"innerHTML: selectHtml; onchange: onSelect\"></select>\n  </button>\n`;\n", "import { Block } from '../../abstract/Block.js';\n\n/** @enum {String} */\nconst ICO_MAP = {\n  PLAY: 'play',\n  PAUSE: 'pause',\n  FS_ON: 'fullscreen-on',\n  FS_OFF: 'fullscreen-off',\n  VOL_ON: 'unmute',\n  VOL_OFF: 'mute',\n  CAP_ON: 'captions',\n  CAP_OFF: 'captions-off',\n};\n\n// TODO: refactor and move fullscreen adapter to utils:\nconst FSAPI = {\n  requestFullscreen: (el) => {\n    if (el.requestFullscreen) {\n      el.requestFullscreen();\n    } else if (el.webkitRequestFullscreen) {\n      el.webkitRequestFullscreen();\n    }\n  },\n  exitFullscreen: () => {\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    } else if (document['webkitExitFullscreen']) {\n      document['webkitExitFullscreen']();\n    }\n  },\n};\n\nexport class Video extends Block {\n  togglePlay() {\n    if (this._video.paused || this._video.ended) {\n      this._video.play();\n    } else {\n      this._video.pause();\n    }\n  }\n\n  toggleFullscreen() {\n    if ((document.fullscreenElement || document['webkitFullscreenElement']) === this) {\n      FSAPI.exitFullscreen();\n    } else {\n      FSAPI.requestFullscreen(this);\n    }\n  }\n\n  toggleCaptions() {\n    if (this.$.capIcon === ICO_MAP.CAP_OFF) {\n      this.$.capIcon = ICO_MAP.CAP_ON;\n      this._video.textTracks[0].mode = 'showing';\n      window.localStorage.setItem(Video.is + ':captions', '1');\n    } else {\n      this.$.capIcon = ICO_MAP.CAP_OFF;\n      this._video.textTracks[0].mode = 'hidden';\n      window.localStorage.removeItem(Video.is + ':captions');\n    }\n  }\n\n  toggleSound() {\n    if (this.$.volIcon === ICO_MAP.VOL_ON) {\n      this.$.volIcon = ICO_MAP.VOL_OFF;\n      this.$.volumeDisabled = true;\n      this._video.muted = true;\n    } else {\n      this.$.volIcon = ICO_MAP.VOL_ON;\n      this.$.volumeDisabled = false;\n      this._video.muted = false;\n    }\n  }\n\n  setVolume(val) {\n    window.localStorage.setItem(Video.is + ':volume', val);\n    let volume = val ? val / 100 : 0;\n    this._video.volume = volume;\n  }\n\n  /** @type {HTMLElement} */\n  get progress() {\n    return this.ref.progress;\n  }\n\n  init$ = {\n    ...this.ctxInit,\n    src: '',\n    ppIcon: ICO_MAP.PLAY,\n    fsIcon: ICO_MAP.FS_ON,\n    volIcon: ICO_MAP.VOL_ON,\n    capIcon: ICO_MAP.CAP_OFF,\n    totalTime: '00:00',\n    currentTime: '00:00',\n    progressCssWidth: '0',\n    hasSubtitles: false,\n    volumeDisabled: false,\n    volumeValue: 0,\n    onPP: () => {\n      this.togglePlay();\n    },\n    onFs: () => {\n      this.toggleFullscreen();\n    },\n    onCap: () => {\n      this.toggleCaptions();\n    },\n    onMute: () => {\n      this.toggleSound();\n    },\n    onVolChange: (e) => {\n      // TODO: cast range.value instead of range.$.value\n      let val = parseFloat(e.currentTarget.$.value);\n      this.setVolume(val);\n    },\n    progressClicked: (e) => {\n      let progressRect = this.progress.getBoundingClientRect();\n      this._video.currentTime = this._video.duration * (e.offsetX / progressRect.width);\n    },\n  };\n\n  /**\n   * @private\n   * @param {String} input\n   */\n  _getUrl(input) {\n    return input.includes('/') ? input : `https://ucarecdn.com/${input}/`;\n  }\n\n  /**\n   * @private\n   * @param {Object<string, any>} desc\n   */\n  _desc2attrs(desc) {\n    let attrs = [];\n    for (let attr in desc) {\n      let val = attr === 'src' ? this._getUrl(desc[attr]) : desc[attr];\n      attrs.push(`${attr}=\"${val}\"`);\n    }\n    return attrs.join(' ');\n  }\n\n  /**\n   * @private\n   * @param {Number} seconds\n   */\n  _timeFmt(seconds) {\n    // TODO: add hours\n    let date = new Date(Math.round(seconds) * 1000);\n    return [date.getMinutes(), date.getSeconds()]\n      .map((n) => {\n        return n < 10 ? '0' + n : n;\n      })\n      .join(':');\n  }\n\n  /** @private */\n  _initTracks() {\n    [...this._video.textTracks].forEach((track) => {\n      track.mode = 'hidden';\n    });\n    if (window.localStorage.getItem(Video.is + ':captions')) {\n      this.toggleCaptions();\n    }\n  }\n\n  /** @private */\n  _castAttributes() {\n    let toCast = ['autoplay', 'loop', 'muted'];\n    [...this.attributes].forEach((attr) => {\n      if (toCast.includes(attr.name)) {\n        this._video.setAttribute(attr.name, attr.value);\n      }\n    });\n  }\n\n  initCallback() {\n    super.initCallback();\n    /**\n     * @private\n     * @type {HTMLVideoElement}\n     */\n    this._video = this.ref.video;\n\n    this._castAttributes();\n\n    this._video.addEventListener('play', () => {\n      this.$.ppIcon = ICO_MAP.PAUSE;\n      this.setAttribute('playback', '');\n    });\n\n    this._video.addEventListener('pause', () => {\n      this.$.ppIcon = ICO_MAP.PLAY;\n      this.removeAttribute('playback');\n    });\n\n    this.addEventListener('fullscreenchange', (e) => {\n      console.log(e);\n      if (document.fullscreenElement === this) {\n        this.$.fsIcon = ICO_MAP.FS_OFF;\n      } else {\n        this.$.fsIcon = ICO_MAP.FS_ON;\n      }\n    });\n\n    this.sub('src', (src) => {\n      if (!src) {\n        return;\n      }\n      let url = this._getUrl(src);\n      this._video.src = url;\n    });\n\n    this.sub('video', async (descPath) => {\n      if (!descPath) {\n        return;\n      }\n      let desc = await (await window.fetch(this._getUrl(descPath))).json();\n\n      if (desc.poster) {\n        this._video.poster = this._getUrl(desc.poster);\n      }\n\n      let html = '';\n      desc?.sources.forEach((srcDesc) => {\n        html += /* HTML */ `<source ${this._desc2attrs(srcDesc)} />`;\n      });\n\n      if (desc.tracks) {\n        desc.tracks.forEach((trackDesc) => {\n          html += /* HTML */ `<track ${this._desc2attrs(trackDesc)} />`;\n        });\n        this.$.hasSubtitles = true;\n      }\n\n      this._video.innerHTML += html;\n\n      this._initTracks();\n      console.log(desc);\n    });\n\n    this._video.addEventListener('loadedmetadata', (e) => {\n      this.$.currentTime = this._timeFmt(this._video.currentTime);\n      this.$.totalTime = this._timeFmt(this._video.duration);\n    });\n\n    this._video.addEventListener('timeupdate', (e) => {\n      let perc = Math.round(100 * (this._video.currentTime / this._video.duration));\n      this.$.progressCssWidth = perc + '%';\n      this.$.currentTime = this._timeFmt(this._video.currentTime);\n    });\n\n    let volume = window.localStorage.getItem(Video.is + ':volume');\n    if (volume) {\n      let vol = parseFloat(volume);\n      this.setVolume(vol);\n      this.$.volumeValue = vol;\n    }\n  }\n}\n\nVideo.template = /* HTML */ `\n  <div class=\"video-wrapper\">\n    <video ref=\"video\" preload=\"metadata\" crossorigin=\"anonymous\"></video>\n  </div>\n\n  <div class=\"toolbar\">\n    <div class=\"progress\" ref=\"progress\" set -onclick=\"progressClicked\">\n      <div class=\"bar\" set -style.width=\"progressCssWidth\"></div>\n    </div>\n\n    <div class=\"tb-block\">\n      <button set -onclick=\"onPP\">\n        <lr-icon set -@name=\"ppIcon\"></lr-icon>\n      </button>\n      <div class=\"timer\">{{currentTime}} / {{totalTime}}</div>\n    </div>\n\n    <div class=\"tb-block\">\n      <button set -onclick=\"onCap\" -@hidden=\"!hasSubtitles\">\n        <lr-icon set -@name=\"capIcon\"></lr-icon>\n      </button>\n\n      <button set -onclick=\"onMute\">\n        <lr-icon set -@name=\"volIcon\"></lr-icon>\n      </button>\n\n      <lr-range type=\"range\" set -onchange=\"onVolChange\" -@disabled=\"volumeDisabled\" -value=\"volumeValue\"> </lr-range>\n\n      <button set -onclick=\"onFs\">\n        <lr-icon set -@name=\"fsIcon\"></lr-icon>\n      </button>\n    </div>\n  </div>\n`;\n\nVideo.bindAttributes({\n  video: 'video',\n  src: 'src',\n});\n", "import { Block } from '../../abstract/Block.js';\n\nconst CSS_ATTRIBUTE = 'css-src';\n\nexport class ShadowWrapper extends Block {\n  pauseRender = true;\n\n  shadowReadyCallback() {}\n\n  initCallback() {\n    super.initCallback();\n    this.setAttribute('hidden', '');\n    let href = this.getAttribute(CSS_ATTRIBUTE);\n    if (href) {\n      this.renderShadow = true;\n      this.attachShadow({\n        mode: 'open',\n      });\n      let link = document.createElement('link');\n      link.rel = 'stylesheet';\n      link.type = 'text/css';\n      link.href = href;\n      link.onload = () => {\n        // CSS modules can be not loaded at this moment\n        // TODO: investigate better solution\n        window.requestAnimationFrame(() => {\n          this.render();\n          window.setTimeout(() => {\n            this.removeAttribute('hidden');\n            this.shadowReadyCallback();\n          });\n        });\n      };\n      this.shadowRoot.prepend(link);\n    } else {\n      this.render();\n      this.removeAttribute('hidden');\n      this.shadowReadyCallback();\n    }\n  }\n}\n", "import { Block } from '../../abstract/Block.js';\n\nexport class Copyright extends Block {\n  cssInit$ = {\n    '--cfg-remove-copyright': 0,\n  };\n\n  init$ = {\n    ...this.ctxInit,\n    removeCopyright: false,\n  };\n\n  initCallback() {\n    super.initCallback();\n\n    this.sub(\n      '--cfg-remove-copyright',\n      /** @param {number} value */\n      (value) => {\n        this.$.removeCopyright = !!value;\n      }\n    );\n  }\n\n  static template = /* HTML */ `\n    <a\n      href=\"https://uploadcare.com/?utm_source=copyright&utm_medium=referral&utm_campaign=v4\"\n      target=\"_blank noopener\"\n      class=\"credits\"\n      set=\"@hidden: removeCopyright\"\n      >Powered by Uploadcare</a\n    >\n  `;\n}\n", "import { ShadowWrapper } from '../blocks/ShadowWrapper/ShadowWrapper.js';\nimport { uploaderBlockCtx } from './CTX.js';\n\nexport class SolutionBlock extends ShadowWrapper {\n  ctxInit = uploaderBlockCtx(this);\n  ctxOwner = true;\n  _template = null;\n\n  static set template(value) {\n    this._template = value + /** HTML */ `<slot></slot>`;\n  }\n\n  static get template() {\n    return this._template;\n  }\n}\n", "import { SolutionBlock } from '../../../abstract/SolutionBlock.js';\n\nexport class FileUploaderRegular extends SolutionBlock {}\n\nFileUploaderRegular.template = /* HTML */ `\n  <lr-simple-btn></lr-simple-btn>\n\n  <lr-modal strokes block-body-scrolling>\n    <lr-start-from>\n      <lr-drop-area with-icon clickable></lr-drop-area>\n      <lr-source-list wrap></lr-source-list>\n      <lr-copyright></lr-copyright>\n    </lr-start-from>\n    <lr-upload-list></lr-upload-list>\n    <lr-camera-source></lr-camera-source>\n    <lr-url-source></lr-url-source>\n    <lr-external-source></lr-external-source>\n    <lr-cloud-image-editor></lr-cloud-image-editor>\n  </lr-modal>\n\n  <lr-message-box></lr-message-box>\n  <lr-progress-bar-common></lr-progress-bar-common>\n`;\n", "import { SolutionBlock } from '../../../abstract/SolutionBlock.js';\nimport { ActivityBlock } from '../../../abstract/ActivityBlock.js';\n\nexport class FileUploaderMinimal extends SolutionBlock {\n  pauseRender = true;\n\n  init$ = {\n    ...this.ctxInit,\n    selectClicked: () => {\n      this.ref.uBlock.openSystemDialog();\n    },\n  };\n\n  shadowReadyCallback() {\n    /** @type {import('../../../abstract/UploaderBlock.js').UploaderBlock} */\n    const uBlock = this.ref.uBlock;\n    this.sub('*currentActivity', (val) => {\n      if (!val) {\n        this.$['*currentActivity'] = uBlock.initActivity || ActivityBlock.activities.START_FROM;\n      }\n    });\n\n    this.sub('*uploadList', (list) => {\n      if (list?.length === 0) {\n        this.$['*currentActivity'] = uBlock.initActivity || ActivityBlock.activities.START_FROM;\n      }\n    });\n  }\n}\n\nFileUploaderMinimal.template = /* HTML */ `\n  <lr-start-from>\n    <lr-drop-area clickable l10n=\"choose-file\"></lr-drop-area>\n    <lr-copyright></lr-copyright>\n  </lr-start-from>\n  <lr-upload-list ref=\"uBlock\"></lr-upload-list>\n  <lr-message-box></lr-message-box>\n`;\n", "import { SolutionBlock } from '../../../abstract/SolutionBlock.js';\nimport { ActivityBlock } from '../../../abstract/ActivityBlock.js';\n\nexport class FileUploaderInline extends SolutionBlock {\n  init$ = this.ctxInit;\n\n  shadowReadyCallback() {\n    /** @type {import('../../../abstract/UploaderBlock.js').UploaderBlock} */\n    const uBlock = this.ref.uBlock;\n    this.sub('*currentActivity', (val) => {\n      if (!val) {\n        this.$['*currentActivity'] = uBlock.initActivity || ActivityBlock.activities.START_FROM;\n      }\n    });\n  }\n}\n\nFileUploaderInline.template = /* HTML */ ` <lr-start-from>\n    <lr-drop-area with-icon clickable></lr-drop-area>\n    <lr-source-list wrap></lr-source-list>\n    <lr-copyright></lr-copyright>\n  </lr-start-from>\n  <lr-upload-list ref=\"uBlock\"></lr-upload-list>\n  <lr-camera-source></lr-camera-source>\n  <lr-url-source></lr-url-source>\n  <lr-external-source></lr-external-source>\n  <lr-message-box></lr-message-box>\n  <lr-progress-bar></lr-progress-bar>\n  <lr-cloud-image-editor></lr-cloud-image-editor>`;\n", "/** @param {Object<string, any>} blockExports */\nexport function registerBlocks(blockExports) {\n  for (let blockName in blockExports) {\n    let tagName = [...blockName].reduce((name, char) => {\n      if (char.toUpperCase() === char) {\n        char = '-' + char.toLowerCase();\n      }\n      return (name += char);\n    }, '');\n    if (tagName.startsWith('-')) {\n      tagName = tagName.replace('-', '');\n    }\n    if (!tagName.startsWith('lr-')) {\n      tagName = 'lr-' + tagName;\n    }\n    if (blockExports[blockName].reg) {\n      blockExports[blockName].reg(tagName);\n    }\n  }\n}\n", "import { registerBlocks } from './registerBlocks.js';\n\nexport const LR_WINDOW_KEY = '__lr-blocks__';\n\n/**\n * @param {String} url Blocks pack url\n * @param {Boolean} [register] Register connected package, if it not registered yet\n * @returns {Promise<import('../index.js')>}\n */\nexport async function connectBlocksFrom(url, register = false) {\n  return new Promise((resolve, reject) => {\n    if (typeof document !== 'object') {\n      resolve(null);\n      return;\n    }\n    if (typeof window === 'object' && window[LR_WINDOW_KEY]) {\n      resolve(window[LR_WINDOW_KEY]);\n      return;\n    }\n    let script = document.createElement('script');\n    script.type = 'module';\n    script.src = url;\n    script.onerror = () => {\n      reject();\n    };\n    script.onload = () => {\n      /** @type {import('../index.js')} */\n      let blocks = window[LR_WINDOW_KEY];\n      register && registerBlocks(blocks);\n      resolve(blocks);\n    };\n    document.head.appendChild(script);\n  });\n}\n"],
  "mappings": "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",
  "names": ["__publicField", "_a", "request", "OPEN_TOKEN", "CLOSE_TOKEN", "_a", "_a", "_a", "fn", "request", "response", "base", "TypeEnum", "Status", "request", "response", "signal", "file", "_a", "pusher", "sum", "info", "normalize", "group", "_a", "debounce", "_a", "_a", "_a", "_a", "_a", "info", "debounce", "debounce", "response", "_a", "debounce", "_a", "distance", "debounce", "_a", "debounce", "_a", "_a", "acc", "_a"]
}
